<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Dustin F. Kapraun, Mark Sfeir, Robert Pearce, Sarah Davidson, Annie Lumen, Andre Dallmann, Richard Judson, and John F. Wambaugh" />

<meta name="date" content="2022-09-08" />

<title>Kapraun et al. (submitted): Generic Human Gestational Model</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Kapraun et al. (submitted): Generic Human Gestational Model</h1>
<h4 class="author">Dustin F. Kapraun, Mark Sfeir, Robert Pearce, Sarah Davidson, Annie Lumen, Andre Dallmann, Richard Judson, and John F. Wambaugh</h4>
<h4 class="date">2022-09-08</h4>



<p><a href="mailto:wambaugh.john@epa.gov" class="email">wambaugh.john@epa.gov</a></p>
<div id="abstract" class="section level2">
<h2>Abstract</h2>
<p>Chemical risk assessment considers potentially susceptible populations including pregnant women and developing fetuses. Humans encounter thousands of chemicals in their environments, few of which have been fully characterized in terms of internal human dosimetry and mode-of-action. Toxicokinetic (TK) information is needed to relate chemical exposure to potentially bioactive tissue concentrations. Observational data describing human gestational exposures are unavailable for most chemicals, but physiologically based TK (PBTK) models estimate such exposures. However, development of chemical-specific PBTK models themselves requires considerable time and resources. As an alternative, generic PBTK approaches describe a standardized physiology and characterize chemicals with a set of standard physical and TK descriptors – primarily plasma protein binding and hepatic clearance. Here we report and evaluate a generic PBTK model of a human mother and developing fetus. We used a previously published set of formulas describing the major anatomical and physiological changes that occur during pregnancy to augment the High-Throughput Toxicokinetics (httk) software package. We performed simulations to estimate the ratio of concentrations in maternal and fetal plasma and compared these estimatesto literature in vivo measurements. We evaluated the model with literature in vivo time-course measurements of maternal plasma concentrations in pregnant and non-pregnant women. Finally, we demonstrated conceptual prioritization of chemicals measured in maternal serum based on predicted fetal brain concentrations. This new generic model can be used for TK simulations of any of the 856 chemicals with existing human-specific in vitro data that were found to be within the domain of the model, as well as any new chemicals for which such data become available. With sufficient evaluation, this gestational model may allow for in vitro to in vivo extrapolation of point of departure doses relevant to reproductive and developmental toxicity.</p>
</div>
<div id="prepare-for-session" class="section level2">
<h2>Prepare for session</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">collapse =</span> <span class="ot">TRUE</span>, <span class="dt">comment =</span> <span class="st">&#39;#&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">options</span>(<span class="dt">rmarkdown.html_vignette.check_title =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div id="load-the-relevant-libraries" class="section level3">
<h3>Load the relevant libraries</h3>
<p>If you get the message “Error in library(X) : there is no package called ‘X’” then you will need to install that package:</p>
<p>From the R command prompt:</p>
<p>install.packages(“X”)</p>
<p>Or, if using RStudio, look for ‘Install Packages’ under ‘Tools’ tab.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># Clear the memory:</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>()) </a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co"># Setup</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#library(readxl)</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb2-10" title="10"><span class="kw">library</span>(httk)</a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw">library</span>(scales)</a>
<a class="sourceLine" id="cb2-12" title="12"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb2-13" title="13"><span class="kw">library</span>(cowplot)</a></code></pre></div>
</div>
<div id="prepare-custom-functions" class="section level3">
<h3>Prepare custom functions</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">scientific_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x) {                                  </a>
<a class="sourceLine" id="cb3-2" title="2">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;1e&quot;</span>, <span class="st">&quot;10^&quot;</span>, <span class="kw">scientific_format</span>()(x))              </a>
<a class="sourceLine" id="cb3-3" title="3">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">+&quot;</span>,<span class="st">&quot;&quot;</span>,out)                                     </a>
<a class="sourceLine" id="cb3-4" title="4">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;10</span><span class="ch">\\</span><span class="st">^01&quot;</span>,<span class="st">&quot;10&quot;</span>,out)                               </a>
<a class="sourceLine" id="cb3-5" title="5">  out &lt;-<span class="st"> </span><span class="kw">parse</span>(<span class="dt">text=</span><span class="kw">gsub</span>(<span class="st">&quot;10</span><span class="ch">\\</span><span class="st">^00&quot;</span>,<span class="st">&quot;1&quot;</span>,out))                    </a>
<a class="sourceLine" id="cb3-6" title="6">}  </a>
<a class="sourceLine" id="cb3-7" title="7"></a>
<a class="sourceLine" id="cb3-8" title="8">RMSE &lt;-<span class="st"> </span><span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb3-9" title="9">{</a>
<a class="sourceLine" id="cb3-10" title="10">  <span class="kw">mean</span>(x<span class="op">$</span>residuals<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-11" title="11">}</a></code></pre></div>
</div>
</div>
<div id="number-of-chemicals" class="section level1">
<h1>Number of chemicals</h1>
<p>The number of chemicals with in vitro TK data (<span class="math inline">\(Cl_{int}\)</span> and <span class="math inline">\(f_{up}\)</span>) that are also non-volatile and non-PFAS can be found using:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">length</span>(<span class="kw">get_cheminfo</span>(<span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,<span class="dt">suppress.messages=</span><span class="ot">TRUE</span>))</a></code></pre></div>
<p>Data sets were curated from the literature to allow evaluation of the gestational PBTK model. In all cases chemical identities from the original publications were mapped onto DTXSID’s from the CompTox Chemicals Dashboard (<a href="https://comptox.epa.gov/dashboard" class="uri">https://comptox.epa.gov/dashboard</a>) [Williams et al., 2017] (<a href="https://doi.org/10.1186/s13321-017-0247-6" class="uri">https://doi.org/10.1186/s13321-017-0247-6</a>). Statistical testing for correlation between predictions and observations was performed using R function “lm” and p-values were calculated according to an F-distribution.</p>
</div>
<div id="aylward-cord-blood-data" class="section level1">
<h1>Aylward cord-blood data</h1>
<p><a href="http://dx.doi.org/10.1080/10937404.2014.884956">Aylward et al., 2014</a> compiled measurements of the ratio of maternal to fetal cord blood chemical concentrations at birth for a range of chemicals with environmental routes of exposure, including bromodiphenyl ethers, fluorinated compounds, organochlorine pesticides, polyaromatic hydrocarbons, tobacco smoke components, and vitamins. The PBTK model does not have an explicit cord blood compartment, so the ratio between maternal and fetal venous plasma concentrations was used as a surrogate when making comparisons of model predictions to these data.. For each chemical three daily oral doses (every eight hours) total 1 mg/kg/day were simulated starting from the 13th week of gestation until full term (40 weeks). Simulations were made both with and without the correction to <span class="math inline">\(f_{up}^f\)</span>.</p>
<div id="loadformat-the-data" class="section level2">
<h2>Load/format the data</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co">#MFdata &lt;- read_excel(&quot;Aylward-MatFet.xlsx&quot;)</span></a>
<a class="sourceLine" id="cb5-2" title="2">MFdata &lt;-<span class="st"> </span>httk<span class="op">::</span>aylward2014</a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;summarized data from over 100 studies covering &quot;</span>,</a>
<a class="sourceLine" id="cb5-5" title="5">  <span class="kw">length</span>(<span class="kw">unique</span>(MFdata<span class="op">$</span>DTXSID)[<span class="op">!</span>(<span class="kw">unique</span>(MFdata<span class="op">$</span>DTXSID)<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;-&quot;</span>))]),</a>
<a class="sourceLine" id="cb5-6" title="6">  <span class="st">&quot; unique chemicals structures</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb5-7" title="7">  </a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co"># We don&#39;t want to exclude the volatiles and PFAS at this point:</span></a>
<a class="sourceLine" id="cb5-9" title="9">MFdata.httk &lt;-<span class="st"> </span><span class="kw">subset</span>(MFdata,DTXSID <span class="op">%in%</span><span class="st"> </span><span class="kw">get_cheminfo</span>(</a>
<a class="sourceLine" id="cb5-10" title="10">  <span class="dt">info=</span><span class="st">&quot;DTXSID&quot;</span>,</a>
<a class="sourceLine" id="cb5-11" title="11">  <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb5-12" title="12">MFdata.httk[MFdata.httk<span class="op">$</span>Chemical.Category<span class="op">==</span><span class="st">&quot;bromodiphenylethers&quot;</span>,</a>
<a class="sourceLine" id="cb5-13" title="13">  <span class="st">&quot;Chemical.Category&quot;</span>] &lt;-<span class="st"> &quot;Bromodiphenylethers&quot;</span>  </a>
<a class="sourceLine" id="cb5-14" title="14">MFdata.httk[MFdata.httk<span class="op">$</span>Chemical.Category<span class="op">==</span><span class="st">&quot;organochlorine Pesticides&quot;</span>,</a>
<a class="sourceLine" id="cb5-15" title="15">  <span class="st">&quot;Chemical.Category&quot;</span>] &lt;-<span class="st"> &quot;Organochlorine Pesticides&quot;</span>  </a>
<a class="sourceLine" id="cb5-16" title="16">  MFdata.httk[MFdata.httk<span class="op">$</span>Chemical.Category<span class="op">==</span><span class="st">&quot;polyaromatic hydrocarbons&quot;</span>,</a>
<a class="sourceLine" id="cb5-17" title="17">  <span class="st">&quot;Chemical.Category&quot;</span>] &lt;-<span class="st"> &quot;Polyaromatic Hydrocarbons&quot;</span>  </a>
<a class="sourceLine" id="cb5-18" title="18"></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="kw">colnames</span>(MFdata.httk)[<span class="kw">colnames</span>(MFdata.httk) <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="st">  &quot;infant.maternal.conc...Central.tendency..calculate.j.k..or.report.paired.result.&quot;</span>] &lt;-</a>
<a class="sourceLine" id="cb5-21" title="21"><span class="st">  &quot;MFratio&quot;</span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="kw">colnames</span>(MFdata.httk)[<span class="kw">colnames</span>(MFdata.httk) <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="st">  &quot;PREFERRED_NAME&quot;</span>] &lt;-</a>
<a class="sourceLine" id="cb5-24" title="24"><span class="st">  &quot;Chemical&quot;</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="kw">colnames</span>(MFdata.httk)[<span class="kw">colnames</span>(MFdata.httk) <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="st">  &quot;details.on.matrix.comparison...e.g...cord.blood.lipid..maternal.serum.lipid..or.cord.blood.wet.weight..maternal.whole.blood.wet.weight&quot;</span>] &lt;-</a>
<a class="sourceLine" id="cb5-27" title="27"><span class="st">  &quot;Matrix&quot;</span></a>
<a class="sourceLine" id="cb5-28" title="28"></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="co"># Format the columns:</span></a>
<a class="sourceLine" id="cb5-30" title="30">MFdata.httk<span class="op">$</span>MFratio &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(MFdata.httk<span class="op">$</span>MFratio)</a>
<a class="sourceLine" id="cb5-31" title="31">MFdata.httk<span class="op">$</span>Chemical &lt;-<span class="st"> </span><span class="kw">as.factor</span>(MFdata.httk<span class="op">$</span>Chemical)  </a>
<a class="sourceLine" id="cb5-32" title="32">MFdata.httk<span class="op">$</span>Matrix &lt;-<span class="st"> </span><span class="kw">as.factor</span>(MFdata.httk<span class="op">$</span>Chemical)  </a>
<a class="sourceLine" id="cb5-33" title="33">MFdata.httk<span class="op">$</span>Chemical.Category &lt;-<span class="st"> </span><span class="kw">as.factor</span>(MFdata.httk<span class="op">$</span>Chemical.Category)  </a>
<a class="sourceLine" id="cb5-34" title="34"></a>
<a class="sourceLine" id="cb5-35" title="35"><span class="kw">colnames</span>(MFdata.httk)[<span class="dv">15</span>] &lt;-<span class="st"> &quot;infant&quot;</span></a>
<a class="sourceLine" id="cb5-36" title="36"><span class="kw">colnames</span>(MFdata.httk)[<span class="dv">16</span>] &lt;-<span class="st"> &quot;maternal&quot;</span></a>
<a class="sourceLine" id="cb5-37" title="37"><span class="kw">colnames</span>(MFdata.httk)[<span class="dv">17</span>] &lt;-<span class="st"> &quot;obs.units&quot;</span></a>
<a class="sourceLine" id="cb5-38" title="38"></a>
<a class="sourceLine" id="cb5-39" title="39">MFdata.httk<span class="op">$</span>infant &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">as.numeric</span>(MFdata.httk<span class="op">$</span>infant))</a>
<a class="sourceLine" id="cb5-40" title="40">MFdata.httk<span class="op">$</span>maternal &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">as.numeric</span>(MFdata.httk<span class="op">$</span>maternal))</a>
<a class="sourceLine" id="cb5-41" title="41">MFdata.httk<span class="op">$</span>AVERAGE_MASS &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(MFdata.httk<span class="op">$</span>AVERAGE_MASS)</a></code></pre></div>
</div>
<div id="convert-the-units" class="section level2">
<h2>Convert the units:</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">convert1.units &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ng/ml&quot;</span>,<span class="st">&quot;ng/mL&quot;</span>,<span class="st">&quot;ug/L&quot;</span>,<span class="st">&quot;ug/l&quot;</span>,<span class="st">&quot;ng/mL serum&quot;</span>,<span class="st">&quot;ng/g&quot;</span>,</a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="st">&quot;ng/g wet wt.&quot;</span>,<span class="st">&quot;ppb&quot;</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4">MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert1.units,<span class="st">&quot;infant&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="st">  </span>MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert1.units,<span class="st">&quot;infant&quot;</span>] <span class="op">/</span><span class="st"> </span><span class="co"># ng/ml = ug/L</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="st">  </span>MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert1.units,<span class="st">&quot;AVERAGE_MASS&quot;</span>]  <span class="co"># ug/L -&gt; uM</span></a>
<a class="sourceLine" id="cb6-7" title="7">MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert1.units,<span class="st">&quot;maternal&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="st">  </span>MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert1.units,<span class="st">&quot;maternal&quot;</span>] <span class="op">/</span><span class="st"> </span><span class="co"># ng/ml = ug/L</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="st">  </span>MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert1.units,<span class="st">&quot;AVERAGE_MASS&quot;</span>]  <span class="co"># ug/L -&gt; uM</span></a>
<a class="sourceLine" id="cb6-10" title="10">MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert1.units,<span class="st">&quot;obs.units&quot;</span>] &lt;-<span class="st"> &quot;uM&quot;</span> </a>
<a class="sourceLine" id="cb6-11" title="11">  </a>
<a class="sourceLine" id="cb6-12" title="12">convert2.units &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mg/L&quot;</span>,<span class="st">&quot;ppm&quot;</span>)</a>
<a class="sourceLine" id="cb6-13" title="13"></a>
<a class="sourceLine" id="cb6-14" title="14">MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert2.units,<span class="st">&quot;infant&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="st">  </span>MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert2.units,<span class="st">&quot;infant&quot;</span>] <span class="op">*</span><span class="st"> </span><span class="dv">1000</span> <span class="op">/</span><span class="st"> </span><span class="co"># mg/L = ug/L</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="st">  </span>MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert2.units,<span class="st">&quot;AVERAGE_MASS&quot;</span>]  <span class="co"># ug/L -&gt; uM</span></a>
<a class="sourceLine" id="cb6-17" title="17">MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert2.units,<span class="st">&quot;maternal&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="st">  </span>MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert2.units,<span class="st">&quot;maternal&quot;</span>]<span class="op">*</span><span class="st"> </span><span class="dv">1000</span> <span class="op">/</span><span class="st"> </span><span class="co"># mg/L = ug/L</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="st">  </span>MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert2.units,<span class="st">&quot;AVERAGE_MASS&quot;</span>]  <span class="co"># ug/L -&gt; uM</span></a>
<a class="sourceLine" id="cb6-20" title="20">MFdata.httk[MFdata.httk<span class="op">$</span>obs.units<span class="op">%in%</span>convert2.units,<span class="st">&quot;obs.units&quot;</span>] &lt;-<span class="st"> &quot;uM&quot;</span> </a></code></pre></div>
</div>
<div id="compare-httk-predictions-with-maternalfetal-observations-from-aylward-2014" class="section level2">
<h2>Compare HTTK predictions with maternal:fetal observations from Aylward 2014</h2>
<p>Note that we can’t do an absolute scale comparison (for example, fetal:fetal or maternal:maternal) because we don’t know the dose for the Aylward data but we assume that the maternal:fetal ratio is independent of dose and so we use the plasma ratio at full term (40 weeks) resulting from a 1 mg/kg/day exposure rate starting in week 13.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Simulate starting from the 13th week of gestation until full term (40 weeks):</span></a>
<a class="sourceLine" id="cb7-2" title="2">times &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">13</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>, <span class="dv">40</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>, <span class="fl">0.25</span>),<span class="kw">seq</span>(<span class="dv">278</span>,<span class="dv">280</span>,.<span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb7-3" title="3"></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co"># For each chemical with maternal-fetal ratio data and HTTK in vitro data:  </span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="kw">unique</span>(MFdata.httk<span class="op">$</span>DTXSID))</a>
<a class="sourceLine" id="cb7-6" title="6">{</a>
<a class="sourceLine" id="cb7-7" title="7">  <span class="kw">print</span>(this.id)</a>
<a class="sourceLine" id="cb7-8" title="8">  p &lt;-<span class="st"> </span><span class="kw">parameterize_steadystate</span>(<span class="dt">dtxsid=</span>this.id,</a>
<a class="sourceLine" id="cb7-9" title="9">                        <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-10" title="10">  <span class="co"># skip chemicals where Fup is 0:  </span></a>
<a class="sourceLine" id="cb7-11" title="11">  <span class="cf">if</span> (p<span class="op">$</span>Funbound.plasma<span class="op">&gt;</span><span class="fl">1e-4</span>)</a>
<a class="sourceLine" id="cb7-12" title="12">  {</a>
<a class="sourceLine" id="cb7-13" title="13"></a>
<a class="sourceLine" id="cb7-14" title="14">    <span class="co"># Load the chemical-specifc paramaters:</span></a>
<a class="sourceLine" id="cb7-15" title="15">    p &lt;-<span class="st"> </span><span class="kw">parameterize_fetal_pbtk</span>(<span class="dt">dtxsid=</span>this.id,</a>
<a class="sourceLine" id="cb7-16" title="16">                                                  <span class="dt">fetal_fup_adjustment =</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb7-17" title="17">                                                  <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-18" title="18">    <span class="co"># Skip chemicals where the 95% credible interval for Fup spans more than 0.1 to</span></a>
<a class="sourceLine" id="cb7-19" title="19">    <span class="co"># 0.9 (that is, Fup is effectively unknown):</span></a>
<a class="sourceLine" id="cb7-20" title="20">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.na</span>(p<span class="op">$</span>Funbound.plasma.dist))</a>
<a class="sourceLine" id="cb7-21" title="21">    {</a>
<a class="sourceLine" id="cb7-22" title="22">      <span class="cf">if</span> (<span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(p<span class="op">$</span>Funbound.plasma.dist,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])<span class="op">&gt;</span><span class="fl">0.9</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="st">          </span><span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(p<span class="op">$</span>Funbound.plasma.dist,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])<span class="op">&lt;</span><span class="fl">0.11</span>)</a>
<a class="sourceLine" id="cb7-24" title="24">      {</a>
<a class="sourceLine" id="cb7-25" title="25">        skip &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb7-26" title="26">      } <span class="cf">else</span> skip &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb7-27" title="27">    } <span class="cf">else</span> skip &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb7-28" title="28">    </a>
<a class="sourceLine" id="cb7-29" title="29">    <span class="cf">if</span> (<span class="op">!</span>skip)</a>
<a class="sourceLine" id="cb7-30" title="30">    {</a>
<a class="sourceLine" id="cb7-31" title="31">      <span class="co"># Solve the PBTK equations for the full simulation time assuming 1 total daily</span></a>
<a class="sourceLine" id="cb7-32" title="32">      <span class="co"># dose of 1 mg/kg/day spread out over three evenly spaces exposures:</span></a>
<a class="sourceLine" id="cb7-33" title="33">      out &lt;-<span class="st"> </span><span class="kw">solve_fetal_pbtk</span>(</a>
<a class="sourceLine" id="cb7-34" title="34">        <span class="dt">parameters=</span>p,</a>
<a class="sourceLine" id="cb7-35" title="35">        <span class="dt">dose=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb7-36" title="36">        <span class="dt">times=</span>times,</a>
<a class="sourceLine" id="cb7-37" title="37">        <span class="dt">daily.dose=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb7-38" title="38">        <span class="dt">doses.per.day=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb7-39" title="39">        <span class="dt">output.units =</span> <span class="st">&quot;uM&quot;</span>,</a>
<a class="sourceLine" id="cb7-40" title="40">        <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-41" title="41">      <span class="co"># Identify the concentrations from the final (279th) day:</span></a>
<a class="sourceLine" id="cb7-42" title="42">      last.row &lt;-<span class="st"> </span><span class="kw">which</span>(out[,<span class="st">&quot;time&quot;</span>]<span class="op">&gt;</span><span class="dv">279</span>)</a>
<a class="sourceLine" id="cb7-43" title="43">      last.row &lt;-<span class="st"> </span>last.row[<span class="op">!</span><span class="kw">duplicated</span>(out[last.row,<span class="st">&quot;time&quot;</span>])]</a>
<a class="sourceLine" id="cb7-44" title="44">      <span class="co"># Average over the final day:</span></a>
<a class="sourceLine" id="cb7-45" title="45">      MFdata.httk[MFdata.httk<span class="op">$</span>DTXSID<span class="op">==</span>this.id,<span class="st">&quot;Mat.pred&quot;</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>])</a>
<a class="sourceLine" id="cb7-46" title="46">      MFdata.httk[MFdata.httk<span class="op">$</span>DTXSID<span class="op">==</span>this.id,<span class="st">&quot;Fet.pred&quot;</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])</a>
<a class="sourceLine" id="cb7-47" title="47">      MFdata.httk[MFdata.httk<span class="op">$</span>DTXSID<span class="op">==</span>this.id,<span class="st">&quot;MFratio.pred&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb7-48" title="48"><span class="st">        </span><span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>])<span class="op">/</span><span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])</a>
<a class="sourceLine" id="cb7-49" title="49">      </a>
<a class="sourceLine" id="cb7-50" title="50">      <span class="co"># Repeat the analysis without the adjustment to fetal Fup:</span></a>
<a class="sourceLine" id="cb7-51" title="51">      p &lt;-<span class="st"> </span><span class="kw">parameterize_fetal_pbtk</span>(<span class="dt">dtxsid=</span>this.id,</a>
<a class="sourceLine" id="cb7-52" title="52">                                                    <span class="dt">fetal_fup_adjustment =</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb7-53" title="53">                                                    <span class="dt">suppress.messages =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-54" title="54">      out &lt;-<span class="st"> </span><span class="kw">solve_fetal_pbtk</span>(</a>
<a class="sourceLine" id="cb7-55" title="55">        <span class="dt">parameters=</span>p,</a>
<a class="sourceLine" id="cb7-56" title="56">        <span class="dt">dose=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb7-57" title="57">        <span class="dt">times=</span>times,</a>
<a class="sourceLine" id="cb7-58" title="58">        <span class="dt">daily.dose=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb7-59" title="59">        <span class="dt">doses.per.day=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb7-60" title="60">        <span class="dt">output.units =</span> <span class="st">&quot;uM&quot;</span>,</a>
<a class="sourceLine" id="cb7-61" title="61">        <span class="dt">maxsteps=</span><span class="fl">1e7</span>,</a>
<a class="sourceLine" id="cb7-62" title="62">        <span class="dt">suppress.messages =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-63" title="63">      </a>
<a class="sourceLine" id="cb7-64" title="64">      last.row &lt;-<span class="st"> </span><span class="kw">which</span>(out[,<span class="st">&quot;time&quot;</span>]<span class="op">&gt;</span><span class="dv">279</span>) <span class="co"># The whole final day</span></a>
<a class="sourceLine" id="cb7-65" title="65">      last.row &lt;-<span class="st"> </span>last.row[<span class="op">!</span><span class="kw">duplicated</span>(out[last.row,<span class="st">&quot;time&quot;</span>])]</a>
<a class="sourceLine" id="cb7-66" title="66">      MFdata.httk[MFdata.httk<span class="op">$</span>DTXSID<span class="op">==</span>this.id,<span class="st">&quot;Mat.pred.nofup&quot;</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>])</a>
<a class="sourceLine" id="cb7-67" title="67">      MFdata.httk[MFdata.httk<span class="op">$</span>DTXSID<span class="op">==</span>this.id,<span class="st">&quot;Fet.pred.nofup&quot;</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])</a>
<a class="sourceLine" id="cb7-68" title="68">      MFdata.httk[MFdata.httk<span class="op">$</span>DTXSID<span class="op">==</span>this.id,<span class="st">&quot;MFratio.pred.nofup&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb7-69" title="69"><span class="st">        </span><span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>])<span class="op">/</span><span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])</a>
<a class="sourceLine" id="cb7-70" title="70">    }</a>
<a class="sourceLine" id="cb7-71" title="71">  }</a>
<a class="sourceLine" id="cb7-72" title="72">}</a>
<a class="sourceLine" id="cb7-73" title="73"></a>
<a class="sourceLine" id="cb7-74" title="74"><span class="co"># Something is wrong with cotinine:</span></a>
<a class="sourceLine" id="cb7-75" title="75">MFdata.httk &lt;-<span class="st"> </span><span class="kw">subset</span>(MFdata.httk,Chemical<span class="op">!=</span><span class="st">&quot;Cotinine&quot;</span>)</a>
<a class="sourceLine" id="cb7-76" title="76"></a>
<a class="sourceLine" id="cb7-77" title="77">max.chem &lt;-<span class="st"> </span>MFdata.httk[<span class="kw">which</span>(MFdata.httk<span class="op">$</span>MFratio<span class="op">==</span><span class="kw">max</span>(MFdata.httk<span class="op">$</span>MFratio)),]</a>
<a class="sourceLine" id="cb7-78" title="78">min.chem &lt;-<span class="st"> </span>MFdata.httk[<span class="kw">which</span>(MFdata.httk<span class="op">$</span>MFratio<span class="op">==</span><span class="kw">min</span>(MFdata.httk<span class="op">$</span>MFratio)),]</a>
<a class="sourceLine" id="cb7-79" title="79"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;The minimum observed ratio was &quot;</span>,</a>
<a class="sourceLine" id="cb7-80" title="80">  <span class="kw">signif</span>(min.chem[,<span class="st">&quot;MFratio&quot;</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb7-81" title="81">  <span class="st">&quot; for &quot;</span>,</a>
<a class="sourceLine" id="cb7-82" title="82">  min.chem[,<span class="st">&quot;Chemical&quot;</span>],</a>
<a class="sourceLine" id="cb7-83" title="83">  <span class="st">&quot; and the maximum was &quot;</span>,</a>
<a class="sourceLine" id="cb7-84" title="84">  <span class="kw">signif</span>(max.chem[,<span class="st">&quot;MFratio&quot;</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb7-85" title="85">  <span class="st">&quot; for &quot;</span>,</a>
<a class="sourceLine" id="cb7-86" title="86">  max.chem[,<span class="st">&quot;Chemical&quot;</span>],</a>
<a class="sourceLine" id="cb7-87" title="87">  <span class="st">&quot;.</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
</div>
<div id="aylward-ratio-figures" class="section level2">
<h2>Aylward Ratio figures:</h2>
<div id="clean-up-repeated-observations" class="section level3">
<h3>Clean up repeated observations:</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">MFdata.main &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb8-2" title="2">MFdata.outliers &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="kw">unique</span>(MFdata.httk<span class="op">$</span>DTXSID))</a>
<a class="sourceLine" id="cb8-4" title="4">{</a>
<a class="sourceLine" id="cb8-5" title="5">  this.subset &lt;-<span class="st"> </span><span class="kw">subset</span>(MFdata.httk,DTXSID<span class="op">==</span>this.id)</a>
<a class="sourceLine" id="cb8-6" title="6">  this.row &lt;-<span class="st"> </span>this.subset[<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb8-7" title="7">  this.row<span class="op">$</span>N.obs &lt;-<span class="st"> </span><span class="kw">dim</span>(this.subset)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-8" title="8">  this.row<span class="op">$</span>MFratio &lt;-<span class="st"> </span><span class="kw">median</span>(this.subset<span class="op">$</span>MFratio)</a>
<a class="sourceLine" id="cb8-9" title="9">  this.row<span class="op">$</span>MFratio.Q25 &lt;-<span class="st"> </span><span class="kw">quantile</span>(this.subset<span class="op">$</span>MFratio,<span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb8-10" title="10">  this.row<span class="op">$</span>MFratio.Q75 &lt;-<span class="st"> </span><span class="kw">quantile</span>(this.subset<span class="op">$</span>MFratio,<span class="fl">0.75</span>)</a>
<a class="sourceLine" id="cb8-11" title="11">  MFdata.main &lt;-<span class="st"> </span><span class="kw">rbind</span>(MFdata.main,this.row)</a>
<a class="sourceLine" id="cb8-12" title="12">  this.subset &lt;-<span class="st"> </span><span class="kw">subset</span>(this.subset,</a>
<a class="sourceLine" id="cb8-13" title="13">    MFratio<span class="op">&lt;</span>this.row<span class="op">$</span>MFratio.Q25 <span class="op">|</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="st">    </span>MFratio<span class="op">&gt;</span>this.row<span class="op">$</span>MFratio.Q75)</a>
<a class="sourceLine" id="cb8-15" title="15">  MFdata.outliers &lt;-<span class="st"> </span><span class="kw">rbind</span>(MFdata.outliers,this.subset) </a>
<a class="sourceLine" id="cb8-16" title="16">}</a></code></pre></div>
</div>
<div id="cord-blood-ratio-predictions-without-fup-adjustement" class="section level3">
<h3>Cord Blood Ratio Predictions without Fup Adjustement:</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">FigCa  &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>MFdata.main) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">color=</span><span class="st">&quot;grey&quot;</span>,<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb9-3" title="3">    <span class="dt">x=</span>MFratio.pred.nofup,</a>
<a class="sourceLine" id="cb9-4" title="4">    <span class="dt">y=</span>MFratio.Q25,</a>
<a class="sourceLine" id="cb9-5" title="5">    <span class="dt">xend=</span>MFratio.pred.nofup,</a>
<a class="sourceLine" id="cb9-6" title="6">    <span class="dt">yend=</span>MFratio.Q75))<span class="op">+</span><span class="st">    </span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb9-8" title="8">    <span class="dt">x=</span>MFratio.pred.nofup,</a>
<a class="sourceLine" id="cb9-9" title="9">    <span class="dt">y=</span>MFratio,</a>
<a class="sourceLine" id="cb9-10" title="10">    <span class="dt">shape=</span>Chemical.Category,</a>
<a class="sourceLine" id="cb9-11" title="11">    <span class="dt">color=</span>Chemical.Category),</a>
<a class="sourceLine" id="cb9-12" title="12">    <span class="dt">size=</span><span class="dv">4</span>)   <span class="op">+</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">16</span>,<span class="dv">2</span>, <span class="dv">23</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">5</span>, <span class="dv">6</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>MFdata.outliers,<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb9-15" title="15">    <span class="dt">x=</span>MFratio.pred.nofup,</a>
<a class="sourceLine" id="cb9-16" title="16">    <span class="dt">y=</span>MFratio,</a>
<a class="sourceLine" id="cb9-17" title="17">    <span class="dt">shape=</span>Chemical.Category,</a>
<a class="sourceLine" id="cb9-18" title="18">    <span class="dt">color=</span>Chemical.Category),</a>
<a class="sourceLine" id="cb9-19" title="19">    <span class="dt">size=</span><span class="dv">2</span>)   <span class="op">+</span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>,<span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-21" title="21"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co">#   geom_text(aes(x=AUC,y=Critical.concentration,label=Compound.abbrev,color=Chemical)) +</span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co">#   scale_y_log10(label=scientific_10) +</span></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co">#,limits=c(10^-7,100)) +</span></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="co">#   scale_x_log10(label=scientific_10) +</span></a>
<a class="sourceLine" id="cb9-26" title="26"><span class="co">#   ,limits=c(10^-7,100)) +</span></a>
<a class="sourceLine" id="cb9-27" title="27"><span class="co">#    annotation_logticks() + </span></a>
<a class="sourceLine" id="cb9-28" title="28"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">0</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-29" title="29"><span class="co">#    geom_abline(slope=1, intercept=1,linetype=&quot;dashed&quot;) + </span></a>
<a class="sourceLine" id="cb9-30" title="30"><span class="co">#    geom_abline(slope=1, intercept=-1,linetype=&quot;dashed&quot;) + </span></a>
<a class="sourceLine" id="cb9-31" title="31"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="kw">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; Mat:Fet Plasma Ratio&quot;</span>))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-32" title="32"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Generic PBTK Predicted Ratio&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-33" title="33"><span class="co">#    scale_color_brewer(palette=&quot;Set2&quot;) + </span></a>
<a class="sourceLine" id="cb9-34" title="34"><span class="st">  </span><span class="kw">theme_bw</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb9-35" title="35"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb9-36" title="36"><span class="st">  </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-37" title="37"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-38" title="38"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">color=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;Class&quot;</span>,<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-39" title="39"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">shape=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;Class&quot;</span>,<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb9-40" title="40">    </a>
<a class="sourceLine" id="cb9-41" title="41"><span class="kw">print</span>(FigCa)</a></code></pre></div>
</div>
<div id="generate-text-for-results-section" class="section level3">
<h3>Generate text for results section:</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;In Figure 4 we compare predictions made with our high-throughput \</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="st">human gestational PBTK model with experimental observations on a per chemical \</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="st">basis wherever we had both in vitro HTTK data and in vivo observations (&quot;</span>,</a>
<a class="sourceLine" id="cb10-5" title="5"><span class="kw">length</span>(<span class="kw">unique</span>(MFdata.main<span class="op">$</span>DTXSID)),</a>
<a class="sourceLine" id="cb10-6" title="6"><span class="st">&quot; chemicals).</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb10-7" title="7"></a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9">repeats &lt;-<span class="st"> </span><span class="kw">subset</span>(MFdata.main,N.obs<span class="op">&gt;</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-10" title="10"></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;Multiple observations were available for &quot;</span>,</a>
<a class="sourceLine" id="cb10-12" title="12">  <span class="kw">dim</span>(repeats)[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb10-13" title="13">  <span class="st">&quot; of the chemicals,</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb10-14" title="14"></a>
<a class="sourceLine" id="cb10-15" title="15"></a>
<a class="sourceLine" id="cb10-16" title="16">max.chem &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(repeats[<span class="kw">which</span>(repeats<span class="op">$</span>MFratio<span class="op">==</span><span class="kw">max</span>(repeats<span class="op">$</span>MFratio)),])</a>
<a class="sourceLine" id="cb10-17" title="17">min.chem &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(repeats[<span class="kw">which</span>(repeats<span class="op">$</span>MFratio<span class="op">==</span><span class="kw">min</span>(repeats<span class="op">$</span>MFratio)),])</a>
<a class="sourceLine" id="cb10-18" title="18"></a>
<a class="sourceLine" id="cb10-19" title="19"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;However, among the chemicals with repeated observations, the median \</span></a>
<a class="sourceLine" id="cb10-20" title="20"><span class="st">observations only ranged from &quot;</span>,</a>
<a class="sourceLine" id="cb10-21" title="21">  <span class="kw">signif</span>(min.chem[,<span class="st">&quot;MFratio&quot;</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb10-22" title="22">  <span class="st">&quot; for &quot;</span>,</a>
<a class="sourceLine" id="cb10-23" title="23">  min.chem[,<span class="st">&quot;Chemical&quot;</span>],</a>
<a class="sourceLine" id="cb10-24" title="24">  <span class="st">&quot; to &quot;</span>,</a>
<a class="sourceLine" id="cb10-25" title="25">  <span class="kw">signif</span>(max.chem[,<span class="st">&quot;MFratio&quot;</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb10-26" title="26">  <span class="st">&quot; for &quot;</span>,</a>
<a class="sourceLine" id="cb10-27" title="27">  max.chem[,<span class="st">&quot;Chemical&quot;</span>],</a>
<a class="sourceLine" id="cb10-28" title="28">  <span class="st">&quot;.</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb10-29" title="29">  </a>
<a class="sourceLine" id="cb10-30" title="30">max.chem &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(MFdata.main[<span class="kw">which</span>(MFdata.main<span class="op">$</span>MFratio.pred<span class="op">==</span><span class="kw">max</span>(MFdata.main<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)),])</a>
<a class="sourceLine" id="cb10-31" title="31">min.chem &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(MFdata.main[<span class="kw">which</span>(MFdata.main<span class="op">$</span>MFratio.pred<span class="op">==</span><span class="kw">min</span>(MFdata.main<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)),])</a>
<a class="sourceLine" id="cb10-32" title="32"></a>
<a class="sourceLine" id="cb10-33" title="33"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;The predictions for all chemicals ranged from &quot;</span>,</a>
<a class="sourceLine" id="cb10-34" title="34">  <span class="kw">signif</span>(min.chem[,<span class="st">&quot;MFratio.pred&quot;</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb10-35" title="35">  <span class="st">&quot; for &quot;</span>,</a>
<a class="sourceLine" id="cb10-36" title="36">  min.chem[,<span class="st">&quot;Chemical&quot;</span>],</a>
<a class="sourceLine" id="cb10-37" title="37">  <span class="st">&quot; to &quot;</span>,</a>
<a class="sourceLine" id="cb10-38" title="38">  <span class="kw">signif</span>(max.chem[,<span class="st">&quot;MFratio.pred&quot;</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb10-39" title="39">  <span class="st">&quot; for &quot;</span>,</a>
<a class="sourceLine" id="cb10-40" title="40">  max.chem[,<span class="st">&quot;Chemical&quot;</span>],</a>
<a class="sourceLine" id="cb10-41" title="41">  <span class="st">&quot;.</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb10-42" title="42">  </a>
<a class="sourceLine" id="cb10-43" title="43">    </a>
<a class="sourceLine" id="cb10-44" title="44"></a>
<a class="sourceLine" id="cb10-45" title="45">fit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>MFdata.main,MFratio<span class="op">~</span>MFratio.pred.nofup)</a>
<a class="sourceLine" id="cb10-46" title="46"><span class="kw">summary</span>(fit1)</a>
<a class="sourceLine" id="cb10-47" title="47"><span class="kw">RMSE</span>(fit1)</a>
<a class="sourceLine" id="cb10-48" title="48"></a>
<a class="sourceLine" id="cb10-49" title="49">fit1sub &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span><span class="kw">subset</span>(MFdata.main,</a>
<a class="sourceLine" id="cb10-50" title="50">  <span class="op">!</span>(Chemical.Category <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb10-51" title="51">    <span class="st">&quot;Fluorinated compounds&quot;</span>,</a>
<a class="sourceLine" id="cb10-52" title="52">    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))),</a>
<a class="sourceLine" id="cb10-53" title="53">  MFratio<span class="op">~</span>MFratio.pred.nofup)</a>
<a class="sourceLine" id="cb10-54" title="54"><span class="kw">summary</span>(fit1sub)</a>
<a class="sourceLine" id="cb10-55" title="55"><span class="kw">RMSE</span>(fit1sub)</a></code></pre></div>
</div>
<div id="cord-blood-ratio-predictions-with-fup-adjustement" class="section level3">
<h3>Cord Blood Ratio Predictions with Fup Adjustement:</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">FigCb  &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>MFdata.main) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">color=</span><span class="st">&quot;grey&quot;</span>,<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb11-3" title="3">    <span class="dt">x=</span>MFratio.pred,</a>
<a class="sourceLine" id="cb11-4" title="4">    <span class="dt">y=</span>MFratio.Q25,</a>
<a class="sourceLine" id="cb11-5" title="5">    <span class="dt">xend=</span>MFratio.pred,</a>
<a class="sourceLine" id="cb11-6" title="6">    <span class="dt">yend=</span>MFratio.Q75))<span class="op">+</span><span class="st">    </span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb11-8" title="8">    <span class="dt">x=</span>MFratio.pred,</a>
<a class="sourceLine" id="cb11-9" title="9">    <span class="dt">y=</span>MFratio,</a>
<a class="sourceLine" id="cb11-10" title="10">    <span class="dt">shape=</span>Chemical.Category,</a>
<a class="sourceLine" id="cb11-11" title="11">    <span class="dt">color=</span>Chemical.Category),</a>
<a class="sourceLine" id="cb11-12" title="12">    <span class="dt">size=</span><span class="dv">3</span>)   <span class="op">+</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">16</span>,<span class="dv">2</span>, <span class="dv">23</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">5</span>, <span class="dv">6</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>MFdata.outliers,<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb11-15" title="15">    <span class="dt">x=</span>MFratio.pred,</a>
<a class="sourceLine" id="cb11-16" title="16">    <span class="dt">y=</span>MFratio,</a>
<a class="sourceLine" id="cb11-17" title="17">    <span class="dt">shape=</span>Chemical.Category,</a>
<a class="sourceLine" id="cb11-18" title="18">    <span class="dt">color=</span>Chemical.Category),</a>
<a class="sourceLine" id="cb11-19" title="19">    <span class="dt">size=</span><span class="dv">1</span>)   <span class="op">+</span></a>
<a class="sourceLine" id="cb11-20" title="20"><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>,<span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-21" title="21"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-22" title="22"><span class="co">#   geom_text(aes(x=AUC,y=Critical.concentration,label=Compound.abbrev,color=Chemical)) +</span></a>
<a class="sourceLine" id="cb11-23" title="23"><span class="co">#   scale_y_log10(label=scientific_10) +</span></a>
<a class="sourceLine" id="cb11-24" title="24"><span class="co">#,limits=c(10^-7,100)) +</span></a>
<a class="sourceLine" id="cb11-25" title="25"><span class="co">#   scale_x_log10(label=scientific_10) +</span></a>
<a class="sourceLine" id="cb11-26" title="26"><span class="co">#   ,limits=c(10^-7,100)) +</span></a>
<a class="sourceLine" id="cb11-27" title="27"><span class="co">#    annotation_logticks() + </span></a>
<a class="sourceLine" id="cb11-28" title="28"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">0</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-29" title="29"><span class="co">#    geom_abline(slope=1, intercept=1,linetype=&quot;dashed&quot;) + </span></a>
<a class="sourceLine" id="cb11-30" title="30"><span class="co">#    geom_abline(slope=1, intercept=-1,linetype=&quot;dashed&quot;) + </span></a>
<a class="sourceLine" id="cb11-31" title="31"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="kw">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; Mat:Fet Plasma Ratio&quot;</span>))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-32" title="32"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="kw">italic</span>(<span class="st">&quot;In vitro&quot;</span>),<span class="st">&quot; Predicted Ratio&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-33" title="33"><span class="co">#    scale_color_brewer(palette=&quot;Set2&quot;) + </span></a>
<a class="sourceLine" id="cb11-34" title="34"><span class="st">  </span><span class="kw">theme_bw</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb11-35" title="35"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb11-36" title="36"><span class="st">  </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-37" title="37"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-38" title="38"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">color=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;Class&quot;</span>,<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-39" title="39"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">shape=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;Class&quot;</span>,<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb11-40" title="40">    </a>
<a class="sourceLine" id="cb11-41" title="41"><span class="kw">print</span>(FigCb)</a></code></pre></div>
</div>
<div id="examine-performance-when-excluding-certain-chemical-classes" class="section level3">
<h3>Examine performance when excluding certain chemical classes:</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># Mean logHenry&#39;s law constant for PAH&#39;s:</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">mean</span>(<span class="kw">subset</span>(chem.physical_and_invitro.data,DTXSID<span class="op">%in%</span><span class="kw">subset</span>(MFdata.main,Chemical.Category<span class="op">==</span><span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>)<span class="op">$</span>DTXSID)<span class="op">$</span>logHenry)</a>
<a class="sourceLine" id="cb12-3" title="3"></a>
<a class="sourceLine" id="cb12-4" title="4">nonvols &lt;-<span class="st"> </span><span class="kw">subset</span>(chem.physical_and_invitro.data,logHenry <span class="op">&lt;</span><span class="st"> </span><span class="fl">-4.5</span>)<span class="op">$</span>DTXSID</a>
<a class="sourceLine" id="cb12-5" title="5">fluoros &lt;-<span class="st"> </span>chem.physical_and_invitro.data<span class="op">$</span>DTXSID[<span class="kw">regexpr</span>(<span class="st">&quot;fluoro&quot;</span>,<span class="kw">tolower</span>(chem.physical_and_invitro.data<span class="op">$</span>Compound))<span class="op">!=-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb12-6" title="6"></a>
<a class="sourceLine" id="cb12-7" title="7">fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>MFdata.main,MFratio<span class="op">~</span>MFratio.pred)</a>
<a class="sourceLine" id="cb12-8" title="8"><span class="kw">summary</span>(fit2)</a>
<a class="sourceLine" id="cb12-9" title="9"><span class="kw">RMSE</span>(fit2)</a>
<a class="sourceLine" id="cb12-10" title="10"></a>
<a class="sourceLine" id="cb12-11" title="11">fit2sub &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span><span class="kw">subset</span>(MFdata.main,</a>
<a class="sourceLine" id="cb12-12" title="12">  <span class="op">!</span>(Chemical.Category <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb12-13" title="13">    <span class="st">&quot;Fluorinated compounds&quot;</span>,</a>
<a class="sourceLine" id="cb12-14" title="14">    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))),</a>
<a class="sourceLine" id="cb12-15" title="15">  MFratio<span class="op">~</span>MFratio.pred)</a>
<a class="sourceLine" id="cb12-16" title="16"><span class="kw">summary</span>(fit2sub)</a>
<a class="sourceLine" id="cb12-17" title="17"></a>
<a class="sourceLine" id="cb12-18" title="18"><span class="kw">RMSE</span>(fit2sub)</a>
<a class="sourceLine" id="cb12-19" title="19"></a>
<a class="sourceLine" id="cb12-20" title="20"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;When volatile and fluorinated chemicals are omitted only &quot;</span>,</a>
<a class="sourceLine" id="cb12-21" title="21">  <span class="kw">dim</span>(<span class="kw">subset</span>(MFdata.main,</a>
<a class="sourceLine" id="cb12-22" title="22">  <span class="op">!</span>(Chemical.Category <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb12-23" title="23">    <span class="st">&quot;Fluorinated compounds&quot;</span>,</a>
<a class="sourceLine" id="cb12-24" title="24">    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))))[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb12-25" title="25">  <span class="st">&quot; evaluation chemicals remain, but the R2 is &quot;</span>,</a>
<a class="sourceLine" id="cb12-26" title="26">  <span class="kw">signif</span>(<span class="kw">summary</span>(fit1sub)<span class="op">$</span>adj.r.squared,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-27" title="27">  <span class="st">&quot; and the RMSE is &quot;</span>,</a>
<a class="sourceLine" id="cb12-28" title="28">  <span class="kw">signif</span>(<span class="kw">RMSE</span>(fit1sub),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-29" title="29">  <span class="st">&quot; without the correction. When the fetal plasma fraction unbound correction is used, the predictivity decreases, slightly: R2 is &quot;</span>,</a>
<a class="sourceLine" id="cb12-30" title="30">  <span class="kw">signif</span>(<span class="kw">summary</span>(fit2sub)<span class="op">$</span>adj.r.squared,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-31" title="31">  <span class="st">&quot; and the RMSE is &quot;</span>,</a>
<a class="sourceLine" id="cb12-32" title="32">  <span class="kw">signif</span>(<span class="kw">RMSE</span>(fit2sub),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-33" title="33">  <span class="st">&quot; for the non-volatile, non-fluorinated chemicals.</span><span class="ch">\n</span><span class="st">&quot;</span>,</a>
<a class="sourceLine" id="cb12-34" title="34">  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb12-35" title="35">  </a>
<a class="sourceLine" id="cb12-36" title="36">  </a>
<a class="sourceLine" id="cb12-37" title="37"></a>
<a class="sourceLine" id="cb12-38" title="38"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;We compare the RMSE for our predictions to the standard deviation \</span></a>
<a class="sourceLine" id="cb12-39" title="39"><span class="st">of the observations &quot;</span>,</a>
<a class="sourceLine" id="cb12-40" title="40">  <span class="kw">signif</span>(<span class="kw">sd</span>(MFdata.main<span class="op">$</span>MFratio)[<span class="dv">1</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-41" title="41">  <span class="st">&quot; (&quot;</span>,</a>
<a class="sourceLine" id="cb12-42" title="42">  <span class="kw">signif</span>(<span class="kw">sd</span>(<span class="kw">subset</span>(MFdata.main,</a>
<a class="sourceLine" id="cb12-43" title="43">  <span class="op">!</span>(Chemical.Category <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb12-44" title="44">    <span class="st">&quot;Fluorinated compounds&quot;</span>,</a>
<a class="sourceLine" id="cb12-45" title="45">    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>)))<span class="op">$</span>MFratio),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-46" title="46">  <span class="st">&quot; for non PAH or fluorinated compounds).</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb12-47" title="47"></a>
<a class="sourceLine" id="cb12-48" title="48"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;The average standard deviation for chemicals with repeated observations was &quot;</span>,</a>
<a class="sourceLine" id="cb12-49" title="49">  <span class="kw">signif</span>(<span class="kw">sd</span>(<span class="kw">subset</span>(MFdata.main,N.obs<span class="op">&gt;</span><span class="dv">1</span>)<span class="op">$</span>MFratio)[<span class="dv">1</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-50" title="50">  <span class="st">&quot; (&quot;</span>,</a>
<a class="sourceLine" id="cb12-51" title="51">  <span class="kw">signif</span>(<span class="kw">sd</span>(<span class="kw">subset</span>(MFdata.main,</a>
<a class="sourceLine" id="cb12-52" title="52">  N.obs <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb12-53" title="53"><span class="st">  </span><span class="op">!</span>(Chemical.Category <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb12-54" title="54">    <span class="st">&quot;Fluorinated compounds&quot;</span>,</a>
<a class="sourceLine" id="cb12-55" title="55">    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>)))<span class="op">$</span>MFratio),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-56" title="56">  <span class="st">&quot; for non PAH or fluorinated compounds).</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb12-57" title="57"></a>
<a class="sourceLine" id="cb12-58" title="58">fit3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>repeats,MFratio<span class="op">~</span>MFratio.pred.nofup)</a>
<a class="sourceLine" id="cb12-59" title="59"><span class="kw">summary</span>(fit3)</a>
<a class="sourceLine" id="cb12-60" title="60"><span class="kw">RMSE</span>(fit3)</a>
<a class="sourceLine" id="cb12-61" title="61"></a>
<a class="sourceLine" id="cb12-62" title="62">fit3sub &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span><span class="kw">subset</span>(MFdata.main, N.obs <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb12-63" title="63"><span class="st">  </span><span class="op">!</span>(Chemical.Category <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb12-64" title="64">    <span class="st">&quot;Fluorinated compounds&quot;</span>,</a>
<a class="sourceLine" id="cb12-65" title="65">    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))),</a>
<a class="sourceLine" id="cb12-66" title="66">  MFratio<span class="op">~</span>MFratio.pred.nofup)</a>
<a class="sourceLine" id="cb12-67" title="67"><span class="kw">summary</span>(fit3sub)</a>
<a class="sourceLine" id="cb12-68" title="68"></a>
<a class="sourceLine" id="cb12-69" title="69"></a>
<a class="sourceLine" id="cb12-70" title="70">fit4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span><span class="kw">subset</span>(MFdata.main,N.obs <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>),MFratio<span class="op">~</span>MFratio.pred)</a>
<a class="sourceLine" id="cb12-71" title="71"><span class="kw">summary</span>(fit4)</a>
<a class="sourceLine" id="cb12-72" title="72"><span class="kw">RMSE</span>(fit4)</a>
<a class="sourceLine" id="cb12-73" title="73"></a>
<a class="sourceLine" id="cb12-74" title="74">fit4sub &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span><span class="kw">subset</span>(MFdata.main, N.obs <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb12-75" title="75"><span class="st">  </span><span class="op">!</span>(Chemical.Category <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb12-76" title="76">    <span class="st">&quot;Fluorinated compounds&quot;</span>,</a>
<a class="sourceLine" id="cb12-77" title="77">    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))),</a>
<a class="sourceLine" id="cb12-78" title="78">  MFratio<span class="op">~</span>MFratio.pred)</a>
<a class="sourceLine" id="cb12-79" title="79"><span class="kw">summary</span>(fit4sub)</a>
<a class="sourceLine" id="cb12-80" title="80"></a>
<a class="sourceLine" id="cb12-81" title="81"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;Overall, we observed relatively poor correlation (R2 = &quot;</span>,</a>
<a class="sourceLine" id="cb12-82" title="82">  <span class="kw">signif</span>(<span class="kw">summary</span>(fit1)<span class="op">$</span>adj.r.squared,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-83" title="83">  <span class="st">&quot;, RMSE = &quot;</span>,</a>
<a class="sourceLine" id="cb12-84" title="84">  <span class="kw">signif</span>(<span class="kw">RMSE</span>(fit1),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-85" title="85">  <span class="st">&quot;) without our fetal fup correction that was unchanged with that assumption (R2 = &quot;</span>,</a>
<a class="sourceLine" id="cb12-86" title="86">  <span class="kw">signif</span>(<span class="kw">summary</span>(fit2)<span class="op">$</span>adj.r.squared,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-87" title="87">  <span class="st">&quot;, RMSE = &quot;</span>,</a>
<a class="sourceLine" id="cb12-88" title="88">  <span class="kw">signif</span>(<span class="kw">RMSE</span>(fit2),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-89" title="89">  <span class="st">&quot;).</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb12-90" title="90"></a>
<a class="sourceLine" id="cb12-91" title="91">repeats &lt;-<span class="kw">subset</span>(MFdata.main,N.obs <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-92" title="92"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;The RMSE of the predictions for the &quot;</span>,</a>
<a class="sourceLine" id="cb12-93" title="93">  <span class="kw">dim</span>(<span class="kw">subset</span>(repeats,<span class="op">!</span>(Chemical.Category <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb12-94" title="94">    <span class="st">&quot;Fluorinated compounds&quot;</span>,</a>
<a class="sourceLine" id="cb12-95" title="95">    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))))[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb12-96" title="96">  <span class="st">&quot; non-PAH and non-fluorinated compounds with repeated observations is &quot;</span>,</a>
<a class="sourceLine" id="cb12-97" title="97">  <span class="kw">signif</span>(<span class="kw">RMSE</span>(fit4sub),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-98" title="98">  <span class="st">&quot; with the fup correction and &quot;</span>,</a>
<a class="sourceLine" id="cb12-99" title="99">  <span class="kw">signif</span>(<span class="kw">RMSE</span>(fit3sub),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb12-100" title="100">  <span class="st">&quot; without.</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb12-101" title="101"></a>
<a class="sourceLine" id="cb12-102" title="102"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;These values are close to the standard deviation of the mean but the p-value for the chemicals with repeated observations is &quot;</span>,</a>
<a class="sourceLine" id="cb12-103" title="103">  <span class="kw">signif</span>(<span class="kw">pf</span>(</a>
<a class="sourceLine" id="cb12-104" title="104">    <span class="kw">summary</span>(fit4sub)<span class="op">$</span>fstatistic[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb12-105" title="105">    <span class="kw">summary</span>(fit4sub)<span class="op">$</span>fstatistic[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb12-106" title="106">    <span class="kw">summary</span>(fit4sub)<span class="op">$</span>fstatistic[<span class="dv">3</span>]),<span class="dv">2</span>),    </a>
<a class="sourceLine" id="cb12-107" title="107"><span class="st">&quot; indicating some value for the predictive model, albeit for only &quot;</span>,</a>
<a class="sourceLine" id="cb12-108" title="108"><span class="kw">dim</span>(<span class="kw">subset</span>(repeats,<span class="op">!</span>(Chemical.Category <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb12-109" title="109">  <span class="st">&quot;Fluorinated compounds&quot;</span>,</a>
<a class="sourceLine" id="cb12-110" title="110">  <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))))[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb12-111" title="111"> <span class="st">&quot; chemicals&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb12-112" title="112">   </a>
<a class="sourceLine" id="cb12-113" title="113"></a>
<a class="sourceLine" id="cb12-114" title="114"></a>
<a class="sourceLine" id="cb12-115" title="115">Fig4.table &lt;-<span class="st"> </span><span class="kw">data.frame</span>()</a>
<a class="sourceLine" id="cb12-116" title="116">Fig4.table[<span class="st">&quot;Number of Chemicals&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(MFdata.httk<span class="op">$</span>DTXSID))</a>
<a class="sourceLine" id="cb12-117" title="117">Fig4.table[<span class="st">&quot;Number of Observations&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] &lt;-<span class="st"> </span><span class="kw">dim</span>(MFdata.httk)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb12-118" title="118">Fig4.table[<span class="st">&quot;Observed Mean (Min - Max)&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] &lt;-<span class="st"> </span><span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb12-119" title="119">  <span class="kw">signif</span>(<span class="kw">mean</span>(MFdata.httk<span class="op">$</span>MFratio),<span class="dv">2</span>),<span class="st">&quot; (&quot;</span>,</a>
<a class="sourceLine" id="cb12-120" title="120">  <span class="kw">signif</span>(<span class="kw">min</span>(MFdata.httk<span class="op">$</span>MFratio),<span class="dv">2</span>),<span class="st">&quot; - &quot;</span>,</a>
<a class="sourceLine" id="cb12-121" title="121">  <span class="kw">signif</span>(<span class="kw">max</span>(MFdata.httk<span class="op">$</span>MFratio),<span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb12-122" title="122">Fig4.table[<span class="st">&quot;Observed Standard Deviation&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">sd</span>(MFdata.httk<span class="op">$</span>MFratio),<span class="dv">2</span>) </a>
<a class="sourceLine" id="cb12-123" title="123">Fig4.table[<span class="st">&quot;Predicted Mean (Min - Max)&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] &lt;-<span class="st">  </span><span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb12-124" title="124">  <span class="kw">signif</span>(<span class="kw">mean</span>(MFdata.main<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; (&quot;</span>,</a>
<a class="sourceLine" id="cb12-125" title="125">  <span class="kw">signif</span>(<span class="kw">min</span>(MFdata.main<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; - &quot;</span>,</a>
<a class="sourceLine" id="cb12-126" title="126">  <span class="kw">signif</span>(<span class="kw">max</span>(MFdata.main<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>) </a>
<a class="sourceLine" id="cb12-127" title="127">Fig4.table[<span class="st">&quot;RMSE&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">RMSE</span>(fit2),<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-128" title="128">Fig4.table[<span class="st">&quot;R-squared&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">summary</span>(fit2)[[<span class="st">&quot;adj.r.squared&quot;</span>]],<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-129" title="129">Fig4.table[<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">summary</span>(fit2)[[<span class="st">&quot;coefficients&quot;</span>]][<span class="st">&quot;MFratio.pred&quot;</span>,<span class="dv">4</span>],<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-130" title="130"></a>
<a class="sourceLine" id="cb12-131" title="131">MFdata.sub1 &lt;-<span class="st"> </span><span class="kw">subset</span>(MFdata.httk,</a>
<a class="sourceLine" id="cb12-132" title="132">  <span class="op">!</span>(Chemical.Category <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb12-133" title="133">    <span class="st">&quot;Fluorinated compounds&quot;</span>,</a>
<a class="sourceLine" id="cb12-134" title="134">    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>)))</a>
<a class="sourceLine" id="cb12-135" title="135"></a>
<a class="sourceLine" id="cb12-136" title="136">Fig4.table[<span class="st">&quot;Number of Chemicals&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(MFdata.sub1<span class="op">$</span>DTXSID))</a>
<a class="sourceLine" id="cb12-137" title="137">Fig4.table[<span class="st">&quot;Number of Observations&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] &lt;-<span class="st"> </span><span class="kw">dim</span>(MFdata.sub1)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb12-138" title="138">Fig4.table[<span class="st">&quot;Observed Mean (Min - Max)&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] &lt;-<span class="st"> </span><span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb12-139" title="139">  <span class="kw">signif</span>(<span class="kw">mean</span>(MFdata.sub1<span class="op">$</span>MFratio,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; (&quot;</span>,</a>
<a class="sourceLine" id="cb12-140" title="140">  <span class="kw">signif</span>(<span class="kw">min</span>(MFdata.sub1<span class="op">$</span>MFratio,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; - &quot;</span>,</a>
<a class="sourceLine" id="cb12-141" title="141">  <span class="kw">signif</span>(<span class="kw">max</span>(MFdata.sub1<span class="op">$</span>MFratio,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb12-142" title="142">Fig4.table[<span class="st">&quot;Observed Standard Deviation&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">sd</span>(MFdata.sub1<span class="op">$</span>MFratio),<span class="dv">2</span>) </a>
<a class="sourceLine" id="cb12-143" title="143"></a>
<a class="sourceLine" id="cb12-144" title="144">MFdata.sub2 &lt;-<span class="st"> </span><span class="kw">subset</span>(MFdata.main,</a>
<a class="sourceLine" id="cb12-145" title="145">  <span class="op">!</span>(Chemical.Category <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb12-146" title="146">    <span class="st">&quot;Fluorinated compounds&quot;</span>,</a>
<a class="sourceLine" id="cb12-147" title="147">    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>)))</a>
<a class="sourceLine" id="cb12-148" title="148"></a>
<a class="sourceLine" id="cb12-149" title="149">Fig4.table[<span class="st">&quot;Predicted Mean (Min - Max)&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] &lt;-<span class="st">  </span><span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb12-150" title="150">  <span class="kw">signif</span>(<span class="kw">mean</span>(MFdata.sub2<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; (&quot;</span>,</a>
<a class="sourceLine" id="cb12-151" title="151">  <span class="kw">signif</span>(<span class="kw">min</span>(MFdata.sub2<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; - &quot;</span>,</a>
<a class="sourceLine" id="cb12-152" title="152">  <span class="kw">signif</span>(<span class="kw">max</span>(MFdata.sub2<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>) </a>
<a class="sourceLine" id="cb12-153" title="153">Fig4.table[<span class="st">&quot;RMSE&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">RMSE</span>(fit2sub),<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-154" title="154">Fig4.table[<span class="st">&quot;R-squared&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">summary</span>(fit2sub)[[<span class="st">&quot;adj.r.squared&quot;</span>]],<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-155" title="155">Fig4.table[<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">summary</span>(fit2sub)[[<span class="st">&quot;coefficients&quot;</span>]][<span class="st">&quot;MFratio.pred&quot;</span>,<span class="dv">4</span>],<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-156" title="156"></a>
<a class="sourceLine" id="cb12-157" title="157"></a>
<a class="sourceLine" id="cb12-158" title="158">MFdata.sub3 &lt;-<span class="st"> </span><span class="kw">subset</span>(MFdata.main,N.obs <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb12-159" title="159"><span class="st">  </span><span class="op">!</span>(Chemical.Category <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb12-160" title="160">    <span class="st">&quot;Fluorinated compounds&quot;</span>,</a>
<a class="sourceLine" id="cb12-161" title="161">    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>)))</a>
<a class="sourceLine" id="cb12-162" title="162"></a>
<a class="sourceLine" id="cb12-163" title="163">Fig4.table[<span class="st">&quot;Number of Chemicals&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(MFdata.sub3<span class="op">$</span>DTXSID))</a>
<a class="sourceLine" id="cb12-164" title="164">Fig4.table[<span class="st">&quot;Number of Observations&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] &lt;-<span class="st"> </span><span class="kw">dim</span>(MFdata.sub3)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb12-165" title="165">Fig4.table[<span class="st">&quot;Observed Mean (Min - Max)&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] &lt;-<span class="st"> </span><span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb12-166" title="166">  <span class="kw">signif</span>(<span class="kw">mean</span>(MFdata.sub3<span class="op">$</span>MFratio),<span class="dv">2</span>),<span class="st">&quot; (&quot;</span>,</a>
<a class="sourceLine" id="cb12-167" title="167">  <span class="kw">signif</span>(<span class="kw">min</span>(MFdata.sub3<span class="op">$</span>MFratio),<span class="dv">2</span>),<span class="st">&quot; - &quot;</span>,</a>
<a class="sourceLine" id="cb12-168" title="168">  <span class="kw">signif</span>(<span class="kw">max</span>(MFdata.sub3<span class="op">$</span>MFratio),<span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb12-169" title="169">Fig4.table[<span class="st">&quot;Observed Standard Deviation&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">sd</span>(MFdata.sub3<span class="op">$</span>MFratio),<span class="dv">2</span>) </a>
<a class="sourceLine" id="cb12-170" title="170"></a>
<a class="sourceLine" id="cb12-171" title="171">Fig4.table[<span class="st">&quot;Predicted Mean (Min - Max)&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] &lt;-<span class="st">  </span><span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb12-172" title="172">  <span class="kw">signif</span>(<span class="kw">mean</span>(MFdata.sub3<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; (&quot;</span>,</a>
<a class="sourceLine" id="cb12-173" title="173">  <span class="kw">signif</span>(<span class="kw">min</span>(MFdata.sub3<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; - &quot;</span>,</a>
<a class="sourceLine" id="cb12-174" title="174">  <span class="kw">signif</span>(<span class="kw">max</span>(MFdata.sub3<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>) </a>
<a class="sourceLine" id="cb12-175" title="175">Fig4.table[<span class="st">&quot;RMSE&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">RMSE</span>(fit4sub),<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-176" title="176">Fig4.table[<span class="st">&quot;R-squared&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">summary</span>(fit4sub)[[<span class="st">&quot;adj.r.squared&quot;</span>]],<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-177" title="177">Fig4.table[<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">summary</span>(fit4sub)[[<span class="st">&quot;coefficients&quot;</span>]][<span class="st">&quot;MFratio.pred&quot;</span>,<span class="dv">4</span>],<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-178" title="178"></a>
<a class="sourceLine" id="cb12-179" title="179"><span class="kw">write.csv</span>(Fig4.table[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,],<span class="dt">file=</span><span class="st">&quot;Fig4Table.csv&quot;</span>)</a></code></pre></div>
</div>
</div>
</div>
<div id="evaluation-of-area-under-the-curve-predictions" class="section level1">
<h1>Evaluation of Area Under the Curve Predictions</h1>
<p><a href="http://dx.doi.org/10.1007/s40262-017-0594-5">Dallmann et al., 2018</a> includes descriptions of toxicokinetics summary statistics, including time-integrated plasma concentrations (area under the curve or AUC) for six drugs administered to a sample of subjects including both pregnant and non-pregnant women. Additional data from X and Y for two chemicals among the httk library were collected from the literature.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co">#TKstats &lt;- as.data.frame(read_excel(&quot;MaternalFetalAUCData.xlsx&quot;))</span></a>
<a class="sourceLine" id="cb13-2" title="2">TKstats &lt;-<span class="st"> </span>httk<span class="op">::</span>pregnonpregaucs</a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4"></a>
<a class="sourceLine" id="cb13-5" title="5">ids &lt;-<span class="st"> </span><span class="kw">unique</span>(TKstats<span class="op">$</span>DTXSID)</a>
<a class="sourceLine" id="cb13-6" title="6"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(ids <span class="op">%in%</span><span class="st"> </span><span class="kw">get_cheminfo</span>(</a>
<a class="sourceLine" id="cb13-7" title="7">  <span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</a>
<a class="sourceLine" id="cb13-8" title="8">  <span class="dt">info=</span><span class="st">&quot;dtxsid&quot;</span>,</a>
<a class="sourceLine" id="cb13-9" title="9">  <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)),</a>
<a class="sourceLine" id="cb13-10" title="10">          <span class="st">&quot;chemicals for which the model fetal_pbtk can run that are in the Dallmann data set.&quot;</span>))</a>
<a class="sourceLine" id="cb13-11" title="11"></a>
<a class="sourceLine" id="cb13-12" title="12"></a>
<a class="sourceLine" id="cb13-13" title="13">TKstats.Cmax &lt;-<span class="st"> </span><span class="kw">subset</span>(TKstats,DTXSID<span class="op">!=</span><span class="st">&quot;&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Parameter<span class="op">==</span><span class="st">&quot;Cmax&quot;</span>)</a>
<a class="sourceLine" id="cb13-14" title="14">TKstats &lt;-<span class="st"> </span><span class="kw">subset</span>(TKstats,DTXSID<span class="op">!=</span><span class="st">&quot;&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Parameter <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AUCinf&quot;</span>,<span class="st">&quot;AUClast&quot;</span>))</a>
<a class="sourceLine" id="cb13-15" title="15"></a>
<a class="sourceLine" id="cb13-16" title="16">ids &lt;-<span class="st"> </span><span class="kw">unique</span>(TKstats<span class="op">$</span>DTXSID)</a>
<a class="sourceLine" id="cb13-17" title="17"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(ids <span class="op">%in%</span><span class="st"> </span><span class="kw">get_cheminfo</span>(</a>
<a class="sourceLine" id="cb13-18" title="18">  <span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</a>
<a class="sourceLine" id="cb13-19" title="19">  <span class="dt">info=</span><span class="st">&quot;dtxsid&quot;</span>,</a>
<a class="sourceLine" id="cb13-20" title="20">  <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)),</a>
<a class="sourceLine" id="cb13-21" title="21">          <span class="st">&quot;chemicals for which the model fetal_pbtk can run that have AUCs in the Dallmann data set.&quot;</span>))</a>
<a class="sourceLine" id="cb13-22" title="22"></a>
<a class="sourceLine" id="cb13-23" title="23"></a>
<a class="sourceLine" id="cb13-24" title="24"><span class="co"># Assumed body weight (kg) from Kapraun 2019</span></a>
<a class="sourceLine" id="cb13-25" title="25">BW.nonpreg &lt;-<span class="st"> </span><span class="fl">61.103</span></a>
<a class="sourceLine" id="cb13-26" title="26"></a>
<a class="sourceLine" id="cb13-27" title="27"><span class="co">#TKstats$Dose &lt;- TKstats$Dose/BW</span></a>
<a class="sourceLine" id="cb13-28" title="28"><span class="co">#TKstats$Dose.Units &lt;- &quot;mg/kg&quot;</span></a>
<a class="sourceLine" id="cb13-29" title="29"><span class="kw">colnames</span>(TKstats)[<span class="kw">colnames</span>(TKstats)<span class="op">==</span><span class="st">&quot;Observed Pregnant&quot;</span>] &lt;-<span class="st"> &quot;Observed.Pregnant&quot;</span></a>
<a class="sourceLine" id="cb13-30" title="30"><span class="kw">colnames</span>(TKstats)[<span class="kw">colnames</span>(TKstats)<span class="op">==</span><span class="st">&quot;Observed Pregnant5&quot;</span>] &lt;-<span class="st"> &quot;Observed.Pregnant5&quot;</span></a>
<a class="sourceLine" id="cb13-31" title="31"><span class="kw">colnames</span>(TKstats)[<span class="kw">colnames</span>(TKstats)<span class="op">==</span><span class="st">&quot;Observed Non-Pregnant&quot;</span>] &lt;-<span class="st"> &quot;Observed.Non.Pregnant&quot;</span></a>
<a class="sourceLine" id="cb13-32" title="32"><span class="kw">colnames</span>(TKstats)[<span class="kw">colnames</span>(TKstats)<span class="op">==</span><span class="st">&quot;Observed Non-Pregnant2&quot;</span>] &lt;-<span class="st"> &quot;Observed.Non.Pregnant2&quot;</span></a>
<a class="sourceLine" id="cb13-33" title="33"><span class="kw">colnames</span>(TKstats)[<span class="kw">colnames</span>(TKstats)<span class="op">==</span><span class="st">&quot;Dose Route&quot;</span>] &lt;-<span class="st"> &quot;Dose.Route&quot;</span></a></code></pre></div>
<div id="predict-auc" class="section level2">
<h2>Predict AUC</h2>
<p>The circumstances of the dosing varied slightly between drugs and pregnancy status required variation in simulated dose regimen as summarized in Table 12. The function solve_fetal_pbtk was used to determine the time-integrated plasma concentration (area under the curve, or AUC) for the mothers both when pregnant and non-pregnant.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="kw">unique</span>(TKstats<span class="op">$</span>DTXSID))</a>
<a class="sourceLine" id="cb14-2" title="2">{</a>
<a class="sourceLine" id="cb14-3" title="3">  <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">regexpr</span>(<span class="st">&quot;ng&quot;</span>,TKstats[TKstats<span class="op">$</span>DTXSID<span class="op">==</span>this.id,<span class="st">&quot;Dose Units&quot;</span>])<span class="op">!=-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb14-4" title="4">  {</a>
<a class="sourceLine" id="cb14-5" title="5">  }  </a>
<a class="sourceLine" id="cb14-6" title="6">  <span class="cf">if</span> (this.id <span class="op">%in%</span><span class="st"> </span><span class="kw">get_cheminfo</span>(</a>
<a class="sourceLine" id="cb14-7" title="7">    <span class="dt">info=</span><span class="st">&quot;DTXSID&quot;</span>,</a>
<a class="sourceLine" id="cb14-8" title="8">    <span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</a>
<a class="sourceLine" id="cb14-9" title="9">    <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb14-10" title="10">  {</a>
<a class="sourceLine" id="cb14-11" title="11">    this.subset &lt;-<span class="st"> </span><span class="kw">subset</span>(TKstats,DTXSID<span class="op">==</span>this.id)</a>
<a class="sourceLine" id="cb14-12" title="12">    p &lt;-<span class="st"> </span><span class="kw">parameterize_pbtk</span>(</a>
<a class="sourceLine" id="cb14-13" title="13">      <span class="dt">dtxsid=</span>this.id,</a>
<a class="sourceLine" id="cb14-14" title="14">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-15" title="15">    p<span class="op">$</span>hematocrit &lt;-<span class="st"> </span><span class="fl">0.39412</span> <span class="co"># Kapraun 2019 (unitless)</span></a>
<a class="sourceLine" id="cb14-16" title="16">    p<span class="op">$</span>Rblood2plasma &lt;-<span class="st"> </span><span class="kw">calc_rblood2plasma</span>(</a>
<a class="sourceLine" id="cb14-17" title="17">      <span class="dt">parameters=</span>p,</a>
<a class="sourceLine" id="cb14-18" title="18">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-19" title="19">    p<span class="op">$</span>BW &lt;-<span class="st"> </span>BW.nonpreg </a>
<a class="sourceLine" id="cb14-20" title="20">    p<span class="op">$</span>Qcardiacc &lt;-<span class="st"> </span><span class="fl">301.78</span> <span class="op">/</span><span class="st"> </span>p<span class="op">$</span>BW<span class="op">^</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">4</span>) <span class="co"># Kapraun 2019 (L/h/kg^3/4)</span></a>
<a class="sourceLine" id="cb14-21" title="21">    <span class="cf">for</span> (this.route <span class="cf">in</span> <span class="kw">unique</span>(this.subset<span class="op">$</span>Dose.Route))</a>
<a class="sourceLine" id="cb14-22" title="22">    {</a>
<a class="sourceLine" id="cb14-23" title="23">      this.route.subset &lt;-<span class="st"> </span><span class="kw">subset</span>(this.subset, Dose.Route<span class="op">==</span>this.route)</a>
<a class="sourceLine" id="cb14-24" title="24">      <span class="cf">if</span> (this.route.subset[<span class="dv">1</span>,<span class="st">&quot;Gestational.Age.Weeks&quot;</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">12</span>)</a>
<a class="sourceLine" id="cb14-25" title="25">      {</a>
<a class="sourceLine" id="cb14-26" title="26">        this.dose &lt;-<span class="st"> </span>this.route.subset<span class="op">$</span>Dose</a>
<a class="sourceLine" id="cb14-27" title="27">        <span class="co"># Non-pregnant PBPK:</span></a>
<a class="sourceLine" id="cb14-28" title="28">        out.nonpreg &lt;-<span class="st"> </span><span class="kw">solve_pbtk</span>(</a>
<a class="sourceLine" id="cb14-29" title="29">          <span class="dt">parameters=</span>p,</a>
<a class="sourceLine" id="cb14-30" title="30">          <span class="dt">times =</span> <span class="kw">seq</span>(<span class="dv">0</span>, this.route.subset[<span class="dv">1</span>,<span class="st">&quot;NonPreg.Duration.Days&quot;</span>],</a>
<a class="sourceLine" id="cb14-31" title="31">                      this.route.subset[<span class="dv">1</span>,<span class="st">&quot;NonPreg.Duration.Days&quot;</span>]<span class="op">/</span><span class="dv">100</span>),</a>
<a class="sourceLine" id="cb14-32" title="32">          <span class="dt">dose=</span>this.dose<span class="op">/</span>BW.nonpreg, <span class="co"># mg/kg</span></a>
<a class="sourceLine" id="cb14-33" title="33">          <span class="dt">daily.dose=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb14-34" title="34">          <span class="dt">iv.dose=</span>(this.route<span class="op">==</span><span class="st">&quot;iv&quot;</span>),</a>
<a class="sourceLine" id="cb14-35" title="35">          <span class="dt">output.units=</span><span class="st">&quot;uM&quot;</span>,</a>
<a class="sourceLine" id="cb14-36" title="36">          <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-37" title="37">        <span class="co"># Pregnant PBPK:</span></a>
<a class="sourceLine" id="cb14-38" title="38">        BW.preg &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">calc_maternal_bw</span>(</a>
<a class="sourceLine" id="cb14-39" title="39">          <span class="dt">week=</span>this.route.subset[<span class="dv">1</span>,<span class="st">&quot;Gestational.Age.Weeks&quot;</span>]))</a>
<a class="sourceLine" id="cb14-40" title="40">        out.preg &lt;-<span class="st"> </span><span class="kw">solve_fetal_pbtk</span>(</a>
<a class="sourceLine" id="cb14-41" title="41">          <span class="dt">dtxsid=</span>this.id,</a>
<a class="sourceLine" id="cb14-42" title="42">          <span class="dt">times =</span> <span class="kw">seq</span>(</a>
<a class="sourceLine" id="cb14-43" title="43">            this.route.subset[<span class="dv">1</span>,<span class="st">&quot;Gestational.Age.Weeks&quot;</span>]<span class="op">*</span><span class="dv">7</span>, </a>
<a class="sourceLine" id="cb14-44" title="44">            this.route.subset[<span class="dv">1</span>,<span class="st">&quot;Gestational.Age.Weeks&quot;</span>]<span class="op">*</span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-45" title="45"><span class="st">              </span>this.route.subset[<span class="dv">1</span>,<span class="st">&quot;Preg.Duration.Days&quot;</span>], </a>
<a class="sourceLine" id="cb14-46" title="46">            this.route.subset[<span class="dv">1</span>,<span class="st">&quot;Preg.Duration.Days&quot;</span>]<span class="op">/</span><span class="dv">100</span>),</a>
<a class="sourceLine" id="cb14-47" title="47">          <span class="dt">dose=</span>this.dose<span class="op">/</span>BW.preg, <span class="co"># mg/kg</span></a>
<a class="sourceLine" id="cb14-48" title="48">          <span class="dt">iv.dose=</span>(this.route<span class="op">==</span><span class="st">&quot;iv&quot;</span>),</a>
<a class="sourceLine" id="cb14-49" title="49">          <span class="dt">daily.dose=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb14-50" title="50">          <span class="dt">output.units=</span><span class="st">&quot;uM&quot;</span>,</a>
<a class="sourceLine" id="cb14-51" title="51">          <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-52" title="52">        <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">regexpr</span>(<span class="st">&quot;AUC&quot;</span>,this.subset<span class="op">$</span>Parameter)<span class="op">!=-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb14-53" title="53">        {</a>
<a class="sourceLine" id="cb14-54" title="54">          TKstats[TKstats<span class="op">$</span>DTXSID<span class="op">==</span>this.id <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb14-55" title="55"><span class="st">                    </span>TKstats<span class="op">$</span>Dose.Route <span class="op">==</span><span class="st"> </span>this.route <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb14-56" title="56"><span class="st">                    </span><span class="kw">regexpr</span>(<span class="st">&quot;AUC&quot;</span>,TKstats<span class="op">$</span>Parameter)<span class="op">!=-</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb14-57" title="57">                  <span class="st">&quot;Predicted.Non.Pregnant.httk&quot;</span>] &lt;-<span class="st"> </span><span class="kw">max</span>(out.nonpreg[,<span class="st">&quot;AUC&quot;</span>])<span class="op">*</span><span class="dv">24</span> <span class="co">#uMdays-&gt;uMh                        </span></a>
<a class="sourceLine" id="cb14-58" title="58">          TKstats[TKstats<span class="op">$</span>DTXSID<span class="op">==</span>this.id <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb14-59" title="59"><span class="st">                    </span>TKstats<span class="op">$</span>Dose.Route <span class="op">==</span><span class="st"> </span>this.route <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb14-60" title="60"><span class="st">                    </span><span class="kw">regexpr</span>(<span class="st">&quot;AUC&quot;</span>,TKstats<span class="op">$</span>Parameter)<span class="op">!=-</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb14-61" title="61">                  <span class="st">&quot;Predicted.Pregnant.httk&quot;</span>] &lt;-<span class="st"> </span><span class="kw">max</span>(out.preg[,<span class="st">&quot;AUC&quot;</span>])<span class="op">*</span><span class="dv">24</span> <span class="co"># uM days -&gt; uM h </span></a>
<a class="sourceLine" id="cb14-62" title="62">        }</a>
<a class="sourceLine" id="cb14-63" title="63">        <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">regexpr</span>(<span class="st">&quot;Cmax&quot;</span>,this.subset<span class="op">$</span>Parameter)<span class="op">!=-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb14-64" title="64">        {</a>
<a class="sourceLine" id="cb14-65" title="65">          TKstats[TKstats<span class="op">$</span>DTXSID<span class="op">==</span>this.id <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb14-66" title="66"><span class="st">                    </span>TKstats<span class="op">$</span>Dose.Route <span class="op">==</span><span class="st"> </span>this.route <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb14-67" title="67"><span class="st">                    </span><span class="kw">regexpr</span>(<span class="st">&quot;Cmax&quot;</span>,TKstats<span class="op">$</span>Parameter)<span class="op">!=-</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb14-68" title="68">                  <span class="st">&quot;Predicted.Non.Pregnant.httk&quot;</span>] &lt;-<span class="st"> </span><span class="kw">max</span>(out.nonpreg[,<span class="st">&quot;Cplasma&quot;</span>])</a>
<a class="sourceLine" id="cb14-69" title="69">          TKstats[TKstats<span class="op">$</span>DTXSID<span class="op">==</span>this.id <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb14-70" title="70"><span class="st">                    </span>TKstats<span class="op">$</span>Dose.Route <span class="op">==</span><span class="st"> </span>this.route <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb14-71" title="71"><span class="st">                    </span><span class="kw">regexpr</span>(<span class="st">&quot;Cmax&quot;</span>,TKstats<span class="op">$</span>Parameter)<span class="op">!=-</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb14-72" title="72">                  <span class="st">&quot;Predicted.Pregnant.httk&quot;</span>] &lt;-<span class="st"> </span><span class="kw">max</span>(out.preg[,<span class="st">&quot;Cfplasma&quot;</span>])        </a>
<a class="sourceLine" id="cb14-73" title="73">        }</a>
<a class="sourceLine" id="cb14-74" title="74">      }</a>
<a class="sourceLine" id="cb14-75" title="75">    }</a>
<a class="sourceLine" id="cb14-76" title="76">  }</a>
<a class="sourceLine" id="cb14-77" title="77">}</a>
<a class="sourceLine" id="cb14-78" title="78"></a>
<a class="sourceLine" id="cb14-79" title="79">TKstats<span class="op">$</span>Ratio.obs &lt;-<span class="st"> </span>TKstats<span class="op">$</span>Observed.Pregnant <span class="op">/</span><span class="st"> </span>TKstats<span class="op">$</span>Observed.Non.Pregnant</a>
<a class="sourceLine" id="cb14-80" title="80">TKstats<span class="op">$</span>Ratio.httk &lt;-<span class="st"> </span>TKstats<span class="op">$</span>Predicted.Pregnant.httk <span class="op">/</span><span class="st"> </span>TKstats<span class="op">$</span>Predicted.Non.Pregnant.httk</a>
<a class="sourceLine" id="cb14-81" title="81">TKstats &lt;-<span class="st"> </span><span class="kw">subset</span>(TKstats, <span class="op">!</span><span class="kw">is.na</span>(TKstats<span class="op">$</span>Ratio.httk))</a>
<a class="sourceLine" id="cb14-82" title="82"></a>
<a class="sourceLine" id="cb14-83" title="83"><span class="kw">write.csv</span>(TKstats,<span class="dt">file=</span><span class="st">&quot;Table-Dallmann2018.csv&quot;</span>,<span class="dt">row.names=</span><span class="ot">FALSE</span>)</a></code></pre></div>
</div>
<div id="generate-auc-predicted-vs.-observed-figure" class="section level2">
<h2>Generate AUC Predicted vs. Observed Figure</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">FigEa  &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>TKstats) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb15-3" title="3">    <span class="dt">y=</span>Observed.Non.Pregnant2,</a>
<a class="sourceLine" id="cb15-4" title="4">    <span class="dt">x=</span>Predicted.Non.Pregnant.httk,</a>
<a class="sourceLine" id="cb15-5" title="5">    <span class="dt">shape=</span>Dose.Route,</a>
<a class="sourceLine" id="cb15-6" title="6">    <span class="dt">alpha=</span>Drug,</a>
<a class="sourceLine" id="cb15-7" title="7">    <span class="dt">fill=</span>Drug),</a>
<a class="sourceLine" id="cb15-8" title="8">    <span class="dt">size=</span><span class="dv">5</span>)   <span class="op">+</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="dv">22</span>,<span class="dv">24</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;httk Predicted (uM*h)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Observed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="co">#limits=c(10^-3,10^3),</span></a>
<a class="sourceLine" id="cb15-16" title="16">    <span class="dt">label=</span>scientific_<span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="co">#limits=c(10^-3,10^3),</span></a>
<a class="sourceLine" id="cb15-18" title="18">    <span class="dt">label=</span>scientific_<span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Non-Pregnant&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="st">  </span><span class="kw">theme_bw</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="st">  </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-23" title="23"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">0.1</span>, <span class="dt">y =</span> <span class="dv">1000</span>, <span class="dt">label =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">fontface =</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-24" title="24">    </a>
<a class="sourceLine" id="cb15-25" title="25"><span class="co">#print(FigEa)</span></a>
<a class="sourceLine" id="cb15-26" title="26"><span class="kw">cat</span>(<span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb15-27" title="27">  <span class="st">&quot;For the Dallman et al. (2018) data we observe an average-fold error (AFE)</span><span class="ch">\n</span><span class="st">\ of&quot;</span>,</a>
<a class="sourceLine" id="cb15-28" title="28">  <span class="kw">signif</span>(<span class="kw">mean</span>(TKstats<span class="op">$</span>Predicted.Non.Pregnant.httk<span class="op">/</span>TKstats<span class="op">$</span>Observed.Non.Pregnant2),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb15-29" title="29">  <span class="st">&quot;and a RMSE (log10-scale) of&quot;</span>,</a>
<a class="sourceLine" id="cb15-30" title="30">  <span class="kw">signif</span>((<span class="kw">mean</span>((<span class="kw">log10</span>(TKstats<span class="op">$</span>Predicted.Non.Pregnant.httk)<span class="op">-</span><span class="kw">log10</span>(TKstats<span class="op">$</span>Observed.Non.Pregnant2))<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb15-31" title="31">  <span class="st">&quot;for non-pregnant woman.</span><span class="ch">\n</span><span class="st">&quot;</span>))</a>
<a class="sourceLine" id="cb15-32" title="32"></a>
<a class="sourceLine" id="cb15-33" title="33">FigEb  &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>TKstats) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-34" title="34"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb15-35" title="35">    <span class="dt">y=</span>Observed.Pregnant5,</a>
<a class="sourceLine" id="cb15-36" title="36">    <span class="dt">x=</span>Predicted.Pregnant.httk,</a>
<a class="sourceLine" id="cb15-37" title="37">    <span class="dt">shape=</span>Dose.Route,</a>
<a class="sourceLine" id="cb15-38" title="38">    <span class="dt">alpha=</span>Drug,</a>
<a class="sourceLine" id="cb15-39" title="39">    <span class="dt">fill=</span>Drug),</a>
<a class="sourceLine" id="cb15-40" title="40">    <span class="dt">size=</span><span class="dv">5</span>)   <span class="op">+</span></a>
<a class="sourceLine" id="cb15-41" title="41"><span class="st">      </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-42" title="42"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-43" title="43"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-44" title="44"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="dv">22</span>,<span class="dv">24</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-45" title="45"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;httk Predicted (uM*h)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-46" title="46"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Observed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-47" title="47"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="co">#limits=c(10^-5,10^3),</span></a>
<a class="sourceLine" id="cb15-48" title="48">                <span class="dt">label=</span>scientific_<span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-49" title="49"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="co">#limits=c(10^-5,10^3),</span></a>
<a class="sourceLine" id="cb15-50" title="50">                <span class="dt">label=</span>scientific_<span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-51" title="51"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Pregnant&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb15-52" title="52"><span class="st">  </span><span class="kw">theme_bw</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb15-53" title="53"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb15-54" title="54"><span class="st">  </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-55" title="55"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">0.1</span>, <span class="dt">y =</span> <span class="dv">300</span>, <span class="dt">label =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">fontface =</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-56" title="56">    </a>
<a class="sourceLine" id="cb15-57" title="57"><span class="co">#print(FigEb)</span></a>
<a class="sourceLine" id="cb15-58" title="58"><span class="kw">cat</span>(<span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb15-59" title="59">  <span class="st">&quot;We observe an AFE of&quot;</span>,</a>
<a class="sourceLine" id="cb15-60" title="60">  <span class="kw">signif</span>(<span class="kw">mean</span>(TKstats<span class="op">$</span>Predicted.Pregnant.httk<span class="op">/</span>TKstats<span class="op">$</span>Observed.Pregnant5),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb15-61" title="61">  <span class="st">&quot;and a RMSE (log10-scale) of&quot;</span>,</a>
<a class="sourceLine" id="cb15-62" title="62">  <span class="kw">signif</span>((<span class="kw">mean</span>((<span class="kw">log10</span>(TKstats<span class="op">$</span>Predicted.Pregnant.httk)<span class="op">-</span><span class="kw">log10</span>(TKstats<span class="op">$</span>Observed.Pregnant5))<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb15-63" title="63">  <span class="st">&quot;for pregnant woman.</span><span class="ch">\n</span><span class="st">&quot;</span>))</a>
<a class="sourceLine" id="cb15-64" title="64"></a>
<a class="sourceLine" id="cb15-65" title="65"></a>
<a class="sourceLine" id="cb15-66" title="66"></a>
<a class="sourceLine" id="cb15-67" title="67">FigEc  &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>TKstats) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-68" title="68"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb15-69" title="69">    <span class="dt">x=</span>Predicted.Non.Pregnant.httk,</a>
<a class="sourceLine" id="cb15-70" title="70">    <span class="dt">y=</span>Predicted.Pregnant.httk,</a>
<a class="sourceLine" id="cb15-71" title="71">    <span class="dt">shape=</span>Dose.Route,</a>
<a class="sourceLine" id="cb15-72" title="72">    <span class="dt">alpha=</span>Drug,</a>
<a class="sourceLine" id="cb15-73" title="73">    <span class="dt">fill=</span>Drug),</a>
<a class="sourceLine" id="cb15-74" title="74">    <span class="dt">size=</span><span class="dv">5</span>)   <span class="op">+</span></a>
<a class="sourceLine" id="cb15-75" title="75"><span class="st">      </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-76" title="76"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-77" title="77"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-78" title="78"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="dv">22</span>,<span class="dv">24</span>),<span class="dt">name=</span><span class="st">&quot;Route&quot;</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-79" title="79"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;httk Pregnant (uM*h)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-80" title="80"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;httk Non-Pregnant (uM*h)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-81" title="81"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="co">#limits=c(10^-1,10^2),</span></a>
<a class="sourceLine" id="cb15-82" title="82">                <span class="dt">label=</span>scientific_<span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-83" title="83"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="co">#limits=c(10^-1,10^2),</span></a>
<a class="sourceLine" id="cb15-84" title="84">                <span class="dt">label=</span>scientific_<span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-85" title="85"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Model Comparison&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-86" title="86"><span class="st">  </span><span class="kw">theme_bw</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb15-87" title="87"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;left&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb15-88" title="88"><span class="st">  </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-89" title="89"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb15-90" title="90"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="kw">guide_legend</span>(<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">override.aes=</span><span class="kw">list</span>(<span class="dt">shape=</span><span class="dv">21</span>)),<span class="dt">alpha=</span><span class="kw">guide_legend</span>(<span class="dt">ncol=</span><span class="dv">2</span>),<span class="dt">shape=</span><span class="kw">guide_legend</span>(<span class="dt">ncol=</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb15-91" title="91"> <span class="kw">print</span>(FigEc)   </a>
<a class="sourceLine" id="cb15-92" title="92">FigEc &lt;-<span class="st"> </span><span class="kw">get_legend</span>(FigEc)</a>
<a class="sourceLine" id="cb15-93" title="93"></a>
<a class="sourceLine" id="cb15-94" title="94"></a>
<a class="sourceLine" id="cb15-95" title="95">FigEd  &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="kw">subset</span>(TKstats,<span class="op">!</span><span class="kw">is.na</span>(Ratio.httk))) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-96" title="96"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb15-97" title="97">    <span class="dt">y=</span>Ratio.obs,</a>
<a class="sourceLine" id="cb15-98" title="98">    <span class="dt">x=</span>Ratio.httk,</a>
<a class="sourceLine" id="cb15-99" title="99">    <span class="dt">shape=</span>Dose.Route,</a>
<a class="sourceLine" id="cb15-100" title="100">    <span class="dt">alpha=</span>Drug,</a>
<a class="sourceLine" id="cb15-101" title="101">    <span class="dt">fill=</span>Drug),</a>
<a class="sourceLine" id="cb15-102" title="102">    <span class="dt">size=</span><span class="dv">5</span>)   <span class="op">+</span></a>
<a class="sourceLine" id="cb15-103" title="103"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="dv">22</span>,<span class="dv">24</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-104" title="104"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;httk Predicted&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-105" title="105"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Observed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-106" title="106"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="fl">0.25</span>,<span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-107" title="107"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="fl">0.25</span>,<span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-108" title="108"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-109" title="109"><span class="st"> </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-110" title="110"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-111" title="111"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Ratio&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-112" title="112"><span class="st">  </span><span class="kw">theme_bw</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb15-113" title="113"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb15-114" title="114"><span class="st">  </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-115" title="115"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">0.5</span>, <span class="dt">y =</span> <span class="fl">2.75</span>, <span class="dt">label =</span> <span class="st">&quot;C&quot;</span>, <span class="dt">fontface =</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-116" title="116">    </a>
<a class="sourceLine" id="cb15-117" title="117"><span class="kw">dev.new</span>()</a>
<a class="sourceLine" id="cb15-118" title="118"><span class="kw">grid.arrange</span>(FigEa,FigEb,FigEc,FigEd,<span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-119" title="119"></a>
<a class="sourceLine" id="cb15-120" title="120"><span class="kw">write.csv</span>(<span class="kw">subset</span>(TKstats,</a>
<a class="sourceLine" id="cb15-121" title="121">  <span class="op">!</span><span class="kw">is.na</span>(Ratio.httk)),</a>
<a class="sourceLine" id="cb15-122" title="122">  <span class="dt">file=</span><span class="st">&quot;DallmanTable.txt&quot;</span>)</a>
<a class="sourceLine" id="cb15-123" title="123">  </a></code></pre></div>
</div>
</div>
<div id="evaluation-of-partition-coefficient-predictions" class="section level1">
<h1>Evaluation of Partition Coefficient Predictions</h1>
<p>For each tissue, the partition coefficient (which describes the ratio of the concentration in the tissue to concentration of unbound chemical in the plasma at equilibrium) is a constant. We calculate each partition coefficient using the method of <a href="http://dx.doi.org/10.1016/j.tiv.2007.09.010">Schmitt, 2008</a> as described by <a href="http://dx.doi.org/10.1007/s10928-017-9548-7">Pearce et al., 2017</a>. The partition coefficient for any given type of tissue (for example, liver tissue) depends on fraction unbound in plasma (<span class="math inline">\(f_{up}^m\)</span> or <span class="math inline">\(f_{up}^f\)</span>), so in general these differ for mother and fetus.</p>
<p><a href="https://doi.org/10.1080/00039896.1969.10666901">Curley et al., 1969</a> compiled data on the concentration of a variety of pesticides in the cord blood of newborns and in the tissues of infants that were stillborn.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">Curley &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">read_excel</span>(<span class="st">&quot;Curley1969.xlsx&quot;</span>))</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">dim</span>(Curley)</a>
<a class="sourceLine" id="cb16-3" title="3">Curley.compounds &lt;-<span class="st"> </span>Curley[<span class="dv">1</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">13</span>]</a>
<a class="sourceLine" id="cb16-4" title="4">Curley &lt;-<span class="st"> </span>Curley[<span class="dv">4</span><span class="op">:</span><span class="dv">47</span>,]</a>
<a class="sourceLine" id="cb16-5" title="5"><span class="kw">colnames</span>(Curley)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Tissue&quot;</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="kw">colnames</span>(Curley)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;N&quot;</span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="kw">colnames</span>(Curley)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;Stat&quot;</span></a></code></pre></div>
<p>The ratio of chemical concentration in tissue (<span class="math inline">\(C_y^f\)</span>) vs. blood (<span class="math inline">\(C_{venb}^f\)</span>) was related to the tissue-to-unbound-plasma concentration partition coefficients used in the PBTK model as <span class="math display">\[
    (C_y^f )/(C_{venb}^f  )=(C_y^f)/(R_{b:p}^f \times C_{plas}^f  )=(C_y^f \times f_{up}^f)/(R_{b:p}^f \times C_{up}^f)=(f_{up}^f)/(R_{b:p}^f) \times K_y^f
\]</span> where <span class="math inline">\(C_{up}^f\)</span> denotes the concentration of substance unbound in the fetal plasma.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">Curley.pcs &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb17-2" title="2">cord.blood &lt;-<span class="st"> </span><span class="kw">subset</span>(Curley, Tissue <span class="op">==</span><span class="st"> &quot;Cord Blood&quot;</span>) </a>
<a class="sourceLine" id="cb17-3" title="3"><span class="kw">suppressWarnings</span>(</a>
<a class="sourceLine" id="cb17-4" title="4"><span class="cf">for</span> (this.tissue <span class="cf">in</span> <span class="kw">unique</span>(Curley<span class="op">$</span>Tissue))</a>
<a class="sourceLine" id="cb17-5" title="5">  <span class="cf">if</span> (this.tissue <span class="op">!=</span><span class="st"> &quot;Cord Blood&quot;</span>)</a>
<a class="sourceLine" id="cb17-6" title="6">  {</a>
<a class="sourceLine" id="cb17-7" title="7">    this.subset &lt;-<span class="st"> </span><span class="kw">subset</span>(Curley, Tissue <span class="op">==</span><span class="st"> </span>this.tissue)</a>
<a class="sourceLine" id="cb17-8" title="8">    <span class="cf">for</span> (this.chemical <span class="cf">in</span> <span class="kw">colnames</span>(Curley)[<span class="dv">4</span><span class="op">:</span><span class="dv">13</span>])</a>
<a class="sourceLine" id="cb17-9" title="9">    {</a>
<a class="sourceLine" id="cb17-10" title="10">      <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">as.numeric</span>(<span class="kw">subset</span>(this.subset,Stat<span class="op">==</span><span class="st">&quot;Mean&quot;</span>)[,this.chemical])) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="st">        </span><span class="op">!</span><span class="kw">is.na</span>(<span class="kw">as.numeric</span>(<span class="kw">subset</span>(cord.blood,Stat<span class="op">==</span><span class="st">&quot;Mean&quot;</span>)[,this.chemical])))</a>
<a class="sourceLine" id="cb17-12" title="12">      {</a>
<a class="sourceLine" id="cb17-13" title="13">        this.row &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb17-14" title="14">          <span class="dt">Compound =</span> Curley.compounds[,this.chemical],</a>
<a class="sourceLine" id="cb17-15" title="15">          <span class="dt">DTXSID =</span> this.chemical,</a>
<a class="sourceLine" id="cb17-16" title="16">          <span class="dt">Tissue =</span> this.tissue,</a>
<a class="sourceLine" id="cb17-17" title="17">          <span class="dt">PC =</span> <span class="kw">as.numeric</span>(<span class="kw">subset</span>(this.subset,Stat<span class="op">==</span><span class="st">&quot;Mean&quot;</span>)[,this.chemical]) <span class="op">/</span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="st">            </span><span class="kw">as.numeric</span>(<span class="kw">subset</span>(cord.blood,Stat<span class="op">==</span><span class="st">&quot;Mean&quot;</span>)[,this.chemical])</a>
<a class="sourceLine" id="cb17-19" title="19">          )</a>
<a class="sourceLine" id="cb17-20" title="20">        Curley.pcs &lt;-<span class="st"> </span><span class="kw">rbind</span>(Curley.pcs,this.row)</a>
<a class="sourceLine" id="cb17-21" title="21">      } <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.na</span>((<span class="kw">as.numeric</span>(<span class="kw">subset</span>(this.subset,Stat<span class="op">==</span><span class="st">&quot;Range&quot;</span>)[,this.chemical]))) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb17-22" title="22"><span class="st">        </span><span class="op">!</span><span class="kw">is.na</span>((<span class="kw">as.numeric</span>(<span class="kw">subset</span>(cord.blood,Stat<span class="op">==</span><span class="st">&quot;Mean&quot;</span>)[,this.chemical]))))</a>
<a class="sourceLine" id="cb17-23" title="23">      {</a>
<a class="sourceLine" id="cb17-24" title="24">        this.row &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb17-25" title="25">          <span class="dt">Compound =</span> Curley.compounds[,this.chemical],</a>
<a class="sourceLine" id="cb17-26" title="26">          <span class="dt">DTXSID =</span> this.chemical,</a>
<a class="sourceLine" id="cb17-27" title="27">          <span class="dt">Tissue =</span> this.tissue,</a>
<a class="sourceLine" id="cb17-28" title="28">          <span class="dt">PC =</span> <span class="kw">as.numeric</span>(<span class="kw">subset</span>(this.subset,Stat<span class="op">==</span><span class="st">&quot;Range&quot;</span>)[,this.chemical]) <span class="op">/</span></a>
<a class="sourceLine" id="cb17-29" title="29"><span class="st">            </span><span class="kw">as.numeric</span>(<span class="kw">subset</span>(cord.blood,Stat<span class="op">==</span><span class="st">&quot;Mean&quot;</span>)[,this.chemical])</a>
<a class="sourceLine" id="cb17-30" title="30">          )</a>
<a class="sourceLine" id="cb17-31" title="31">        Curley.pcs &lt;-<span class="st"> </span><span class="kw">rbind</span>(Curley.pcs,this.row)</a>
<a class="sourceLine" id="cb17-32" title="32">      }</a>
<a class="sourceLine" id="cb17-33" title="33">    }</a>
<a class="sourceLine" id="cb17-34" title="34">  }</a>
<a class="sourceLine" id="cb17-35" title="35">)</a>
<a class="sourceLine" id="cb17-36" title="36">Curley.pcs[Curley.pcs<span class="op">$</span>Tissue<span class="op">==</span><span class="st">&quot;Lungs&quot;</span>,<span class="st">&quot;Tissue&quot;</span>] &lt;-<span class="st"> &quot;Lung&quot;</span></a>
<a class="sourceLine" id="cb17-37" title="37"></a>
<a class="sourceLine" id="cb17-38" title="38">pearce2017 &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;PC_Data.xlsx&quot;</span>)</a>
<a class="sourceLine" id="cb17-39" title="39">pearce2017 &lt;-<span class="st"> </span><span class="kw">subset</span>(pearce2017,DTXSID<span class="op">%in%</span>Curley.pcs<span class="op">$</span>DTXSID)</a>
<a class="sourceLine" id="cb17-40" title="40"><span class="kw">any</span>(pearce2017<span class="op">$</span>DTXSID<span class="op">%in%</span>Curley.pcs<span class="op">$</span>DTXSID)</a>
<a class="sourceLine" id="cb17-41" title="41"><span class="kw">print</span>(<span class="st">&quot;None of the Curley chems were in the Pearce 2017 PC predictor evaluation.&quot;</span>)</a></code></pre></div>
<p>Partition coefficients were measured for tissues, including placenta, in vitro by <a href="http://dx.doi.org/10.1007/s00204-002-0339-5">Csanady et al., 2002</a> for Bisphenol A and Diadzen.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">csanadybpa &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;Csanady2002.xlsx&quot;</span>,<span class="dt">sheet=</span><span class="st">&quot;Table 2&quot;</span>)</a>
<a class="sourceLine" id="cb18-2" title="2">csanadybpa<span class="op">$</span>Compound &lt;-<span class="st"> &quot;Bisphenol A&quot;</span></a>
<a class="sourceLine" id="cb18-3" title="3">csanadybpa<span class="op">$</span>DTXSID &lt;-<span class="st"> &quot;DTXSID7020182&quot;</span></a>
<a class="sourceLine" id="cb18-4" title="4">csanadybpa &lt;-<span class="st"> </span>csanadybpa[,<span class="kw">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;Tissue&quot;</span>,<span class="st">&quot;Mean&quot;</span>)]</a>
<a class="sourceLine" id="cb18-5" title="5"><span class="kw">colnames</span>(csanadybpa) &lt;-<span class="st"> </span><span class="kw">colnames</span>(Curley.pcs)</a>
<a class="sourceLine" id="cb18-6" title="6"></a>
<a class="sourceLine" id="cb18-7" title="7">csanadydaid &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;Csanady2002.xlsx&quot;</span>,<span class="dt">sheet=</span><span class="st">&quot;Table 3&quot;</span>,<span class="dt">skip=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb18-8" title="8">csanadydaid<span class="op">$</span>Compound &lt;-<span class="st"> &quot;Daidzein&quot;</span></a>
<a class="sourceLine" id="cb18-9" title="9">csanadydaid<span class="op">$</span>DTXSID &lt;-<span class="st"> &quot;DTXSID9022310&quot;</span></a>
<a class="sourceLine" id="cb18-10" title="10">csanadydaid &lt;-<span class="st"> </span>csanadydaid[,<span class="kw">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;Tissue&quot;</span>,<span class="st">&quot;Mean...6&quot;</span>)]</a>
<a class="sourceLine" id="cb18-11" title="11"><span class="kw">colnames</span>(csanadydaid) &lt;-<span class="st"> </span><span class="kw">colnames</span>(Curley.pcs)</a>
<a class="sourceLine" id="cb18-12" title="12"></a>
<a class="sourceLine" id="cb18-13" title="13">Curley.pcs &lt;-<span class="st"> </span><span class="kw">rbind</span>(Curley.pcs,csanadybpa,csanadydaid)</a>
<a class="sourceLine" id="cb18-14" title="14">Curley.pcs &lt;-<span class="st"> </span><span class="kw">subset</span>(Curley.pcs,Tissue<span class="op">!=</span><span class="st">&quot;Mammary gland&quot;</span>)</a></code></pre></div>
<p>Three of the chemicals studied by <a href="https://doi.org/10.1080/00039896.1969.10666901">Curley et al., 1969</a> were modeled by <a href="http://dx.doi.org/10.1021/es400386a">Weijs et al., 2013</a> using the same partition coefficients for mother and fetus. The values used represented “prior knowledge” summarizing the available literature.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">weijstab3 &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;Weijs2013.xlsx&quot;</span>,<span class="dt">sheet=</span><span class="st">&quot;Table3&quot;</span>,<span class="dt">skip=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-2" title="2">weijstab3 &lt;-<span class="st"> </span><span class="kw">subset</span>(weijstab3, <span class="op">!</span><span class="kw">is.na</span>(Compound) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(Tissue))</a>
<a class="sourceLine" id="cb19-3" title="3">weijstab4 &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;Weijs2013.xlsx&quot;</span>,<span class="dt">sheet=</span><span class="st">&quot;Table4&quot;</span>,<span class="dt">skip=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-4" title="4">weijstab4 &lt;-<span class="st"> </span><span class="kw">subset</span>(weijstab4, <span class="op">!</span><span class="kw">is.na</span>(Compound) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(Tissue))</a>
<a class="sourceLine" id="cb19-5" title="5"></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="cf">for</span> (this.compound <span class="cf">in</span> <span class="kw">unique</span>(weijstab3<span class="op">$</span>Compound))</a>
<a class="sourceLine" id="cb19-7" title="7">  <span class="cf">for</span> (this.tissue <span class="cf">in</span> <span class="kw">unique</span>(weijstab3<span class="op">$</span>Tissue))</a>
<a class="sourceLine" id="cb19-8" title="8">  {</a>
<a class="sourceLine" id="cb19-9" title="9">    Curley.pcs[</a>
<a class="sourceLine" id="cb19-10" title="10">      Curley.pcs<span class="op">$</span>DTXSID<span class="op">==</span>this.compound <span class="op">&amp;</span><span class="st"> </span>Curley.pcs<span class="op">$</span>Tissue<span class="op">==</span>this.tissue,</a>
<a class="sourceLine" id="cb19-11" title="11">      <span class="st">&quot;Weijs2013&quot;</span>] &lt;-<span class="st"> </span>weijstab3[weijstab3<span class="op">$</span>Compound<span class="op">==</span>this.compound <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="st">                                  </span>weijstab3<span class="op">$</span>Tissue<span class="op">==</span>this.tissue,<span class="st">&quot;value&quot;</span>]</a>
<a class="sourceLine" id="cb19-13" title="13">      </a>
<a class="sourceLine" id="cb19-14" title="14">  }</a>
<a class="sourceLine" id="cb19-15" title="15"></a>
<a class="sourceLine" id="cb19-16" title="16"><span class="cf">for</span> (this.compound <span class="cf">in</span> <span class="kw">unique</span>(weijstab4<span class="op">$</span>Compound))</a>
<a class="sourceLine" id="cb19-17" title="17">  <span class="cf">for</span> (this.tissue <span class="cf">in</span> <span class="kw">unique</span>(weijstab4<span class="op">$</span>Tissue))</a>
<a class="sourceLine" id="cb19-18" title="18">  {</a>
<a class="sourceLine" id="cb19-19" title="19">    Curley.pcs[</a>
<a class="sourceLine" id="cb19-20" title="20">      Curley.pcs<span class="op">$</span>DTXSID<span class="op">==</span>this.compound <span class="op">&amp;</span><span class="st"> </span>Curley.pcs<span class="op">$</span>Tissue<span class="op">==</span>this.tissue,</a>
<a class="sourceLine" id="cb19-21" title="21">      <span class="st">&quot;Weijs2013&quot;</span>] &lt;-<span class="st"> </span>weijstab4[weijstab4<span class="op">$</span>Compound<span class="op">==</span>this.compound <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb19-22" title="22"><span class="st">                                  </span>weijstab4<span class="op">$</span>Tissue<span class="op">==</span>this.tissue,<span class="st">&quot;value&quot;</span>]</a>
<a class="sourceLine" id="cb19-23" title="23">      </a>
<a class="sourceLine" id="cb19-24" title="24">  }</a>
<a class="sourceLine" id="cb19-25" title="25"></a>
<a class="sourceLine" id="cb19-26" title="26"><span class="kw">write.csv</span>(Curley.pcs,<span class="st">&quot;PCs-table.csv&quot;</span>,<span class="dt">row.names=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<div id="predict-partition-coefficients" class="section level2">
<h2>Predict partition coefficients</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">Curley.pcs &lt;-<span class="st"> </span>httk<span class="op">::</span>fetalpcs</a>
<a class="sourceLine" id="cb20-2" title="2">dtxsid.list &lt;-<span class="st"> </span><span class="kw">get_cheminfo</span>(</a>
<a class="sourceLine" id="cb20-3" title="3">  <span class="dt">info=</span><span class="st">&quot;DTXSID&quot;</span>,</a>
<a class="sourceLine" id="cb20-4" title="4">  <span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</a>
<a class="sourceLine" id="cb20-5" title="5">  <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-6" title="6"></a>
<a class="sourceLine" id="cb20-7" title="7"><span class="kw">suppressWarnings</span>(<span class="kw">load_sipes2017</span>())</a>
<a class="sourceLine" id="cb20-8" title="8"><span class="cf">for</span> (this.chemical <span class="cf">in</span> <span class="kw">unique</span>(Curley.pcs<span class="op">$</span>DTXSID))</a>
<a class="sourceLine" id="cb20-9" title="9">  <span class="cf">if</span> (this.chemical <span class="op">%in%</span><span class="st"> </span>dtxsid.list)</a>
<a class="sourceLine" id="cb20-10" title="10">  {</a>
<a class="sourceLine" id="cb20-11" title="11">    this.subset &lt;-<span class="st"> </span><span class="kw">subset</span>(Curley.pcs,DTXSID<span class="op">==</span>this.chemical)</a>
<a class="sourceLine" id="cb20-12" title="12">    p &lt;-<span class="st"> </span><span class="kw">parameterize_fetal_pbtk</span>(<span class="dt">dtxsid=</span>this.chemical,</a>
<a class="sourceLine" id="cb20-13" title="13">      <span class="dt">fetal_fup_adjustment =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-14" title="14">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb20-15" title="15">      <span class="dt">minimum.Funbound.plasma =</span> <span class="fl">1e-16</span>)</a>
<a class="sourceLine" id="cb20-16" title="16">    fetal.blood.pH &lt;-<span class="st"> </span><span class="fl">7.26</span>   </a>
<a class="sourceLine" id="cb20-17" title="17">    Fup &lt;-<span class="st"> </span>p<span class="op">$</span>Fraction_unbound_plasma_fetus</a>
<a class="sourceLine" id="cb20-18" title="18">    fetal_schmitt_parms &lt;-<span class="st"> </span><span class="kw">parameterize_schmitt</span>(</a>
<a class="sourceLine" id="cb20-19" title="19">      <span class="dt">dtxsid=</span>this.chemical,</a>
<a class="sourceLine" id="cb20-20" title="20">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb20-21" title="21">      <span class="dt">minimum.Funbound.plasma =</span> <span class="fl">1e-16</span>)</a>
<a class="sourceLine" id="cb20-22" title="22">    fetal_schmitt_parms<span class="op">$</span>plasma.pH &lt;-<span class="st"> </span>fetal.blood.pH</a>
<a class="sourceLine" id="cb20-23" title="23">    fetal_schmitt_parms<span class="op">$</span>Funbound.plasma &lt;-<span class="st"> </span>Fup</a>
<a class="sourceLine" id="cb20-24" title="24">    Curley.pcs[Curley.pcs<span class="op">$</span>DTXSID<span class="op">==</span>this.chemical,<span class="st">&quot;Fup&quot;</span>] &lt;-<span class="st"> </span>Fup</a>
<a class="sourceLine" id="cb20-25" title="25">    <span class="co"># httk gives tissue:fup (unbound chemical in plasma) PC&#39;s:</span></a>
<a class="sourceLine" id="cb20-26" title="26">    fetal_pcs &lt;-<span class="st"> </span><span class="kw">predict_partitioning_schmitt</span>(</a>
<a class="sourceLine" id="cb20-27" title="27">      <span class="dt">parameters =</span> fetal_schmitt_parms,</a>
<a class="sourceLine" id="cb20-28" title="28">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb20-29" title="29">      <span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</a>
<a class="sourceLine" id="cb20-30" title="30">      <span class="dt">minimum.Funbound.plasma =</span> <span class="fl">1e-16</span>)</a>
<a class="sourceLine" id="cb20-31" title="31">    fetal_pcs.nocal &lt;-<span class="st"> </span><span class="kw">predict_partitioning_schmitt</span>(</a>
<a class="sourceLine" id="cb20-32" title="32">      <span class="dt">parameters =</span> fetal_schmitt_parms,</a>
<a class="sourceLine" id="cb20-33" title="33">      <span class="dt">regression=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-34" title="34">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb20-35" title="35">      <span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</a>
<a class="sourceLine" id="cb20-36" title="36">      <span class="dt">minimum.Funbound.plasma =</span> <span class="fl">1e-16</span>)</a>
<a class="sourceLine" id="cb20-37" title="37">    out &lt;-<span class="st"> </span><span class="kw">solve_fetal_pbtk</span>(</a>
<a class="sourceLine" id="cb20-38" title="38">      <span class="dt">dtxsid =</span> this.chemical,</a>
<a class="sourceLine" id="cb20-39" title="39">      <span class="dt">fetal_fup_adjustment =</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-40" title="40">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb20-41" title="41">      <span class="dt">minimum.Funbound.plasma =</span> <span class="fl">1e-16</span>)</a>
<a class="sourceLine" id="cb20-42" title="42">    Rb2p &lt;-<span class="st"> </span>out[<span class="kw">dim</span>(out)[<span class="dv">1</span>],<span class="st">&quot;Rfblood2plasma&quot;</span>]</a>
<a class="sourceLine" id="cb20-43" title="43">    Curley.pcs[Curley.pcs<span class="op">$</span>DTXSID<span class="op">==</span>this.chemical,<span class="st">&quot;Rb2p&quot;</span>] &lt;-<span class="st"> </span>Rb2p</a>
<a class="sourceLine" id="cb20-44" title="44">    <span class="co"># Convert to tissue:blood PC&#39;s:</span></a>
<a class="sourceLine" id="cb20-45" title="45">    <span class="cf">for</span> (this.tissue <span class="cf">in</span> this.subset<span class="op">$</span>Tissue)</a>
<a class="sourceLine" id="cb20-46" title="46">      <span class="cf">if</span> (<span class="kw">tolower</span>(this.tissue) <span class="op">%in%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-47" title="47"><span class="st">        </span><span class="kw">unique</span>(<span class="kw">subset</span>(tissue.data,Species<span class="op">==</span><span class="st">&quot;Human&quot;</span>)<span class="op">$</span>Tissue))</a>
<a class="sourceLine" id="cb20-48" title="48">      {</a>
<a class="sourceLine" id="cb20-49" title="49">        Curley.pcs[Curley.pcs<span class="op">$</span>DTXSID<span class="op">==</span>this.chemical <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb20-50" title="50"><span class="st">          </span>Curley.pcs<span class="op">$</span>Tissue <span class="op">==</span><span class="st"> </span>this.tissue, <span class="st">&quot;HTTK.pred.t2up&quot;</span>] &lt;-</a>
<a class="sourceLine" id="cb20-51" title="51"><span class="st">          </span>fetal_pcs[[<span class="kw">paste</span>(<span class="st">&quot;K&quot;</span>,<span class="kw">tolower</span>(this.tissue),<span class="st">&quot;2pu&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)]]</a>
<a class="sourceLine" id="cb20-52" title="52">        Curley.pcs[Curley.pcs<span class="op">$</span>DTXSID<span class="op">==</span>this.chemical <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb20-53" title="53"><span class="st">          </span>Curley.pcs<span class="op">$</span>Tissue <span class="op">==</span><span class="st"> </span>this.tissue, <span class="st">&quot;HTTK.pred.nocal.t2up&quot;</span>] &lt;-</a>
<a class="sourceLine" id="cb20-54" title="54"><span class="st">          </span>fetal_pcs.nocal[[<span class="kw">paste</span>(<span class="st">&quot;K&quot;</span>,<span class="kw">tolower</span>(this.tissue),<span class="st">&quot;2pu&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)]]</a>
<a class="sourceLine" id="cb20-55" title="55">        Curley.pcs[Curley.pcs<span class="op">$</span>DTXSID<span class="op">==</span>this.chemical <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb20-56" title="56"><span class="st">          </span>Curley.pcs<span class="op">$</span>Tissue <span class="op">==</span><span class="st"> </span>this.tissue, <span class="st">&quot;HTTK.pred&quot;</span>] &lt;-</a>
<a class="sourceLine" id="cb20-57" title="57"><span class="st">          </span>fetal_pcs[[<span class="kw">paste</span>(<span class="st">&quot;K&quot;</span>,<span class="kw">tolower</span>(this.tissue),<span class="st">&quot;2pu&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)]]<span class="op">*</span>Fup<span class="op">/</span>Rb2p</a>
<a class="sourceLine" id="cb20-58" title="58">        Curley.pcs[Curley.pcs<span class="op">$</span>DTXSID<span class="op">==</span>this.chemical <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb20-59" title="59"><span class="st">          </span>Curley.pcs<span class="op">$</span>Tissue <span class="op">==</span><span class="st"> </span>this.tissue, <span class="st">&quot;HTTK.pred.nocal&quot;</span>] &lt;-</a>
<a class="sourceLine" id="cb20-60" title="60"><span class="st">          </span>fetal_pcs.nocal[[<span class="kw">paste</span>(<span class="st">&quot;K&quot;</span>,<span class="kw">tolower</span>(this.tissue),<span class="st">&quot;2pu&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)]]<span class="op">*</span>Fup<span class="op">/</span>Rb2p</a>
<a class="sourceLine" id="cb20-61" title="61">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb20-62" title="62">       <span class="kw">print</span>(this.tissue)</a>
<a class="sourceLine" id="cb20-63" title="63">      }  </a>
<a class="sourceLine" id="cb20-64" title="64">  } <span class="cf">else</span> <span class="kw">print</span>(this.chemical)</a>
<a class="sourceLine" id="cb20-65" title="65"><span class="kw">reset_httk</span>()</a>
<a class="sourceLine" id="cb20-66" title="66"></a>
<a class="sourceLine" id="cb20-67" title="67"><span class="kw">cat</span>(<span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb20-68" title="68">  <span class="st">&quot;For the two placental observations (&quot;</span>,</a>
<a class="sourceLine" id="cb20-69" title="69">  <span class="kw">signif</span>(<span class="kw">subset</span>(Curley.pcs,Compound<span class="op">==</span><span class="st">&quot;Bisphenol A&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Tissue<span class="op">==</span><span class="st">&quot;Placenta&quot;</span>)[,<span class="st">&quot;PC&quot;</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb20-70" title="70">  <span class="st">&quot; for Bisphenol A and &quot;</span>,</a>
<a class="sourceLine" id="cb20-71" title="71">  <span class="kw">signif</span>(<span class="kw">subset</span>(Curley.pcs,Compound<span class="op">==</span><span class="st">&quot;Daidzein&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Tissue<span class="op">==</span><span class="st">&quot;Placenta&quot;</span>)[,<span class="st">&quot;PC&quot;</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb20-72" title="72">  <span class="st">&quot; for Diadzen) the predictions were &quot;</span>,</a>
<a class="sourceLine" id="cb20-73" title="73">  <span class="kw">signif</span>(<span class="kw">subset</span>(Curley.pcs,Compound<span class="op">==</span><span class="st">&quot;Bisphenol A&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Tissue<span class="op">==</span><span class="st">&quot;Placenta&quot;</span>)[,<span class="st">&quot;HTTK.pred&quot;</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb20-74" title="74">  <span class="st">&quot; and &quot;</span>,</a>
<a class="sourceLine" id="cb20-75" title="75">  <span class="kw">signif</span>(<span class="kw">subset</span>(Curley.pcs,Compound<span class="op">==</span><span class="st">&quot;Daidzein&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Tissue<span class="op">==</span><span class="st">&quot;Placenta&quot;</span>)[,<span class="st">&quot;HTTK.pred&quot;</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb20-76" title="76">  <span class="st">&quot;, respectively.</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
</div>
<div id="create-observed-vs.-predicted-plot" class="section level2">
<h2>Create Observed vs. Predicted Plot</h2>
<div id="first-indicate-compound" class="section level3">
<h3>First indicate compound:</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">FigFa  &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="kw">subset</span>(Curley.pcs,<span class="op">!</span><span class="kw">is.na</span>(HTTK.pred.nocal))) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">2</span>,<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb21-3" title="3">    <span class="dt">y=</span>Weijs2013,</a>
<a class="sourceLine" id="cb21-4" title="4">    <span class="dt">x=</span>HTTK.pred,    </a>
<a class="sourceLine" id="cb21-5" title="5">    <span class="dt">shape=</span>Compound,</a>
<a class="sourceLine" id="cb21-6" title="6">    <span class="dt">color=</span>Compound)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">5</span>,<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb21-8" title="8">    <span class="dt">y=</span>PC,</a>
<a class="sourceLine" id="cb21-9" title="9">    <span class="dt">x=</span>HTTK.pred,</a>
<a class="sourceLine" id="cb21-10" title="10">    <span class="dt">shape=</span>Compound,</a>
<a class="sourceLine" id="cb21-11" title="11">    <span class="dt">color=</span>Compound)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-12" title="12"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">0</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-13" title="13"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="dv">3</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-14" title="14"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="dv">3</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-15" title="15"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>),<span class="dv">4</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb21-16" title="16"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Predicted Tissue:Blood Partition Coefificent&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-17" title="17"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Observed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-18" title="18"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">1</span>,<span class="dv">10</span><span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-19" title="19"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">1</span>,<span class="dv">10</span><span class="op">^</span><span class="dv">4</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-20" title="20"><span class="st">  </span><span class="kw">theme_bw</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb21-21" title="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb21-22" title="22"><span class="st">  </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">28</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-23" title="23"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-24" title="24"><span class="st">   </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>())<span class="op">+</span></a>
<a class="sourceLine" id="cb21-25" title="25"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">shape=</span><span class="kw">guide_legend</span>(<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb21-26" title="26"></a>
<a class="sourceLine" id="cb21-27" title="27"><span class="kw">print</span>(FigFa)</a>
<a class="sourceLine" id="cb21-28" title="28"></a>
<a class="sourceLine" id="cb21-29" title="29">fitFa &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>Curley.pcs,<span class="kw">log10</span>(PC)<span class="op">~</span><span class="kw">log10</span>(HTTK.pred))</a>
<a class="sourceLine" id="cb21-30" title="30"><span class="kw">RMSE</span>(fitFa)</a>
<a class="sourceLine" id="cb21-31" title="31">fitFb &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>Curley.pcs,<span class="kw">log10</span>(PC)<span class="op">~</span><span class="kw">log10</span>(HTTK.pred.nocal))</a>
<a class="sourceLine" id="cb21-32" title="32"><span class="kw">RMSE</span>(fitFb)</a></code></pre></div>
</div>
<div id="then-indicate-tissues" class="section level3">
<h3>Then indicate tissues:</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">FigFb  &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="kw">subset</span>(Curley.pcs,<span class="op">!</span><span class="kw">is.na</span>(HTTK.pred))) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">2</span>,<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb22-3" title="3">    <span class="dt">y=</span>Weijs2013,</a>
<a class="sourceLine" id="cb22-4" title="4">    <span class="dt">x=</span>HTTK.pred,</a>
<a class="sourceLine" id="cb22-5" title="5">    <span class="dt">shape=</span>Tissue,</a>
<a class="sourceLine" id="cb22-6" title="6">    <span class="dt">color=</span>Tissue)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">5</span>, <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb22-8" title="8">    <span class="dt">y=</span>PC,</a>
<a class="sourceLine" id="cb22-9" title="9">    <span class="dt">x=</span>HTTK.pred,</a>
<a class="sourceLine" id="cb22-10" title="10">    <span class="dt">shape=</span>Tissue,</a>
<a class="sourceLine" id="cb22-11" title="11">    <span class="dt">color=</span>Tissue))   <span class="op">+</span></a>
<a class="sourceLine" id="cb22-12" title="12"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">0</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-13" title="13"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="dv">3</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-14" title="14"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="dv">3</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-15" title="15"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>),<span class="dv">4</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb22-16" title="16"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Predicted Tissue:Blood Partition Coefificent&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-17" title="17"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Observed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-18" title="18"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">1</span>,<span class="dv">10</span><span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-19" title="19"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">1</span>,<span class="dv">10</span><span class="op">^</span><span class="dv">4</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-20" title="20"><span class="st">  </span><span class="kw">theme_bw</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb22-21" title="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb22-22" title="22"><span class="st">  </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">28</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-23" title="23"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">20</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-24" title="24"><span class="st">   </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>())<span class="op">+</span></a>
<a class="sourceLine" id="cb22-25" title="25"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">shape=</span><span class="kw">guide_legend</span>(<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb22-26" title="26"></a>
<a class="sourceLine" id="cb22-27" title="27"><span class="kw">print</span>(FigFb)</a></code></pre></div>
</div>
</div>
<div id="compare-httk-partition-coefficients-with-pksim" class="section level2">
<h2>Compare httk partition coefficients with PKsim:</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">pksim.pcs &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">read_excel</span>(<span class="st">&quot;PartitionCoefficients.xlsx&quot;</span>))</a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">dim</span>(pksim.pcs)</a>
<a class="sourceLine" id="cb23-3" title="3"><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="kw">unique</span>(pksim.pcs<span class="op">$</span>DTXSID))</a>
<a class="sourceLine" id="cb23-4" title="4">{</a>
<a class="sourceLine" id="cb23-5" title="5">  httk.PCs &lt;-<span class="st"> </span><span class="kw">predict_partitioning_schmitt</span>(<span class="dt">dtxsid=</span>this.id,</a>
<a class="sourceLine" id="cb23-6" title="6">                                           <span class="dt">suppress.messages =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb23-7" title="7">  p &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb23-8" title="8"><span class="st">    </span><span class="kw">parameterize_fetal_pbtk</span>(<span class="dt">dtxsid=</span>this.id, </a>
<a class="sourceLine" id="cb23-9" title="9">    <span class="dt">suppress.messages =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb23-10" title="10">  httk.PCs[[<span class="st">&quot;Kplacenta2pu&quot;</span>]] &lt;-<span class="st"> </span>p[[<span class="st">&quot;Kplacenta2pu&quot;</span>]] </a>
<a class="sourceLine" id="cb23-11" title="11">  httk.PCs[[<span class="st">&quot;Fup&quot;</span>]] &lt;-<span class="st"> </span>p[[<span class="st">&quot;Funbound.plasma&quot;</span>]]</a>
<a class="sourceLine" id="cb23-12" title="12">  <span class="kw">lapply</span>(httk.PCs,as.numeric)</a>
<a class="sourceLine" id="cb23-13" title="13">  this.subset &lt;-<span class="st"> </span><span class="kw">subset</span>(pksim.pcs,DTXSID<span class="op">==</span>this.id)</a>
<a class="sourceLine" id="cb23-14" title="14">  <span class="cf">for</span> (this.tissue <span class="cf">in</span> <span class="kw">unique</span>(this.subset<span class="op">$</span>Tissue))</a>
<a class="sourceLine" id="cb23-15" title="15">  {</a>
<a class="sourceLine" id="cb23-16" title="16">    <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">regexpr</span>(<span class="kw">tolower</span>(this.tissue),<span class="kw">names</span>(httk.PCs))<span class="op">!=-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb23-17" title="17">    {</a>
<a class="sourceLine" id="cb23-18" title="18">      pksim.pcs[pksim.pcs<span class="op">$</span>DTXSID<span class="op">==</span>this.id <span class="op">&amp;</span><span class="st"> </span>pksim.pcs<span class="op">$</span>Tissue<span class="op">==</span>this.tissue,</a>
<a class="sourceLine" id="cb23-19" title="19">        <span class="st">&quot;HTTK.pred&quot;</span>] &lt;-<span class="st">     </span></a>
<a class="sourceLine" id="cb23-20" title="20"><span class="st">        </span>httk.PCs[<span class="kw">regexpr</span>(<span class="kw">tolower</span>(this.tissue),<span class="kw">names</span>(httk.PCs))<span class="op">!=-</span><span class="dv">1</span>][[<span class="dv">1</span>]]<span class="op">*</span></a>
<a class="sourceLine" id="cb23-21" title="21"><span class="st">        </span>httk.PCs[[<span class="st">&quot;Fup&quot;</span>]][[<span class="dv">1</span>]]         </a>
<a class="sourceLine" id="cb23-22" title="22">    }</a>
<a class="sourceLine" id="cb23-23" title="23">  }</a>
<a class="sourceLine" id="cb23-24" title="24">}</a>
<a class="sourceLine" id="cb23-25" title="25"><span class="kw">colnames</span>(pksim.pcs)[<span class="kw">colnames</span>(pksim.pcs) <span class="op">==</span></a>
<a class="sourceLine" id="cb23-26" title="26"><span class="st">                      &quot;Tissue-to-plasma partition coefficient&quot;</span>] &lt;-<span class="st"> &quot;PKSim.pred&quot;</span></a>
<a class="sourceLine" id="cb23-27" title="27"><span class="kw">colnames</span>(pksim.pcs)[<span class="kw">colnames</span>(pksim.pcs) <span class="op">==</span></a>
<a class="sourceLine" id="cb23-28" title="28"><span class="st">        &quot;Method for calculating tissue-to-plasma partition coefficients&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb23-29" title="29"><span class="st">  &quot;Method&quot;</span></a>
<a class="sourceLine" id="cb23-30" title="30">pksim.pcs[,<span class="st">&quot;Method&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.factor</span>(pksim.pcs[,<span class="st">&quot;Method&quot;</span>])</a>
<a class="sourceLine" id="cb23-31" title="31">pksim.pcs[,<span class="st">&quot;Drug&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.factor</span>(pksim.pcs[,<span class="st">&quot;Drug&quot;</span>])</a>
<a class="sourceLine" id="cb23-32" title="32">pksim.pcs[,<span class="st">&quot;Tissue&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.factor</span>(pksim.pcs[,<span class="st">&quot;Tissue&quot;</span>])</a>
<a class="sourceLine" id="cb23-33" title="33"></a>
<a class="sourceLine" id="cb23-34" title="34"></a>
<a class="sourceLine" id="cb23-35" title="35">pksim.pcs[,<span class="st">&quot;PKSim.pred&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(</a>
<a class="sourceLine" id="cb23-36" title="36">  pksim.pcs[,<span class="st">&quot;PKSim.pred&quot;</span>])</a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">pksim.pcs &lt;-<span class="st"> </span>httk<span class="op">::</span>pksim.pcs</a>
<a class="sourceLine" id="cb24-2" title="2"></a>
<a class="sourceLine" id="cb24-3" title="3">pksim.fit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>pksim.pcs,</a>
<a class="sourceLine" id="cb24-4" title="4">                <span class="kw">log10</span>(PKSim.pred)<span class="op">~</span><span class="kw">log10</span>(HTTK.pred))</a>
<a class="sourceLine" id="cb24-5" title="5"><span class="kw">summary</span>(pksim.fit1)</a>
<a class="sourceLine" id="cb24-6" title="6"></a>
<a class="sourceLine" id="cb24-7" title="7">pksim.fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>pksim.pcs,</a>
<a class="sourceLine" id="cb24-8" title="8">                <span class="kw">log10</span>(PKSim.pred)<span class="op">~</span><span class="kw">log10</span>(HTTK.pred)<span class="op">+</span></a>
<a class="sourceLine" id="cb24-9" title="9"><span class="st">                  </span>Drug<span class="op">+</span>Tissue<span class="op">+</span>Method)</a>
<a class="sourceLine" id="cb24-10" title="10"><span class="kw">summary</span>(pksim.fit2)</a></code></pre></div>
</div>
</div>
<div id="chemical-prioritization-on-the-basis-of-fetal-brain-concentration" class="section level1">
<h1>Chemical Prioritization on the Basis of Fetal Brain Concentration</h1>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co">#Wangchems &lt;- read_excel(&quot;Wang2018.xlsx&quot;,sheet=3,skip=2)</span></a>
<a class="sourceLine" id="cb25-2" title="2">Wangchems &lt;-<span class="st"> </span>httk<span class="op">::</span>wang2018</a>
<a class="sourceLine" id="cb25-3" title="3">maternal.list &lt;-<span class="st"> </span>Wangchems<span class="op">$</span>CASRN[Wangchems<span class="op">$</span>CASRN <span class="op">%in%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="st">  </span><span class="kw">get_cheminfo</span>(<span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</a>
<a class="sourceLine" id="cb25-5" title="5">  <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)]</a>
<a class="sourceLine" id="cb25-6" title="6">nonvols &lt;-<span class="st"> </span><span class="kw">subset</span>(chem.physical_and_invitro.data,logHenry <span class="op">&lt;</span><span class="st"> </span><span class="fl">-4.5</span>)<span class="op">$</span>CAS</a>
<a class="sourceLine" id="cb25-7" title="7">nonfluoros &lt;-<span class="st"> </span>chem.physical_and_invitro.data<span class="op">$</span>CAS[</a>
<a class="sourceLine" id="cb25-8" title="8">  <span class="kw">regexpr</span>(<span class="st">&quot;fluoro&quot;</span>,<span class="kw">tolower</span>(chem.physical_and_invitro.data<span class="op">$</span>Compound))<span class="op">==-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb25-9" title="9">maternal.list &lt;-<span class="st"> </span>maternal.list[maternal.list <span class="op">%in%</span><span class="st"> </span><span class="kw">intersect</span>(nonvols,nonfluoros)]</a></code></pre></div>
<p>For the plot we need a data frame with a column “Ratio.pred” broken down by the different contributions to uncertainty being plotted (columne “Uncertainty”). We build this plot by making multiple versions of pred.table and concatonating them together at the end.</p>
<div id="make-predictions-for-fetalmaternal-plasma-ratio-using-three-daily-doses-from-week-13-to-full-term" class="section level2">
<h2>Make predictions for fetal:maternal plasma ratio using three daily doses from week 13 to full term</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"></a>
<a class="sourceLine" id="cb26-2" title="2">pred.table1 &lt;-<span class="st"> </span><span class="kw">subset</span>(<span class="kw">get_cheminfo</span>(</a>
<a class="sourceLine" id="cb26-3" title="3">  <span class="dt">info=</span><span class="kw">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;CAS&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;logP&quot;</span>,<span class="st">&quot;pka_accept&quot;</span>,<span class="st">&quot;pka_donor&quot;</span>),</a>
<a class="sourceLine" id="cb26-4" title="4">  <span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>),</a>
<a class="sourceLine" id="cb26-5" title="5">  CAS <span class="op">%in%</span><span class="st"> </span>maternal.list,</a>
<a class="sourceLine" id="cb26-6" title="6">  <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-7" title="7">pred.table1<span class="op">$</span>Compound &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>,<span class="st">&quot;&quot;</span>,pred.table1<span class="op">$</span>Compound)    </a>
<a class="sourceLine" id="cb26-8" title="8"></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</a>
<a class="sourceLine" id="cb26-10" title="10">{</a>
<a class="sourceLine" id="cb26-11" title="11">  Fup &lt;-<span class="st"> </span><span class="kw">subset</span>(<span class="kw">get_cheminfo</span>(</a>
<a class="sourceLine" id="cb26-12" title="12">    <span class="dt">info=</span><span class="st">&quot;all&quot;</span>,</a>
<a class="sourceLine" id="cb26-13" title="13">    <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb26-14" title="14">    CAS<span class="op">==</span>this.cas)<span class="op">$</span>Human.Funbound.plasma</a>
<a class="sourceLine" id="cb26-15" title="15">  <span class="co"># Check if Fup is provided as a distribution:</span></a>
<a class="sourceLine" id="cb26-16" title="16">  <span class="cf">if</span> (<span class="kw">regexpr</span>(<span class="st">&quot;,&quot;</span>,Fup)<span class="op">!=-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb26-17" title="17">  {</a>
<a class="sourceLine" id="cb26-18" title="18">    <span class="cf">if</span> (<span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])<span class="op">==</span><span class="dv">0</span> <span class="op">|</span></a>
<a class="sourceLine" id="cb26-19" title="19"><span class="st">      </span>(<span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])<span class="op">&gt;</span><span class="fl">0.9</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-20" title="20"><span class="st">      </span><span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])<span class="op">&lt;</span><span class="fl">0.11</span>))</a>
<a class="sourceLine" id="cb26-21" title="21">    {</a>
<a class="sourceLine" id="cb26-22" title="22">      skip &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb26-23" title="23">    } <span class="cf">else</span> skip &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb26-24" title="24">    Fup.upper &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb26-25" title="25">    Fup &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb26-26" title="26">    <span class="co"># These results are actually from a Bayesian posterior, but we can approximate that</span></a>
<a class="sourceLine" id="cb26-27" title="27">    <span class="co"># they are normally distributed about the median to estimate a standard deviation:</span></a>
<a class="sourceLine" id="cb26-28" title="28">    Fup.sigma &lt;-<span class="st"> </span>(Fup.upper <span class="op">-</span><span class="st"> </span>Fup)<span class="op">/</span><span class="fl">1.96</span></a>
<a class="sourceLine" id="cb26-29" title="29">  <span class="co"># If it&#39;s not a distribution use defaults (see Wambaugh et al. 2019)</span></a>
<a class="sourceLine" id="cb26-30" title="30">  } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">as.numeric</span>(Fup)<span class="op">==</span><span class="st"> </span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb26-31" title="31">  {</a>
<a class="sourceLine" id="cb26-32" title="32">    skip &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb26-33" title="33">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb26-34" title="34">    skip &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb26-35" title="35">    Fup &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Fup)</a>
<a class="sourceLine" id="cb26-36" title="36">    Fup.sigma &lt;-<span class="st"> </span>Fup<span class="op">*</span><span class="fl">0.4</span></a>
<a class="sourceLine" id="cb26-37" title="37">    Fup.upper  &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="dv">1</span>,(<span class="dv">1</span><span class="fl">+1.96</span><span class="op">*</span><span class="fl">0.4</span>)<span class="op">*</span>Fup)</a>
<a class="sourceLine" id="cb26-38" title="38">  }</a>
<a class="sourceLine" id="cb26-39" title="39">  </a>
<a class="sourceLine" id="cb26-40" title="40">  <span class="co"># Only run the simulation if we have the necessary parameters:</span></a>
<a class="sourceLine" id="cb26-41" title="41">  <span class="cf">if</span> (<span class="op">!</span>skip)</a>
<a class="sourceLine" id="cb26-42" title="42">  { </a>
<a class="sourceLine" id="cb26-43" title="43">    <span class="kw">print</span>(this.cas)</a>
<a class="sourceLine" id="cb26-44" title="44">    out &lt;-<span class="st"> </span><span class="kw">solve_fetal_pbtk</span>(</a>
<a class="sourceLine" id="cb26-45" title="45">      <span class="dt">chem.cas=</span>this.cas,</a>
<a class="sourceLine" id="cb26-46" title="46">      <span class="dt">dose=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb26-47" title="47">      <span class="dt">daily.dose=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb26-48" title="48">      <span class="dt">doses.per.day=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb26-49" title="49">      <span class="dt">fetal_fup_adjustenment=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb26-50" title="50">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-51" title="51">    last.row &lt;-<span class="st"> </span><span class="kw">which</span>(out[,<span class="st">&quot;time&quot;</span>]<span class="op">&gt;</span><span class="dv">279</span>)</a>
<a class="sourceLine" id="cb26-52" title="52">    last.row &lt;-<span class="st"> </span>last.row[<span class="op">!</span><span class="kw">duplicated</span>(out[last.row,<span class="st">&quot;time&quot;</span>])]</a>
<a class="sourceLine" id="cb26-53" title="53">    pred.table1[pred.table1<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;fup&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(Fup,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb26-54" title="54">    pred.table1[pred.table1<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;fup.sigma&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(Fup.sigma,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb26-55" title="55">    pred.table1[pred.table1<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;fup.upper&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(Fup.upper,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb26-56" title="56">    pred.table1[pred.table1<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb26-57" title="57"><span class="st">      </span><span class="kw">signif</span>(<span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])<span class="op">/</span><span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>]),<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb26-58" title="58">  }</a>
<a class="sourceLine" id="cb26-59" title="59">}</a></code></pre></div>
</div>
<div id="create-final-table-holding-all-predictions-for-paper" class="section level2">
<h2>Create final table holding all predictions for paper:</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">PC.table &lt;-<span class="st"> </span>pred.table1</a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">colnames</span>(PC.table)[<span class="kw">colnames</span>(PC.table)<span class="op">==</span><span class="st">&quot;Ratio.pred&quot;</span>] &lt;-<span class="st"> &quot;R.plasma.FtoM&quot;</span></a>
<a class="sourceLine" id="cb27-3" title="3">pred.table1<span class="op">$</span>Uncertainty &lt;-<span class="st"> &quot;Predicted F:M Plasma Ratio&quot;</span></a></code></pre></div>
<div id="error-in-fetalmaternal-ratio-inverse-of-maternalfetal-ratio" class="section level3">
<h3>Error in fetal:maternal ratio (inverse of maternal:fetal ratio):</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">pred.table3 &lt;-<span class="st"> </span>pred.table1</a>
<a class="sourceLine" id="cb28-2" title="2">pred.table3<span class="op">$</span>Uncertainty &lt;-<span class="st"> &quot;Plasma Error (Fig. 4)&quot;</span></a>
<a class="sourceLine" id="cb28-3" title="3">empirical.error &lt;-<span class="st"> </span><span class="kw">RMSE</span>(fit2sub)</a>
<a class="sourceLine" id="cb28-4" title="4"><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</a>
<a class="sourceLine" id="cb28-5" title="5">{</a>
<a class="sourceLine" id="cb28-6" title="6"></a>
<a class="sourceLine" id="cb28-7" title="7">  pred.table3[pred.table3<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(</a>
<a class="sourceLine" id="cb28-8" title="8">    <span class="dv">1</span><span class="op">/</span>((<span class="dv">1</span><span class="op">/</span>pred.table1[pred.table3<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>])<span class="op">*</span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="st">         </span>(<span class="dv">1</span><span class="fl">-1.96</span><span class="op">*</span>empirical.error)), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb28-10" title="10">}</a>
<a class="sourceLine" id="cb28-11" title="11"><span class="co"># Update final table for paper:</span></a>
<a class="sourceLine" id="cb28-12" title="12">PC.table<span class="op">$</span>RMSE &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">RMSE</span>(fit2sub),<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb28-13" title="13">PC.table<span class="op">$</span>R.plasma.FtoM.upper &lt;-<span class="st"> </span>pred.table3<span class="op">$</span>Ratio.pred</a></code></pre></div>
</div>
<div id="brainplasma-partitioning" class="section level3">
<h3>brain:plasma partitioning</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">pred.table4 &lt;-<span class="st"> </span>pred.table1</a>
<a class="sourceLine" id="cb29-2" title="2">pred.table4<span class="op">$</span>Uncertainty &lt;-<span class="st"> &quot;Fetal Brain Partitioning&quot;</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</a>
<a class="sourceLine" id="cb29-4" title="4">{</a>
<a class="sourceLine" id="cb29-5" title="5">  <span class="kw">print</span>(this.cas)</a>
<a class="sourceLine" id="cb29-6" title="6">  p &lt;-<span class="st"> </span><span class="kw">parameterize_fetal_pbtk</span>(<span class="dt">chem.cas=</span>this.cas,</a>
<a class="sourceLine" id="cb29-7" title="7">      <span class="dt">fetal_fup_adjustment=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb29-8" title="8">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb29-9" title="9">  Kbrain2pu &lt;-<span class="st"> </span>p<span class="op">$</span>Kfbrain2pu</a>
<a class="sourceLine" id="cb29-10" title="10">  fup &lt;-<span class="st"> </span>pred.table4[pred.table4<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;fup&quot;</span>]</a>
<a class="sourceLine" id="cb29-11" title="11">  pred.table4[pred.table4<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(</a>
<a class="sourceLine" id="cb29-12" title="12">     PC.table[PC.table<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;R.plasma.FtoM&quot;</span>]<span class="op">*</span></a>
<a class="sourceLine" id="cb29-13" title="13"><span class="st">    </span>Kbrain2pu <span class="op">*</span><span class="st"> </span>fup, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb29-14" title="14">  PC.table[PC.table<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Kbrain2pu&quot;</span>] &lt;-<span class="st"> </span>Kbrain2pu</a>
<a class="sourceLine" id="cb29-15" title="15">  PC.table[PC.table<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;R.brain.FtoM&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb29-16" title="16"><span class="st">    </span>pred.table4[pred.table4<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>]</a>
<a class="sourceLine" id="cb29-17" title="17">}</a></code></pre></div>
</div>
<div id="brainplasma-uncertainty-partitioning" class="section level3">
<h3>brain:plasma uncertainty partitioning</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"></a>
<a class="sourceLine" id="cb30-2" title="2">pred.table5 &lt;-<span class="st"> </span>pred.table1</a>
<a class="sourceLine" id="cb30-3" title="3">pred.table5<span class="op">$</span>Uncertainty &lt;-<span class="st"> &quot;Brain Partitioning Error (Pearce et al., 2017)&quot;</span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</a>
<a class="sourceLine" id="cb30-5" title="5">{                                             </a>
<a class="sourceLine" id="cb30-6" title="6">  p &lt;-<span class="st"> </span><span class="kw">parameterize_fetal_pbtk</span>(<span class="dt">chem.cas=</span>this.cas,</a>
<a class="sourceLine" id="cb30-7" title="7">      <span class="dt">fetal_fup_adjustment=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb30-8" title="8">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb30-9" title="9">  Kbrain2pu &lt;-<span class="st"> </span>p<span class="op">$</span>Kfbrain2pu</a>
<a class="sourceLine" id="cb30-10" title="10"></a>
<a class="sourceLine" id="cb30-11" title="11">  fup &lt;-<span class="st"> </span>pred.table5[pred.table5<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;fup&quot;</span>]</a>
<a class="sourceLine" id="cb30-12" title="12">  sigma.fup &lt;-<span class="st"> </span>pred.table5[pred.table5<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;fup.sigma&quot;</span>]</a>
<a class="sourceLine" id="cb30-13" title="13">  Rmatfet &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>PC.table[PC.table<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;R.plasma.FtoM&quot;</span>]</a>
<a class="sourceLine" id="cb30-14" title="14">  Rbrain2matblood &lt;-<span class="st"> </span>Kbrain2pu <span class="op">*</span><span class="st"> </span>fup <span class="op">/</span><span class="st"> </span>Rmatfet</a>
<a class="sourceLine" id="cb30-15" title="15"></a>
<a class="sourceLine" id="cb30-16" title="16"><span class="co"># From Pearce et al. (2017) PC paper:</span></a>
<a class="sourceLine" id="cb30-17" title="17">  sigma.logKbrain &lt;-<span class="st"> </span><span class="fl">0.647</span></a>
<a class="sourceLine" id="cb30-18" title="18">  Kbrain2pu.upper &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="dv">10</span><span class="op">^</span>(<span class="kw">log10</span>(Kbrain2pu)<span class="op">+</span><span class="fl">1.96</span><span class="op">*</span>sigma.logKbrain),<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-19" title="19"></a>
<a class="sourceLine" id="cb30-20" title="20">  error.Rmatfet &lt;-<span class="st"> </span>PC.table[PC.table<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;RMSE&quot;</span>]</a>
<a class="sourceLine" id="cb30-21" title="21">  sigma.Rbrain2matblood &lt;-<span class="st"> </span>Rbrain2matblood <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-22" title="22"><span class="st">    </span>(<span class="kw">log</span>(<span class="dv">10</span>)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>sigma.logKbrain<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb30-23" title="23"><span class="st">    </span>sigma.fup<span class="op">^</span><span class="dv">2</span><span class="op">/</span>fup<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb30-24" title="24"><span class="st">    </span>error.Rmatfet<span class="op">^</span><span class="dv">2</span><span class="op">/</span>Rmatfet<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-25" title="25">  Rbrain2matblood.upper &lt;-<span class="st"> </span>Rbrain2matblood <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-26" title="26"><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">10</span>)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>sigma.logKbrain<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb30-27" title="27"><span class="st">    </span>sigma.fup<span class="op">^</span><span class="dv">2</span><span class="op">/</span>fup<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb30-28" title="28"><span class="st">    </span>error.Rmatfet<span class="op">^</span><span class="dv">2</span><span class="op">/</span>Rmatfet<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb30-29" title="29">  pred.table5[pred.table5<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb30-30" title="30"><span class="st">    </span><span class="kw">signif</span>(Rbrain2matblood.upper,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-31" title="31">  PC.table[PC.table<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;sigma.logKbrain&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb30-32" title="32"><span class="st">    </span><span class="kw">signif</span>(sigma.logKbrain, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-33" title="33">  PC.table[PC.table<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Kbrain2pu.upper&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb30-34" title="34"><span class="st">    </span><span class="kw">signif</span>(Kbrain2pu.upper, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-35" title="35">  PC.table[PC.table<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;sigma.Rbrain2matblood&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb30-36" title="36"><span class="st">    </span><span class="kw">signif</span>(sigma.Rbrain2matblood, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-37" title="37">  PC.table[PC.table<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;R.brain.FtoM.upper&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb30-38" title="38"><span class="st">    </span>pred.table5[pred.table5<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>]</a>
<a class="sourceLine" id="cb30-39" title="39">}</a></code></pre></div>
</div>
<div id="combine-different-ratio-predicitons-together-for-figure" class="section level3">
<h3>Combine different ratio predicitons together for figure</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"></a>
<a class="sourceLine" id="cb31-2" title="2">pred.levels &lt;-<span class="st"> </span>pred.table5<span class="op">$</span>Compound[<span class="kw">order</span>(pred.table5<span class="op">$</span>Ratio.pred)]</a>
<a class="sourceLine" id="cb31-3" title="3"></a>
<a class="sourceLine" id="cb31-4" title="4">pred.table &lt;-<span class="st"> </span><span class="kw">rbind</span>(</a>
<a class="sourceLine" id="cb31-5" title="5">  pred.table1,</a>
<a class="sourceLine" id="cb31-6" title="6"><span class="co">#  pred.table2,</span></a>
<a class="sourceLine" id="cb31-7" title="7">  pred.table3,</a>
<a class="sourceLine" id="cb31-8" title="8">  pred.table4,</a>
<a class="sourceLine" id="cb31-9" title="9">  pred.table5)</a>
<a class="sourceLine" id="cb31-10" title="10">pred.table<span class="op">$</span>Compound &lt;-<span class="st"> </span><span class="kw">factor</span>(pred.table<span class="op">$</span>Compound,</a>
<a class="sourceLine" id="cb31-11" title="11">  <span class="dt">levels =</span> pred.levels)</a>
<a class="sourceLine" id="cb31-12" title="12">  </a>
<a class="sourceLine" id="cb31-13" title="13">pred.table<span class="op">$</span>Uncertainty &lt;-<span class="st"> </span><span class="kw">factor</span>(pred.table<span class="op">$</span>Uncertainty, </a>
<a class="sourceLine" id="cb31-14" title="14">  <span class="dt">levels =</span> <span class="kw">c</span>(pred.table1[<span class="dv">1</span>,<span class="st">&quot;Uncertainty&quot;</span>],</a>
<a class="sourceLine" id="cb31-15" title="15"><span class="co">#    pred.table2[1,&quot;Uncertainty&quot;],</span></a>
<a class="sourceLine" id="cb31-16" title="16">    pred.table3[<span class="dv">1</span>,<span class="st">&quot;Uncertainty&quot;</span>],</a>
<a class="sourceLine" id="cb31-17" title="17">    pred.table4[<span class="dv">1</span>,<span class="st">&quot;Uncertainty&quot;</span>],</a>
<a class="sourceLine" id="cb31-18" title="18">    pred.table5[<span class="dv">1</span>,<span class="st">&quot;Uncertainty&quot;</span>]))</a></code></pre></div>
</div>
</div>
<div id="make-prioritization-figure" class="section level2">
<h2>Make prioritization figure:</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co">#Wang 2018 confirmed 6 chemical identities:</span></a>
<a class="sourceLine" id="cb32-2" title="2">confirmed.chemicals &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb32-3" title="3">  <span class="st">&quot;2,4-Di-tert-butylphenol&quot;</span>,</a>
<a class="sourceLine" id="cb32-4" title="4">  <span class="st">&quot;2,4-Dinitrophenol&quot;</span>,</a>
<a class="sourceLine" id="cb32-5" title="5">  <span class="st">&quot;Pyrocatechol&quot;</span>,</a>
<a class="sourceLine" id="cb32-6" title="6">  <span class="st">&quot;2&#39;-Hydroxyacetophenone&quot;</span>,</a>
<a class="sourceLine" id="cb32-7" title="7">  <span class="st">&quot;3,5-Di-tert-butylsalicylic acid&quot;</span>,</a>
<a class="sourceLine" id="cb32-8" title="8">  <span class="st">&quot;4-Hydroxycoumarin&quot;</span></a>
<a class="sourceLine" id="cb32-9" title="9">  )</a>
<a class="sourceLine" id="cb32-10" title="10">confirmed.chemicals &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb32-11" title="11">  <span class="st">&quot;96-76-4&quot;</span>,</a>
<a class="sourceLine" id="cb32-12" title="12">  <span class="st">&quot;19715-19-6&quot;</span>,</a>
<a class="sourceLine" id="cb32-13" title="13">  <span class="st">&quot;51-28-5&quot;</span>,</a>
<a class="sourceLine" id="cb32-14" title="14">  <span class="st">&quot;120-80-9&quot;</span>,</a>
<a class="sourceLine" id="cb32-15" title="15">  <span class="st">&quot;118-93-4&quot;</span>,</a>
<a class="sourceLine" id="cb32-16" title="16">  <span class="st">&quot;1076-38-6&quot;</span>)</a>
<a class="sourceLine" id="cb32-17" title="17"></a>
<a class="sourceLine" id="cb32-18" title="18"></a>
<a class="sourceLine" id="cb32-19" title="19">FigG  &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>pred.table) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-20" title="20"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb32-21" title="21">    <span class="dt">x=</span>Ratio.pred,</a>
<a class="sourceLine" id="cb32-22" title="22">    <span class="dt">y=</span>Compound,</a>
<a class="sourceLine" id="cb32-23" title="23">    <span class="dt">color =</span> Uncertainty,</a>
<a class="sourceLine" id="cb32-24" title="24">    <span class="dt">shape =</span> Uncertainty),</a>
<a class="sourceLine" id="cb32-25" title="25">    <span class="dt">size=</span><span class="dv">3</span>)   <span class="op">+</span></a>
<a class="sourceLine" id="cb32-26" title="26"><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">16</span>,<span class="dv">2</span>, <span class="dv">23</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">5</span>, <span class="dv">6</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-27" title="27"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">2</span>,<span class="dv">10</span><span class="op">^</span><span class="dv">3</span>),<span class="dt">label=</span>scientific_<span class="dv">10</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb32-28" title="28"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb32-29" title="29">    <span class="st">&quot;Chemicals Found in Maternal Plasma by Wang   &quot;</span>,<span class="kw">italic</span>(<span class="st">&quot;et al.&quot;</span>),<span class="st">&quot; (2018)&quot;</span>))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-30" title="30"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Predicted Ratio to Maternal Plasma&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-31" title="31"><span class="st">  </span><span class="kw">theme_bw</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb32-32" title="32"><span class="co">#  theme(legend.position=&quot;bottom&quot;)+</span></a>
<a class="sourceLine" id="cb32-33" title="33"><span class="st">  </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-34" title="34"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))<span class="co">#+ </span></a>
<a class="sourceLine" id="cb32-35" title="35"> <span class="co"># guides(color=guide_legend(nrow=4,byrow=TRUE))+ </span></a>
<a class="sourceLine" id="cb32-36" title="36">  <span class="co">#guides(shape=guide_legend(nrow=4,byrow=TRUE))</span></a>
<a class="sourceLine" id="cb32-37" title="37">  <span class="co">#+</span></a>
<a class="sourceLine" id="cb32-38" title="38"> <span class="co"># theme(legend.justification = c(0, 0), legend.position = c(0, 0))</span></a>
<a class="sourceLine" id="cb32-39" title="39">    </a>
<a class="sourceLine" id="cb32-40" title="40"><span class="kw">print</span>(FigG)</a></code></pre></div>
</div>
<div id="look-at-ionization-state" class="section level2">
<h2>Look at ionization state:</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="cf">for</span> (this.col <span class="cf">in</span> <span class="dv">7</span><span class="op">:</span><span class="dv">14</span>)</a>
<a class="sourceLine" id="cb33-3" title="3">  PC.table[,this.col] &lt;-<span class="st"> </span><span class="kw">signif</span>(PC.table[,this.col],<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb33-4" title="4"></a>
<a class="sourceLine" id="cb33-5" title="5">PC.table &lt;-<span class="st"> </span>PC.table[<span class="kw">order</span>(PC.table<span class="op">$</span>R.brain.FtoM.upper,<span class="dt">decreasing=</span><span class="ot">TRUE</span>),]</a>
<a class="sourceLine" id="cb33-6" title="6"></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="cf">for</span> (this.row <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(PC.table)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb33-8" title="8">{</a>
<a class="sourceLine" id="cb33-9" title="9">  out &lt;-<span class="st"> </span><span class="kw">calc_ionization</span>(</a>
<a class="sourceLine" id="cb33-10" title="10">    <span class="dt">pH=</span><span class="fl">7.26</span>,</a>
<a class="sourceLine" id="cb33-11" title="11">    <span class="dt">pKa_Donor=</span>PC.table[this.row,<span class="st">&quot;pKa_Donor&quot;</span>],</a>
<a class="sourceLine" id="cb33-12" title="12">    <span class="dt">pKa_Accept=</span>PC.table[this.row,<span class="st">&quot;pKa_Accept&quot;</span>])</a>
<a class="sourceLine" id="cb33-13" title="13">  <span class="cf">if</span> (out<span class="op">$</span>fraction_neutral<span class="op">&gt;</span><span class="fl">0.9</span>) PC.table[this.row,<span class="st">&quot;Charge_726&quot;</span>] &lt;-<span class="st"> &quot;Neutral&quot;</span></a>
<a class="sourceLine" id="cb33-14" title="14">  <span class="cf">else</span> <span class="cf">if</span> (out<span class="op">$</span>fraction_positive<span class="op">&gt;</span><span class="fl">0.1</span>) PC.table[this.row,<span class="st">&quot;Charge_726&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb33-15" title="15"><span class="st">    </span><span class="kw">paste</span>(<span class="kw">signif</span>(out<span class="op">$</span>fraction_positive<span class="op">*</span><span class="dv">100</span>,<span class="dv">2</span>),<span class="st">&quot;% Positive&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-16" title="16">  <span class="cf">else</span> <span class="cf">if</span> (out<span class="op">$</span>fraction_negative<span class="op">&gt;</span><span class="fl">0.1</span>) PC.table[this.row,<span class="st">&quot;Charge_726&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb33-17" title="17"><span class="st">    </span><span class="kw">paste</span>(<span class="kw">signif</span>(out<span class="op">$</span>fraction_negative<span class="op">*</span><span class="dv">100</span>,<span class="dv">2</span>),<span class="st">&quot;% Negative&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-18" title="18">  <span class="cf">else</span> <span class="cf">if</span> (out<span class="op">$</span>fraction_zwitter<span class="op">&gt;</span><span class="fl">0.1</span>) PC.table[this.row,<span class="st">&quot;Charge_726&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb33-19" title="19"><span class="st">    </span><span class="kw">paste</span>(<span class="kw">signif</span>(out<span class="op">$</span>fraction_zwitter<span class="op">*</span><span class="dv">100</span>,<span class="dv">2</span>),<span class="st">&quot;% Zwitterion&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-20" title="20">}</a>
<a class="sourceLine" id="cb33-21" title="21"></a>
<a class="sourceLine" id="cb33-22" title="22">PC.table &lt;-<span class="st"> </span>PC.table[,<span class="kw">c</span>(</a>
<a class="sourceLine" id="cb33-23" title="23">  <span class="st">&quot;Compound&quot;</span>,</a>
<a class="sourceLine" id="cb33-24" title="24">  <span class="st">&quot;CAS&quot;</span>,</a>
<a class="sourceLine" id="cb33-25" title="25">  <span class="st">&quot;DTXSID&quot;</span>,</a>
<a class="sourceLine" id="cb33-26" title="26">  <span class="st">&quot;logP&quot;</span>,</a>
<a class="sourceLine" id="cb33-27" title="27">  <span class="st">&quot;Charge_726&quot;</span>,</a>
<a class="sourceLine" id="cb33-28" title="28">  <span class="st">&quot;R.plasma.FtoM&quot;</span>,</a>
<a class="sourceLine" id="cb33-29" title="29">  <span class="st">&quot;RMSE&quot;</span>,</a>
<a class="sourceLine" id="cb33-30" title="30">  <span class="st">&quot;R.plasma.FtoM.upper&quot;</span>,</a>
<a class="sourceLine" id="cb33-31" title="31">  <span class="st">&quot;Kbrain2pu&quot;</span>,</a>
<a class="sourceLine" id="cb33-32" title="32">  <span class="st">&quot;fup&quot;</span>,</a>
<a class="sourceLine" id="cb33-33" title="33">  <span class="st">&quot;R.brain.FtoM&quot;</span>,</a>
<a class="sourceLine" id="cb33-34" title="34">  <span class="st">&quot;Kbrain2pu.upper&quot;</span>,</a>
<a class="sourceLine" id="cb33-35" title="35">  <span class="st">&quot;R.brain.FtoM.upper&quot;</span>)]</a>
<a class="sourceLine" id="cb33-36" title="36"></a>
<a class="sourceLine" id="cb33-37" title="37"><span class="kw">write.csv</span>(PC.table,</a>
<a class="sourceLine" id="cb33-38" title="38">  <span class="dt">file=</span><span class="st">&quot;WangTable.txt&quot;</span>,</a>
<a class="sourceLine" id="cb33-39" title="39">  <span class="dt">row.names=</span><span class="ot">FALSE</span>)   </a></code></pre></div>
</div>
<div id="evaluate-any-value-added-by-pbpk-model-over-just-using-partition-coefficients" class="section level2">
<h2>Evaluate any value added by PBPK model over just using partition coefficients:</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">MFbrainfit &lt;-<span class="st"> </span><span class="kw">lm</span>(R.brain.FtoM.upper<span class="op">~</span>Kbrain2pu.upper,<span class="dt">data=</span>PC.table)</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="kw">summary</span>(MFbrainfit)</a>
<a class="sourceLine" id="cb34-3" title="3"></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;As expected, the predicted fetal brain to maternal blood ratio was strongly correlated with the predicted brain partition coefficient (R2 = &quot;</span>,</a>
<a class="sourceLine" id="cb34-5" title="5">  <span class="kw">signif</span>(<span class="kw">summary</span>(MFbrainfit)<span class="op">$</span>adj.r.square,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb34-6" title="6">  <span class="st">&quot;, p-value &quot;</span>,</a>
<a class="sourceLine" id="cb34-7" title="7">  <span class="kw">signif</span>(<span class="kw">summary</span>(MFbrainfit)<span class="op">$</span>coefficients[<span class="dv">2</span>,<span class="dv">4</span>],<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb34-8" title="8">  <span class="st">&quot;). However, the PBTK simulation impacted the plasma and tissue concentrations such that &quot;</span>,</a>
<a class="sourceLine" id="cb34-9" title="9">  <span class="kw">dim</span>(<span class="kw">subset</span>(PC.table, <span class="kw">rank</span>(R.brain.FtoM.upper) <span class="op">&lt;</span><span class="st">  </span><span class="kw">rank</span>(Kbrain2pu.upper)))[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb34-10" title="10">  <span class="st">&quot; chemicals were ranked higher than they would have been using partitioning alone.&quot;</span>,</a>
<a class="sourceLine" id="cb34-11" title="11">  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
</div>
</div>
<div id="repeat-analysis-without-fetal-protein-binding-change" class="section level1">
<h1>Repeat analysis without fetal protein binding change:</h1>
<div id="make-predictions-for-fetalmaternal-plasma-ratio-using-three-daily-doses-from-week-13-to-full-term-1" class="section level2">
<h2>Make predictions for fetal:maternal plasma ratio using three daily doses from week 13 to full term</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"></a>
<a class="sourceLine" id="cb35-2" title="2">pred.table1.nofup &lt;-<span class="st"> </span><span class="kw">subset</span>(<span class="kw">get_cheminfo</span>(</a>
<a class="sourceLine" id="cb35-3" title="3">  <span class="dt">info=</span><span class="kw">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;CAS&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;logP&quot;</span>,<span class="st">&quot;pka_accept&quot;</span>,<span class="st">&quot;pka_donor&quot;</span>),</a>
<a class="sourceLine" id="cb35-4" title="4">  <span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</a>
<a class="sourceLine" id="cb35-5" title="5">  <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb35-6" title="6">  CAS <span class="op">%in%</span><span class="st"> </span>maternal.list)</a>
<a class="sourceLine" id="cb35-7" title="7">pred.table1.nofup<span class="op">$</span>Compound &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>,<span class="st">&quot;&quot;</span>,pred.table1.nofup<span class="op">$</span>Compound)    </a>
<a class="sourceLine" id="cb35-8" title="8"></a>
<a class="sourceLine" id="cb35-9" title="9"><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</a>
<a class="sourceLine" id="cb35-10" title="10">{</a>
<a class="sourceLine" id="cb35-11" title="11">  Fup &lt;-<span class="st"> </span><span class="kw">subset</span>(<span class="kw">get_cheminfo</span>(</a>
<a class="sourceLine" id="cb35-12" title="12">    <span class="dt">info=</span><span class="st">&quot;all&quot;</span>,</a>
<a class="sourceLine" id="cb35-13" title="13">    <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb35-14" title="14">    CAS<span class="op">==</span>this.cas)<span class="op">$</span>Human.Funbound.plasma</a>
<a class="sourceLine" id="cb35-15" title="15">  <span class="co"># Check if Fup is provided as a distribution:</span></a>
<a class="sourceLine" id="cb35-16" title="16">  <span class="cf">if</span> (<span class="kw">regexpr</span>(<span class="st">&quot;,&quot;</span>,Fup)<span class="op">!=-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb35-17" title="17">  {</a>
<a class="sourceLine" id="cb35-18" title="18">    <span class="cf">if</span> (<span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])<span class="op">==</span><span class="dv">0</span> <span class="op">|</span></a>
<a class="sourceLine" id="cb35-19" title="19"><span class="st">      </span>(<span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])<span class="op">&gt;</span><span class="fl">0.9</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-20" title="20"><span class="st">      </span><span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])<span class="op">&lt;</span><span class="fl">0.11</span>))</a>
<a class="sourceLine" id="cb35-21" title="21">    {</a>
<a class="sourceLine" id="cb35-22" title="22">      skip &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb35-23" title="23">    } <span class="cf">else</span> skip &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb35-24" title="24">    Fup.upper &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb35-25" title="25">    Fup &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb35-26" title="26">    <span class="co"># These results are actually from a Bayesian posterior, but we can approximate that</span></a>
<a class="sourceLine" id="cb35-27" title="27">    <span class="co"># they are normally distributed about the median to estimate a standard deviation:</span></a>
<a class="sourceLine" id="cb35-28" title="28">    Fup.sigma &lt;-<span class="st"> </span>(Fup.upper <span class="op">-</span><span class="st"> </span>Fup)<span class="op">/</span><span class="fl">1.96</span></a>
<a class="sourceLine" id="cb35-29" title="29">  <span class="co"># If it&#39;s not a distribution use defaults (see Wambaugh et al. 2019)</span></a>
<a class="sourceLine" id="cb35-30" title="30">  } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">as.numeric</span>(Fup)<span class="op">==</span><span class="st"> </span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb35-31" title="31">  {</a>
<a class="sourceLine" id="cb35-32" title="32">    skip &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb35-33" title="33">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb35-34" title="34">    skip &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb35-35" title="35">    Fup &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Fup)</a>
<a class="sourceLine" id="cb35-36" title="36">    Fup.sigma &lt;-<span class="st"> </span>Fup<span class="op">*</span><span class="fl">0.4</span></a>
<a class="sourceLine" id="cb35-37" title="37">    Fup.upper  &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="dv">1</span>,(<span class="dv">1</span><span class="fl">+1.96</span><span class="op">*</span><span class="fl">0.4</span>)<span class="op">*</span>Fup)</a>
<a class="sourceLine" id="cb35-38" title="38">  }</a>
<a class="sourceLine" id="cb35-39" title="39">  </a>
<a class="sourceLine" id="cb35-40" title="40">  <span class="co"># Only run the simulation if we have the necessary parameters:</span></a>
<a class="sourceLine" id="cb35-41" title="41">  <span class="cf">if</span> (<span class="op">!</span>skip)</a>
<a class="sourceLine" id="cb35-42" title="42">  {  </a>
<a class="sourceLine" id="cb35-43" title="43">    out &lt;-<span class="st"> </span><span class="kw">solve_fetal_pbtk</span>(</a>
<a class="sourceLine" id="cb35-44" title="44">      <span class="dt">chem.cas=</span>this.cas,</a>
<a class="sourceLine" id="cb35-45" title="45">      <span class="dt">dose=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb35-46" title="46">      <span class="dt">daily.dose=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb35-47" title="47">      <span class="dt">doses.per.day=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb35-48" title="48">      <span class="dt">fetal_fup_adjustenment=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb35-49" title="49">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb35-50" title="50">    last.row &lt;-<span class="st"> </span><span class="kw">which</span>(out[,<span class="st">&quot;time&quot;</span>]<span class="op">&gt;</span><span class="dv">279</span>)</a>
<a class="sourceLine" id="cb35-51" title="51">    last.row &lt;-<span class="st"> </span>last.row[<span class="op">!</span><span class="kw">duplicated</span>(out[last.row,<span class="st">&quot;time&quot;</span>])]</a>
<a class="sourceLine" id="cb35-52" title="52">    pred.table1.nofup[pred.table1.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;fup&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(Fup,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb35-53" title="53">    pred.table1.nofup[pred.table1.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;fup.sigma&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(Fup.sigma,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb35-54" title="54">    pred.table1.nofup[pred.table1.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;fup.upper&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(Fup.upper,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb35-55" title="55">    pred.table1.nofup[pred.table1.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb35-56" title="56"><span class="st">      </span><span class="kw">signif</span>(<span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])<span class="op">/</span><span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>]),<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb35-57" title="57">  }</a>
<a class="sourceLine" id="cb35-58" title="58">}</a></code></pre></div>
</div>
<div id="create-final-table-holding-all-predictions-for-paper-1" class="section level2">
<h2>Create final table holding all predictions for paper:</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">PC.table.nofup &lt;-<span class="st"> </span>pred.table1.nofup</a>
<a class="sourceLine" id="cb36-2" title="2"><span class="kw">colnames</span>(PC.table.nofup)[<span class="kw">colnames</span>(PC.table.nofup)<span class="op">==</span><span class="st">&quot;Ratio.pred&quot;</span>] &lt;-<span class="st"> &quot;R.plasma.FtoM&quot;</span></a>
<a class="sourceLine" id="cb36-3" title="3">pred.table1.nofup<span class="op">$</span>Uncertainty &lt;-<span class="st"> &quot;Predicted F:M Plasma Ratio&quot;</span></a></code></pre></div>
<div id="error-in-fetalmaternal-ratio-inverse-of-maternalfetal-ratio-1" class="section level3">
<h3>Error in fetal:maternal ratio (inverse of maternal:fetal ratio):</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">pred.table3.nofup &lt;-<span class="st"> </span>pred.table1.nofup</a>
<a class="sourceLine" id="cb37-2" title="2">pred.table3.nofup<span class="op">$</span>Uncertainty &lt;-<span class="st"> &quot;Plasma Error (Fig. 4)&quot;</span></a>
<a class="sourceLine" id="cb37-3" title="3">empirical.error &lt;-<span class="st"> </span><span class="kw">RMSE</span>(fit2sub)</a>
<a class="sourceLine" id="cb37-4" title="4"><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</a>
<a class="sourceLine" id="cb37-5" title="5">{</a>
<a class="sourceLine" id="cb37-6" title="6"></a>
<a class="sourceLine" id="cb37-7" title="7">  pred.table3.nofup[pred.table3.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(</a>
<a class="sourceLine" id="cb37-8" title="8">    <span class="dv">1</span><span class="op">/</span>((<span class="dv">1</span><span class="op">/</span>pred.table1.nofup[pred.table3.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>])<span class="op">*</span></a>
<a class="sourceLine" id="cb37-9" title="9"><span class="st">         </span>(<span class="dv">1</span><span class="fl">-1.96</span><span class="op">*</span>empirical.error)), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb37-10" title="10">}</a>
<a class="sourceLine" id="cb37-11" title="11"><span class="co"># Update final table for paper:</span></a>
<a class="sourceLine" id="cb37-12" title="12">PC.table.nofup<span class="op">$</span>RMSE &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="kw">RMSE</span>(fit2sub),<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb37-13" title="13">PC.table.nofup<span class="op">$</span>R.plasma.FtoM.upper &lt;-<span class="st"> </span>pred.table3.nofup<span class="op">$</span>Ratio.pred</a></code></pre></div>
</div>
<div id="brainplasma-partitioning-1" class="section level3">
<h3>brain:plasma partitioning</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">pred.table4.nofup &lt;-<span class="st"> </span>pred.table1.nofup</a>
<a class="sourceLine" id="cb38-2" title="2">pred.table4.nofup<span class="op">$</span>Uncertainty &lt;-<span class="st"> &quot;Fetal Brain Partitioning&quot;</span></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</a>
<a class="sourceLine" id="cb38-4" title="4">{</a>
<a class="sourceLine" id="cb38-5" title="5">  p &lt;-<span class="st"> </span><span class="kw">parameterize_fetal_pbtk</span>(<span class="dt">chem.cas=</span>this.cas,</a>
<a class="sourceLine" id="cb38-6" title="6">      <span class="dt">fetal_fup_adjustment=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb38-7" title="7">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb38-8" title="8">  Kbrain2pu &lt;-<span class="st"> </span>p<span class="op">$</span>Kfbrain2pu</a>
<a class="sourceLine" id="cb38-9" title="9">  fup &lt;-<span class="st"> </span>pred.table4.nofup[pred.table4.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;fup&quot;</span>]</a>
<a class="sourceLine" id="cb38-10" title="10">  pred.table4.nofup[pred.table4.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] &lt;-<span class="st"> </span><span class="kw">signif</span>(</a>
<a class="sourceLine" id="cb38-11" title="11">     PC.table.nofup[PC.table.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;R.plasma.FtoM&quot;</span>]<span class="op">*</span></a>
<a class="sourceLine" id="cb38-12" title="12"><span class="st">    </span>Kbrain2pu <span class="op">*</span><span class="st"> </span>fup, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb38-13" title="13">  PC.table.nofup[PC.table.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Kbrain2pu&quot;</span>] &lt;-<span class="st"> </span>Kbrain2pu</a>
<a class="sourceLine" id="cb38-14" title="14">  PC.table.nofup[PC.table.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;R.brain.FtoM&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb38-15" title="15"><span class="st">    </span>pred.table4.nofup[pred.table4.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>]</a>
<a class="sourceLine" id="cb38-16" title="16">}</a></code></pre></div>
</div>
<div id="brainplasma-uncertainty-partitioning-1" class="section level3">
<h3>brain:plasma uncertainty partitioning</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"></a>
<a class="sourceLine" id="cb39-2" title="2">pred.table5.nofup &lt;-<span class="st"> </span>pred.table1.nofup</a>
<a class="sourceLine" id="cb39-3" title="3">pred.table5.nofup<span class="op">$</span>Uncertainty &lt;-<span class="st"> &quot;Brain Partitioning Error (Pearce et al., 2017)&quot;</span></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</a>
<a class="sourceLine" id="cb39-5" title="5">{                                             </a>
<a class="sourceLine" id="cb39-6" title="6">  p &lt;-<span class="st"> </span><span class="kw">parameterize_fetal_pbtk</span>(<span class="dt">chem.cas=</span>this.cas,</a>
<a class="sourceLine" id="cb39-7" title="7">      <span class="dt">fetal_fup_adjustment=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb39-8" title="8">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb39-9" title="9">  Kbrain2pu &lt;-<span class="st"> </span>p<span class="op">$</span>Kfbrain2pu</a>
<a class="sourceLine" id="cb39-10" title="10"></a>
<a class="sourceLine" id="cb39-11" title="11">  fup &lt;-<span class="st"> </span>pred.table5.nofup[pred.table5.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;fup&quot;</span>]</a>
<a class="sourceLine" id="cb39-12" title="12">  sigma.fup &lt;-<span class="st"> </span>pred.table5.nofup[pred.table5.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;fup.sigma&quot;</span>]</a>
<a class="sourceLine" id="cb39-13" title="13">  Rmatfet &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>PC.table[PC.table.nofup<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;R.plasma.FtoM&quot;</span>]</a>
<a class="sourceLine" id="cb39-14" title="14">  Rbrain2matblood &lt;-<span class="st"> </span>Kbrain2pu <span class="op">*</span><span class="st"> </span>fup <span class="op">/</span><span class="st"> </span>Rmatfet</a>
<a class="sourceLine" id="cb39-15" title="15"></a>
<a class="sourceLine" id="cb39-16" title="16"><span class="co"># From Pearce et al. (2017) PC paper:</span></a>
<a class="sourceLine" id="cb39-17" title="17">  sigma.logKbrain &lt;-<span class="st"> </span><span class="fl">0.647</span></a>
<a class="sourceLine" id="cb39-18" title="18">  Kbrain2pu.upper &lt;-<span class="st"> </span><span class="kw">signif</span>(<span class="dv">10</span><span class="op">^</span>(<span class="kw">log10</span>(Kbrain2pu)<span class="op">+</span><span class="fl">1.96</span><span class="op">*</span>sigma.logKbrain),<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb39-19" title="19"></a>
<a class="sourceLine" id="cb39-20" title="20">  error.Rmatfet &lt;-<span class="st"> </span>PC.table.nofup [PC.table.nofup <span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;RMSE&quot;</span>]</a>
<a class="sourceLine" id="cb39-21" title="21">  sigma.Rbrain2matblood &lt;-<span class="st"> </span>Rbrain2matblood <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-22" title="22"><span class="st">    </span>(<span class="kw">log</span>(<span class="dv">10</span>)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>sigma.logKbrain<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb39-23" title="23"><span class="st">    </span>sigma.fup<span class="op">^</span><span class="dv">2</span><span class="op">/</span>fup<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb39-24" title="24"><span class="st">    </span>error.Rmatfet<span class="op">^</span><span class="dv">2</span><span class="op">/</span>Rmatfet<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb39-25" title="25">  Rbrain2matblood.upper &lt;-<span class="st"> </span>Rbrain2matblood <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-26" title="26"><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">10</span>)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>sigma.logKbrain<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb39-27" title="27"><span class="st">    </span>sigma.fup<span class="op">^</span><span class="dv">2</span><span class="op">/</span>fup<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb39-28" title="28"><span class="st">    </span>error.Rmatfet<span class="op">^</span><span class="dv">2</span><span class="op">/</span>Rmatfet<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb39-29" title="29">  pred.table5.nofup [pred.table5.nofup <span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb39-30" title="30"><span class="st">    </span><span class="kw">signif</span>(Rbrain2matblood.upper,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb39-31" title="31">  PC.table.nofup [PC.table.nofup <span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;sigma.logKbrain&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb39-32" title="32"><span class="st">    </span><span class="kw">signif</span>(sigma.logKbrain, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb39-33" title="33">  PC.table.nofup [PC.table.nofup <span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Kbrain2pu.upper&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb39-34" title="34"><span class="st">    </span><span class="kw">signif</span>(Kbrain2pu.upper, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb39-35" title="35">  PC.table.nofup [PC.table.nofup <span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;sigma.Rbrain2matblood&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb39-36" title="36"><span class="st">    </span><span class="kw">signif</span>(sigma.Rbrain2matblood, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb39-37" title="37">  PC.table.nofup [PC.table.nofup <span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;R.brain.FtoM.upper&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb39-38" title="38"><span class="st">    </span>pred.table5.nofup [pred.table5.nofup <span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>]</a>
<a class="sourceLine" id="cb39-39" title="39">}</a></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">case.study.fup.correct.table &lt;-<span class="st"> </span><span class="kw">merge</span>(PC.table,PC.table.nofup,<span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;CAS&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>))</a>
<a class="sourceLine" id="cb40-2" title="2"></a>
<a class="sourceLine" id="cb40-3" title="3">MFbrainfit.fup &lt;-<span class="st"> </span><span class="kw">lm</span>(R.brain.FtoM.upper.x<span class="op">~</span>R.brain.FtoM.upper.y,</a>
<a class="sourceLine" id="cb40-4" title="4">                     <span class="dt">data=</span>case.study.fup.correct.table)</a>
<a class="sourceLine" id="cb40-5" title="5"><span class="kw">summary</span>(MFbrainfit.fup)</a>
<a class="sourceLine" id="cb40-6" title="6"></a>
<a class="sourceLine" id="cb40-7" title="7"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;The predictions for fetal brain to maternal blood ratio with or without the fetal plasma binding correction (Eqn. 1) were strongly correlated (R2 = &quot;</span>,</a>
<a class="sourceLine" id="cb40-8" title="8">  <span class="kw">signif</span>(<span class="kw">summary</span>(MFbrainfit.fup)<span class="op">$</span>adj.r.square,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb40-9" title="9">  <span class="st">&quot;). There were &quot;</span>,</a>
<a class="sourceLine" id="cb40-10" title="10">  <span class="kw">dim</span>(<span class="kw">subset</span>(case.study.fup.correct.table, </a>
<a class="sourceLine" id="cb40-11" title="11">             <span class="kw">rank</span>(R.brain.FtoM.upper.x) <span class="op">&gt;</span><span class="st"> </span><span class="kw">rank</span>(R.brain.FtoM.upper.y)))[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb40-12" title="12">  <span class="st">&quot; chemicals that were ranked higher with the correction than without, with an average increase of &quot;</span>,</a>
<a class="sourceLine" id="cb40-13" title="13">  <span class="kw">signif</span>(<span class="kw">mean</span>(</a>
<a class="sourceLine" id="cb40-14" title="14">    case.study.fup.correct.table<span class="op">$</span>R.brain.FtoM.upper.y <span class="op">/</span></a>
<a class="sourceLine" id="cb40-15" title="15"><span class="st">      </span>case.study.fup.correct.table<span class="op">$</span>R.brain.FtoM.upper.x),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb40-16" title="16">  <span class="st">&quot; times when the plasma binding change was included.</span><span class="ch">\n</span><span class="st">&quot;</span>,</a>
<a class="sourceLine" id="cb40-17" title="17">  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
<p>The next two figures take a long time to generate and so are disabled by default.</p>
</div>
</div>
</div>
<div id="protein-binding-figures" class="section level1">
<h1>Protein Binding Figures</h1>
<p>The fetal fraction unbound (f_{up}^f i) is calculated from the maternal fraction unbound and the serum protein concentration ratio in infants vs. mothers based on Equation 6 of <a href="http://dx.doi.org/10.1208/ps040104">McNamara et al., 2019</a>,</p>
<p><span class="math display">\[
    f_{up}^f =(f_{up}^m )/(f_{up}^m +(P^f /P^m  )*(1-f_{up}^m  ) )
\]</span></p>
<p>in which the maternal fraction unbound, <span class="math inline">\(f_{up}^m\)</span>, is assumed to be equal to the in vitro measured value for fraction unbound in plasma, and the ratio of protein concentrations <span class="math inline">\(P^f /P^m\)</span> depends on the identity of the dominant binding protein for the chemical (assumed to be either albumin or AAG). Lacking data to model the gestational kinetics of albumin and AAG concentrations, we used the concentrations at birth ([McNamara et al., 2019] (<a href="http://dx.doi.org/10.1208/ps040104" class="uri">http://dx.doi.org/10.1208/ps040104</a>)) to calculate a constant fetal <span class="math inline">\(f_{up}\)</span>, using <span class="math inline">\(P^f/P^m =0.777\)</span> for albumin and <span class="math inline">\(P^f/P^m = 0.456\)</span> for AAG (<a href="http://dx.doi.org/10.1208/ps040104">McNamara et al., 2019</a>). We determine the charge state of a compound separately for maternal and fetal plasma as a function of plasma pH (7.38 for maternal and 7.28 for fetal ([K.H. Lee, 1972] (<a href="http://dx.doi.org/10.1136/pgmj.48.561.405" class="uri">http://dx.doi.org/10.1136/pgmj.48.561.405</a>)) and chemical-specific predictions for ionization affinity (that is, pKa ([Strope et al., 2018] (<a href="http://dx.doi.org/10.1016/j.scitotenv.2017.09.033" class="uri">http://dx.doi.org/10.1016/j.scitotenv.2017.09.033</a>)) using the “httk” function “calc_ionization” ([Pearce et al., 2017] (<a href="http://dx.doi.org/10.1007/s10928-017-9548-7" class="uri">http://dx.doi.org/10.1007/s10928-017-9548-7</a>)). If the fraction of a chemical that is predicted to be in positive ionic form is greater than 50%, we treat the chemical as a base (which is in its conjugate acid form) and use only the maternal-to-infant ratio of AAG concentrations. Otherwise, we assume the chemical is neutral or an acid and use the ratio of albumin concentrations.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">fup.table &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb41-2" title="2">all.chems &lt;-<span class="st"> </span><span class="kw">get_cheminfo</span>(</a>
<a class="sourceLine" id="cb41-3" title="3">  <span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</a>
<a class="sourceLine" id="cb41-4" title="4">  <span class="dt">info=</span><span class="st">&quot;all&quot;</span>,</a>
<a class="sourceLine" id="cb41-5" title="5">  <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb41-6" title="6"><span class="co"># Get rid of median fup 0:</span></a>
<a class="sourceLine" id="cb41-7" title="7">all.chems &lt;-<span class="st"> </span><span class="kw">subset</span>(all.chems,</a>
<a class="sourceLine" id="cb41-8" title="8">  <span class="kw">as.numeric</span>(<span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="kw">strsplit</span>(</a>
<a class="sourceLine" id="cb41-9" title="9">    all.chems<span class="op">$</span>Human.Funbound.plasma,<span class="st">&quot;,&quot;</span>),<span class="cf">function</span>(x) x[[<span class="dv">1</span>]])))<span class="op">!=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb41-10" title="10"><span class="cf">for</span> (this.chem <span class="cf">in</span> all.chems[,<span class="st">&quot;CAS&quot;</span>])</a>
<a class="sourceLine" id="cb41-11" title="11">{</a>
<a class="sourceLine" id="cb41-12" title="12">  temp &lt;-<span class="st"> </span><span class="kw">parameterize_fetal_pbtk</span>(<span class="dt">chem.cas=</span>this.chem,<span class="dt">suppress.messages =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb41-13" title="13">  state &lt;-<span class="st"> </span><span class="kw">calc_ionization</span>(</a>
<a class="sourceLine" id="cb41-14" title="14">      <span class="dt">pH=</span><span class="fl">7.26</span>,</a>
<a class="sourceLine" id="cb41-15" title="15">      <span class="dt">pKa_Donor=</span>temp<span class="op">$</span>pKa_Donor,</a>
<a class="sourceLine" id="cb41-16" title="16">      <span class="dt">pKa_Accept=</span>temp<span class="op">$</span>pKa_Accept)</a>
<a class="sourceLine" id="cb41-17" title="17">  <span class="cf">if</span> (state<span class="op">$</span>fraction_positive <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>) this.charge &lt;-<span class="st"> &quot;Positive&quot;</span></a>
<a class="sourceLine" id="cb41-18" title="18">  <span class="cf">else</span> <span class="cf">if</span> (state<span class="op">$</span>fraction_negative <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>) this.charge &lt;-<span class="st"> &quot;Negative&quot;</span></a>
<a class="sourceLine" id="cb41-19" title="19">  <span class="cf">else</span> this.charge &lt;-<span class="st"> &quot;Neutral&quot;</span></a>
<a class="sourceLine" id="cb41-20" title="20">  this.row &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">DTXSID=</span>all.chems[all.chems[,<span class="st">&quot;CAS&quot;</span>]<span class="op">==</span>this.chem,<span class="st">&quot;DTXSID&quot;</span>],</a>
<a class="sourceLine" id="cb41-21" title="21">    <span class="dt">Compound=</span>all.chems[all.chems[,<span class="st">&quot;CAS&quot;</span>]<span class="op">==</span>this.chem,<span class="st">&quot;Compound&quot;</span>],</a>
<a class="sourceLine" id="cb41-22" title="22">    <span class="dt">CAS=</span>this.chem,</a>
<a class="sourceLine" id="cb41-23" title="23">    <span class="dt">Fup.Mat.Pred =</span> temp<span class="op">$</span>Funbound.plasma,</a>
<a class="sourceLine" id="cb41-24" title="24">    <span class="dt">Fup.Neo.Pred =</span> temp<span class="op">$</span>Fraction_unbound_plasma_fetus,</a>
<a class="sourceLine" id="cb41-25" title="25">    <span class="dt">Charge =</span> this.charge</a>
<a class="sourceLine" id="cb41-26" title="26">    )</a>
<a class="sourceLine" id="cb41-27" title="27">  fup.table &lt;-<span class="st"> </span><span class="kw">rbind</span>(fup.table,this.row)</a>
<a class="sourceLine" id="cb41-28" title="28">}</a>
<a class="sourceLine" id="cb41-29" title="29"></a>
<a class="sourceLine" id="cb41-30" title="30">fup.table[fup.table<span class="op">$</span>Charge<span class="op">==</span><span class="st">&quot;Positive&quot;</span>,<span class="st">&quot;Charge&quot;</span>] &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Positive (n=&quot;</span>,</a>
<a class="sourceLine" id="cb41-31" title="31">  <span class="kw">sum</span>(fup.table<span class="op">$</span>Charge<span class="op">==</span><span class="st">&quot;Positive&quot;</span>),</a>
<a class="sourceLine" id="cb41-32" title="32">  <span class="st">&quot;)&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb41-33" title="33">fup.table[fup.table<span class="op">$</span>Charge<span class="op">==</span><span class="st">&quot;Negative&quot;</span>,<span class="st">&quot;Charge&quot;</span>] &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Negative (n=&quot;</span>,</a>
<a class="sourceLine" id="cb41-34" title="34">  <span class="kw">sum</span>(fup.table<span class="op">$</span>Charge<span class="op">==</span><span class="st">&quot;Negative&quot;</span>),</a>
<a class="sourceLine" id="cb41-35" title="35">  <span class="st">&quot;)&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb41-36" title="36">fup.table[fup.table<span class="op">$</span>Charge<span class="op">==</span><span class="st">&quot;Neutral&quot;</span>,<span class="st">&quot;Charge&quot;</span>] &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Neutral (n=&quot;</span>,</a>
<a class="sourceLine" id="cb41-37" title="37">  <span class="kw">sum</span>(fup.table<span class="op">$</span>Charge<span class="op">==</span><span class="st">&quot;Neutral&quot;</span>),</a>
<a class="sourceLine" id="cb41-38" title="38">  <span class="st">&quot;)&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a></code></pre></div>
<div id="plot-the-fetal-protein-binding-changes-predicted" class="section level2">
<h2>Plot the fetal protein binding changes predicted:</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">FigA  &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>fup.table) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.25</span>, <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb42-3" title="3">    <span class="dt">x=</span>Fup.Mat.Pred,</a>
<a class="sourceLine" id="cb42-4" title="4">    <span class="dt">y=</span>Fup.Neo.Pred,</a>
<a class="sourceLine" id="cb42-5" title="5">    <span class="dt">shape=</span>Charge,</a>
<a class="sourceLine" id="cb42-6" title="6">    <span class="dt">color=</span>Charge),</a>
<a class="sourceLine" id="cb42-7" title="7">    <span class="dt">size=</span><span class="dv">3</span>)   <span class="op">+</span></a>
<a class="sourceLine" id="cb42-8" title="8"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">0</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-9" title="9"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Adjusted Neonate &quot;</span>,f[up]))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-10" title="10"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="kw">italic</span>(<span class="st">&quot;In vitro&quot;</span>),<span class="st">&quot; Measured Adult &quot;</span>,f[up]))) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-11" title="11"><span class="st">   </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-12" title="12"><span class="st">   </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-13" title="13"><span class="st">  </span><span class="kw">theme_bw</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb42-14" title="14"><span class="st">  </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>)) </a>
<a class="sourceLine" id="cb42-15" title="15">    </a>
<a class="sourceLine" id="cb42-16" title="16"><span class="kw">print</span>(FigA) </a></code></pre></div>
</div>
<div id="maternal-fetal-predictions-across-httk-chemical-library" class="section level2">
<h2>Maternal-Fetal Predictions across HTTK Chemical Library:</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">times &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">13</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>, <span class="dv">40</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>, <span class="fl">0.25</span>),<span class="kw">seq</span>(<span class="dv">278</span>,<span class="dv">280</span>,.<span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb43-2" title="2">  </a>
<a class="sourceLine" id="cb43-3" title="3">MFratio.pred &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb43-4" title="4">all.chems &lt;-<span class="st"> </span><span class="kw">get_cheminfo</span>(</a>
<a class="sourceLine" id="cb43-5" title="5">  <span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>, </a>
<a class="sourceLine" id="cb43-6" title="6">  <span class="dt">info=</span><span class="kw">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;CAS&quot;</span>,<span class="st">&quot;Funbound.plasma&quot;</span>),</a>
<a class="sourceLine" id="cb43-7" title="7">  <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb43-8" title="8"><span class="cf">for</span> (this.cas <span class="cf">in</span> all.chems<span class="op">$</span>CAS)</a>
<a class="sourceLine" id="cb43-9" title="9">  <span class="cf">if</span> ((this.cas <span class="op">%in%</span><span class="st"> </span>nonvols) <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-10" title="10"><span class="st">    </span><span class="op">!</span>(this.cas <span class="op">%in%</span><span class="st"> </span>fluoros))</a>
<a class="sourceLine" id="cb43-11" title="11">{</a>
<a class="sourceLine" id="cb43-12" title="12">  this.id &lt;-<span class="st"> </span>all.chems[all.chems<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;DTXSID&quot;</span>]</a>
<a class="sourceLine" id="cb43-13" title="13">  Fup &lt;-<span class="st"> </span><span class="kw">subset</span>(all.chems,DTXSID<span class="op">==</span>this.id)<span class="op">$</span>Human.Funbound.plasma </a>
<a class="sourceLine" id="cb43-14" title="14">  <span class="cf">if</span> (<span class="kw">regexpr</span>(<span class="st">&quot;,&quot;</span>,Fup)<span class="op">!=-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb43-15" title="15">  {</a>
<a class="sourceLine" id="cb43-16" title="16">    <span class="cf">if</span> (<span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])<span class="op">==</span><span class="dv">0</span> <span class="op">|</span></a>
<a class="sourceLine" id="cb43-17" title="17"><span class="st">      </span>(<span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])<span class="op">&gt;</span><span class="fl">0.9</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-18" title="18"><span class="st">      </span><span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])<span class="op">&lt;</span><span class="fl">0.1</span>))</a>
<a class="sourceLine" id="cb43-19" title="19">    {</a>
<a class="sourceLine" id="cb43-20" title="20">      skip &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb43-21" title="21">    } <span class="cf">else</span> skip &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb43-22" title="22">  } <span class="cf">else</span> <span class="cf">if</span> (Fup<span class="op">==</span><span class="st"> </span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb43-23" title="23">  {</a>
<a class="sourceLine" id="cb43-24" title="24">    skip &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb43-25" title="25">  } <span class="cf">else</span> skip &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb43-26" title="26">  </a>
<a class="sourceLine" id="cb43-27" title="27">  <span class="cf">if</span> (<span class="op">!</span>skip)</a>
<a class="sourceLine" id="cb43-28" title="28">  {  </a>
<a class="sourceLine" id="cb43-29" title="29">    p &lt;-<span class="st"> </span><span class="kw">parameterize_fetal_pbtk</span>(<span class="dt">dtxsid=</span>this.id,</a>
<a class="sourceLine" id="cb43-30" title="30">    <span class="dt">fetal_fup_adjustment =</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb43-31" title="31">    <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb43-32" title="32">    out &lt;-<span class="st"> </span><span class="kw">solve_fetal_pbtk</span>(</a>
<a class="sourceLine" id="cb43-33" title="33">      <span class="dt">parameters=</span>p,</a>
<a class="sourceLine" id="cb43-34" title="34">      <span class="dt">dose=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb43-35" title="35">      <span class="dt">times=</span>times,</a>
<a class="sourceLine" id="cb43-36" title="36">      <span class="dt">daily.dose=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb43-37" title="37">      <span class="dt">doses.per.day=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb43-38" title="38">      <span class="dt">output.units =</span> <span class="st">&quot;uM&quot;</span>,</a>
<a class="sourceLine" id="cb43-39" title="39">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb43-40" title="40">    last.row &lt;-<span class="st"> </span><span class="kw">which</span>(out[,<span class="st">&quot;time&quot;</span>]<span class="op">&gt;</span><span class="dv">279</span>)</a>
<a class="sourceLine" id="cb43-41" title="41">    last.row &lt;-<span class="st"> </span>last.row[<span class="op">!</span><span class="kw">duplicated</span>(out[last.row,<span class="st">&quot;time&quot;</span>])]</a>
<a class="sourceLine" id="cb43-42" title="42">    new.row &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb43-43" title="43">      <span class="dt">Chemical =</span> all.chems[all.chems<span class="op">$</span>DTXSID<span class="op">==</span>this.id,<span class="st">&quot;Compound&quot;</span>],</a>
<a class="sourceLine" id="cb43-44" title="44">      <span class="dt">DTXSID =</span> this.id,</a>
<a class="sourceLine" id="cb43-45" title="45">      <span class="dt">Mat.pred =</span> <span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>]),</a>
<a class="sourceLine" id="cb43-46" title="46">      <span class="dt">Fet.pred =</span> <span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>]),</a>
<a class="sourceLine" id="cb43-47" title="47">      <span class="dt">MFratio.pred =</span> <span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>])<span class="op">/</span><span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])</a>
<a class="sourceLine" id="cb43-48" title="48">      )</a>
<a class="sourceLine" id="cb43-49" title="49">    MFratio.pred &lt;-<span class="st"> </span><span class="kw">rbind</span>(MFratio.pred,new.row)</a>
<a class="sourceLine" id="cb43-50" title="50">  }</a>
<a class="sourceLine" id="cb43-51" title="51">  }</a></code></pre></div>
</div>
<div id="histogram-of-maternal-fetal-ratio" class="section level2">
<h2>Histogram of maternal-fetal ratio</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">FigD &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>MFratio.pred)<span class="op">+</span></a>
<a class="sourceLine" id="cb44-2" title="2"><span class="st">   </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>,<span class="dt">fill=</span><span class="st">&quot;Red&quot;</span>,<span class="kw">aes</span>(MFratio.pred))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb44-3" title="3"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Maternal:Fetal Plasma Concentration Ratio&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-4" title="4"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb44-5" title="5"><span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb44-6" title="6"><span class="st">    </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))</a>
<a class="sourceLine" id="cb44-7" title="7">    </a>
<a class="sourceLine" id="cb44-8" title="8"></a>
<a class="sourceLine" id="cb44-9" title="9"><span class="kw">print</span>(FigD)</a></code></pre></div>
</div>
<div id="statistics-on-maternal-fetal-ratio-for-full-httk-library" class="section level2">
<h2>Statistics on maternal-fetal ratio for full HTTK library</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">max.chem &lt;-<span class="st"> </span>MFratio.pred[<span class="kw">which</span>(</a>
<a class="sourceLine" id="cb45-2" title="2">  MFratio.pred<span class="op">$</span>MFratio.pred<span class="op">==</span><span class="kw">max</span>(MFratio.pred<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)),]</a>
<a class="sourceLine" id="cb45-3" title="3">min.chem &lt;-<span class="st"> </span>MFratio.pred[<span class="kw">which</span>(</a>
<a class="sourceLine" id="cb45-4" title="4">  MFratio.pred<span class="op">$</span>MFratio.pred<span class="op">==</span><span class="kw">min</span>(MFratio.pred<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)),]</a>
<a class="sourceLine" id="cb45-5" title="5"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;In Figure X we examine the ratios predicted for the &quot;</span>,</a>
<a class="sourceLine" id="cb45-6" title="6">  <span class="kw">dim</span>(MFratio.pred)[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb45-7" title="7">  <span class="st">&quot; appropriate (non-volatile or PFAS) chemicals with measured HTTK data.</span><span class="ch">\n</span><span class="st">&quot;</span>,</a>
<a class="sourceLine" id="cb45-8" title="8">  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb45-9" title="9"></a>
<a class="sourceLine" id="cb45-10" title="10"></a>
<a class="sourceLine" id="cb45-11" title="11"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;We observe a median ratio of &quot;</span>,</a>
<a class="sourceLine" id="cb45-12" title="12">  <span class="kw">signif</span>(<span class="kw">median</span>(MFratio.pred<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb45-13" title="13">  <span class="st">&quot;, with values ranging from &quot;</span>,</a>
<a class="sourceLine" id="cb45-14" title="14">  <span class="kw">signif</span>(min.chem[,<span class="st">&quot;MFratio.pred&quot;</span>],<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb45-15" title="15">  <span class="st">&quot; for &quot;</span>,</a>
<a class="sourceLine" id="cb45-16" title="16">  min.chem[,<span class="st">&quot;DTXSID&quot;</span>],</a>
<a class="sourceLine" id="cb45-17" title="17">  <span class="st">&quot; to &quot;</span>,</a>
<a class="sourceLine" id="cb45-18" title="18">  <span class="kw">signif</span>(max.chem[,<span class="st">&quot;MFratio.pred&quot;</span>],<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb45-19" title="19">  <span class="st">&quot; for &quot;</span>,</a>
<a class="sourceLine" id="cb45-20" title="20">  max.chem[,<span class="st">&quot;DTXSID&quot;</span>],</a>
<a class="sourceLine" id="cb45-21" title="21">  <span class="st">&quot;.</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb45-22" title="22">  </a>
<a class="sourceLine" id="cb45-23" title="23"><span class="co"># Check out phys-chem &gt; 1.6, &lt; 1:</span></a>
<a class="sourceLine" id="cb45-24" title="24">highratio &lt;-<span class="st"> </span><span class="kw">subset</span>(chem.physical_and_invitro.data,DTXSID<span class="op">%in%</span><span class="kw">subset</span>(MFratio.pred,MFratio.pred<span class="op">&gt;</span><span class="fl">1.6</span>)<span class="op">$</span>DTXSID)</a>
<a class="sourceLine" id="cb45-25" title="25"></a>
<a class="sourceLine" id="cb45-26" title="26"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;There are&quot;</span>,</a>
<a class="sourceLine" id="cb45-27" title="27">  <span class="kw">dim</span>(highratio)[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb45-28" title="28">  <span class="st">&quot;chemicals with ratios greater than 1.6, indicating a tendency to have higher concentrations&quot;</span>))</a>
<a class="sourceLine" id="cb45-29" title="29"></a>
<a class="sourceLine" id="cb45-30" title="30"><span class="co"># all highly bound</span></a>
<a class="sourceLine" id="cb45-31" title="31">highratio<span class="op">$</span>Compound</a>
<a class="sourceLine" id="cb45-32" title="32"><span class="kw">suppressWarnings</span>(<span class="kw">apply</span>(highratio,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="kw">mean</span>(<span class="kw">as.numeric</span>(x),<span class="dt">na.rm=</span><span class="ot">TRUE</span>)))</a>
<a class="sourceLine" id="cb45-33" title="33"></a>
<a class="sourceLine" id="cb45-34" title="34"></a>
<a class="sourceLine" id="cb45-35" title="35">lowratio &lt;-<span class="st"> </span><span class="kw">subset</span>(chem.physical_and_invitro.data,DTXSID<span class="op">%in%</span><span class="kw">subset</span>(MFratio.pred,MFratio.pred<span class="op">&lt;</span><span class="fl">0.9</span>)<span class="op">$</span>DTXSID)</a>
<a class="sourceLine" id="cb45-36" title="36"><span class="co"># No obvious pattern</span></a></code></pre></div>
</div>
<div id="examine-maternal-fetal-ratio-predictions-without-fetaul-fup-correction" class="section level2">
<h2>Examine Maternal-Fetal ratio Predictions without fetaul Fup correction:</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">times &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">13</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>, <span class="dv">40</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>, <span class="fl">0.25</span>),<span class="kw">seq</span>(<span class="dv">278</span>,<span class="dv">280</span>,.<span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb46-2" title="2">  </a>
<a class="sourceLine" id="cb46-3" title="3">MFratio.pred.nofup &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb46-4" title="4">all.chems &lt;-<span class="st"> </span><span class="kw">get_cheminfo</span>(</a>
<a class="sourceLine" id="cb46-5" title="5">  <span class="dt">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>, </a>
<a class="sourceLine" id="cb46-6" title="6">  <span class="dt">info=</span><span class="kw">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;CAS&quot;</span>,<span class="st">&quot;Funbound.plasma&quot;</span>),</a>
<a class="sourceLine" id="cb46-7" title="7">  <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb46-8" title="8"><span class="cf">for</span> (this.cas <span class="cf">in</span> all.chems<span class="op">$</span>CAS)</a>
<a class="sourceLine" id="cb46-9" title="9">  <span class="cf">if</span> ((this.cas <span class="op">%in%</span><span class="st"> </span>nonvols) <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-10" title="10"><span class="st">    </span><span class="op">!</span>(this.cas <span class="op">%in%</span><span class="st"> </span>fluoros))</a>
<a class="sourceLine" id="cb46-11" title="11">{</a>
<a class="sourceLine" id="cb46-12" title="12">  this.id &lt;-<span class="st"> </span>all.chems[all.chems<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;DTXSID&quot;</span>]</a>
<a class="sourceLine" id="cb46-13" title="13">  Fup &lt;-<span class="st"> </span><span class="kw">subset</span>(all.chems,DTXSID<span class="op">==</span>this.id)<span class="op">$</span>Human.Funbound.plasma </a>
<a class="sourceLine" id="cb46-14" title="14">  <span class="cf">if</span> (<span class="kw">regexpr</span>(<span class="st">&quot;,&quot;</span>,Fup)<span class="op">!=-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb46-15" title="15">  {</a>
<a class="sourceLine" id="cb46-16" title="16">    <span class="cf">if</span> (<span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])<span class="op">==</span><span class="dv">0</span> <span class="op">|</span></a>
<a class="sourceLine" id="cb46-17" title="17"><span class="st">      </span>(<span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])<span class="op">&gt;</span><span class="fl">0.9</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-18" title="18"><span class="st">      </span><span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])<span class="op">&lt;</span><span class="fl">0.1</span>))</a>
<a class="sourceLine" id="cb46-19" title="19">    {</a>
<a class="sourceLine" id="cb46-20" title="20">      skip &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb46-21" title="21">    } <span class="cf">else</span> skip &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb46-22" title="22">  } <span class="cf">else</span> <span class="cf">if</span> (Fup<span class="op">==</span><span class="st"> </span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb46-23" title="23">  {</a>
<a class="sourceLine" id="cb46-24" title="24">    skip &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb46-25" title="25">  } <span class="cf">else</span> skip &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb46-26" title="26">  </a>
<a class="sourceLine" id="cb46-27" title="27">  <span class="cf">if</span> (<span class="op">!</span>skip)</a>
<a class="sourceLine" id="cb46-28" title="28">  {  </a>
<a class="sourceLine" id="cb46-29" title="29">    p &lt;-<span class="st"> </span><span class="kw">parameterize_fetal_pbtk</span>(<span class="dt">dtxsid=</span>this.id,</a>
<a class="sourceLine" id="cb46-30" title="30">    <span class="dt">fetal_fup_adjustment =</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb46-31" title="31">    <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)<span class="er">)</span></a>
<a class="sourceLine" id="cb46-32" title="32">    out &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">solve_fetal_pbtk</span>(</a>
<a class="sourceLine" id="cb46-33" title="33">      <span class="dt">parameters=</span>p,</a>
<a class="sourceLine" id="cb46-34" title="34">      <span class="dt">dose=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb46-35" title="35">      <span class="dt">times=</span>times,</a>
<a class="sourceLine" id="cb46-36" title="36">      <span class="dt">daily.dose=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb46-37" title="37">      <span class="dt">doses.per.day=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb46-38" title="38">      <span class="dt">output.units =</span> <span class="st">&quot;uM&quot;</span>,</a>
<a class="sourceLine" id="cb46-39" title="39">      <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb46-40" title="40">    last.row &lt;-<span class="st"> </span><span class="kw">which</span>(out[,<span class="st">&quot;time&quot;</span>]<span class="op">&gt;</span><span class="dv">279</span>)</a>
<a class="sourceLine" id="cb46-41" title="41">    last.row &lt;-<span class="st"> </span>last.row[<span class="op">!</span><span class="kw">duplicated</span>(out[last.row,<span class="st">&quot;time&quot;</span>])]</a>
<a class="sourceLine" id="cb46-42" title="42">    new.row &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb46-43" title="43">      <span class="dt">Chemical =</span> all.chems[all.chems<span class="op">$</span>DTXSID<span class="op">==</span>this.id,<span class="st">&quot;Compound&quot;</span>],</a>
<a class="sourceLine" id="cb46-44" title="44">      <span class="dt">DTXSID =</span> this.id,</a>
<a class="sourceLine" id="cb46-45" title="45">      <span class="dt">Mat.pred =</span> <span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>]),</a>
<a class="sourceLine" id="cb46-46" title="46">      <span class="dt">Fet.pred =</span> <span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>]),</a>
<a class="sourceLine" id="cb46-47" title="47">      <span class="dt">MFratio.pred =</span> <span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>])<span class="op">/</span><span class="kw">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])</a>
<a class="sourceLine" id="cb46-48" title="48">      )</a>
<a class="sourceLine" id="cb46-49" title="49">    MFratio.pred.nofup &lt;-<span class="st"> </span><span class="kw">rbind</span>(MFratio.pred.nofup,new.row)</a>
<a class="sourceLine" id="cb46-50" title="50">  <span class="er">}</span></a>
<a class="sourceLine" id="cb46-51" title="51">  <span class="er">}</span></a></code></pre></div>
</div>
<div id="supplemental-histogram-of-maternal-fetal-ratio-without-fup-correction" class="section level2">
<h2>Supplemental Histogram of maternal-fetal ratio without Fup correction</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">FigSupD &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>MFratio.pred.nofup)<span class="op">+</span></a>
<a class="sourceLine" id="cb47-2" title="2"><span class="st">   </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>,<span class="dt">fill=</span><span class="st">&quot;Red&quot;</span>,<span class="kw">aes</span>(MFratio.pred))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Maternal:Fetal Plasma Concentration Ratio (No Fup Corr.)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb47-5" title="5"><span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb47-6" title="6"><span class="st">    </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))</a>
<a class="sourceLine" id="cb47-7" title="7">    </a>
<a class="sourceLine" id="cb47-8" title="8"></a>
<a class="sourceLine" id="cb47-9" title="9"><span class="kw">print</span>(FigSupD)</a></code></pre></div>
</div>
<div id="statistics-on-maternal-fetal-ratio-for-full-httk-library-without-fup-correction" class="section level2">
<h2>Statistics on maternal-fetal ratio for full HTTK library without Fup correction</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">max.chem &lt;-<span class="st"> </span>MFratio.pred.nofup[<span class="kw">which</span>(</a>
<a class="sourceLine" id="cb48-2" title="2">  MFratio.pred.nofup<span class="op">$</span>MFratio.pred<span class="op">==</span><span class="kw">max</span>(MFratio.pred.nofup<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)),]</a>
<a class="sourceLine" id="cb48-3" title="3">min.chem &lt;-<span class="st"> </span>MFratio.pred.nofup[<span class="kw">which</span>(</a>
<a class="sourceLine" id="cb48-4" title="4">  MFratio.pred.nofup<span class="op">$</span>MFratio.pred<span class="op">==</span><span class="kw">min</span>(MFratio.pred.nofup<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)),]</a>
<a class="sourceLine" id="cb48-5" title="5"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;In Figure X we examine the ratios predicted for the &quot;</span>,</a>
<a class="sourceLine" id="cb48-6" title="6">  <span class="kw">dim</span>(MFratio.pred)[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb48-7" title="7">  <span class="st">&quot; appropriate (non-volatile or PFAS) chemicals with measured HTTK data.</span><span class="ch">\n</span><span class="st">&quot;</span>,</a>
<a class="sourceLine" id="cb48-8" title="8">  <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb48-9" title="9"></a>
<a class="sourceLine" id="cb48-10" title="10"></a>
<a class="sourceLine" id="cb48-11" title="11"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;We observe a median ratio of &quot;</span>,</a>
<a class="sourceLine" id="cb48-12" title="12">  <span class="kw">signif</span>(<span class="kw">median</span>(MFratio.pred.nofup<span class="op">$</span>MFratio.pred,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb48-13" title="13">  <span class="st">&quot;, with values ranging from &quot;</span>,</a>
<a class="sourceLine" id="cb48-14" title="14">  <span class="kw">signif</span>(min.chem[,<span class="st">&quot;MFratio.pred&quot;</span>],<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb48-15" title="15">  <span class="st">&quot; for &quot;</span>,</a>
<a class="sourceLine" id="cb48-16" title="16">  min.chem[,<span class="st">&quot;DTXSID&quot;</span>],</a>
<a class="sourceLine" id="cb48-17" title="17">  <span class="st">&quot; to &quot;</span>,</a>
<a class="sourceLine" id="cb48-18" title="18">  <span class="kw">signif</span>(max.chem[,<span class="st">&quot;MFratio.pred&quot;</span>],<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb48-19" title="19">  <span class="st">&quot; for &quot;</span>,</a>
<a class="sourceLine" id="cb48-20" title="20">  max.chem[,<span class="st">&quot;DTXSID&quot;</span>],</a>
<a class="sourceLine" id="cb48-21" title="21">  <span class="st">&quot;.</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb48-22" title="22">  </a>
<a class="sourceLine" id="cb48-23" title="23"><span class="co"># Check out phys-chem &gt; 1.6, &lt; 1:</span></a>
<a class="sourceLine" id="cb48-24" title="24">highratio &lt;-<span class="st"> </span><span class="kw">subset</span>(chem.physical_and_invitro.data,DTXSID<span class="op">%in%</span><span class="kw">subset</span>(MFratio.pred.nofup,MFratio.pred<span class="op">&gt;</span><span class="fl">1.6</span>)<span class="op">$</span>DTXSID)</a>
<a class="sourceLine" id="cb48-25" title="25"></a>
<a class="sourceLine" id="cb48-26" title="26"><span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;There are&quot;</span>,</a>
<a class="sourceLine" id="cb48-27" title="27">  <span class="kw">dim</span>(highratio)[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb48-28" title="28">  <span class="st">&quot;chemicals with ratios greater than 1.6, indicating a tendency to have higher concentrations&quot;</span>))</a>
<a class="sourceLine" id="cb48-29" title="29"></a>
<a class="sourceLine" id="cb48-30" title="30"><span class="co"># all highly bound</span></a>
<a class="sourceLine" id="cb48-31" title="31">highratio<span class="op">$</span>Compound</a>
<a class="sourceLine" id="cb48-32" title="32"><span class="kw">suppressWarnings</span>(<span class="kw">apply</span>(highratio,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="kw">mean</span>(<span class="kw">as.numeric</span>(x),<span class="dt">na.rm=</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb48-33" title="33"></a>
<a class="sourceLine" id="cb48-34" title="34"></a>
<a class="sourceLine" id="cb48-35" title="35">lowratio &lt;-<span class="st"> </span><span class="kw">subset</span>(chem.physical_and_invitro.data,DTXSID<span class="op">%in%</span><span class="kw">subset</span>(MFratio.pred.nofup,MFratio.pred<span class="op">&lt;</span><span class="fl">0.9</span>)<span class="op">$</span>DTXSID)</a>
<a class="sourceLine" id="cb48-36" title="36"><span class="co"># No obvious pattern</span></a></code></pre></div>
</div>
</div>
<div id="code-used-to-create-data-distributed-with-vignette" class="section level1">
<h1>Code used to create data distributed with vignette</h1>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">aylward2014 &lt;-MFdata</a>
<a class="sourceLine" id="cb49-2" title="2">pregnonpregaucs &lt;-<span class="st"> </span>TKstats</a>
<a class="sourceLine" id="cb49-3" title="3">fetalpcs &lt;-<span class="st"> </span>Curley.pcs</a>
<a class="sourceLine" id="cb49-4" title="4">wang2018 &lt;-<span class="st"> </span>Wangchems</a>
<a class="sourceLine" id="cb49-5" title="5"></a>
<a class="sourceLine" id="cb49-6" title="6"><span class="kw">save</span>(aylward2014,pregnonpregaucs,fetalpcs,wang2018,pksim.pcs,</a>
<a class="sourceLine" id="cb49-7" title="7">     <span class="dt">file=</span><span class="st">&quot;Kapraun2022Vignette.RData&quot;</span>,<span class="dt">version=</span><span class="dv">2</span>)</a></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
