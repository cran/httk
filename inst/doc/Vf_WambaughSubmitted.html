<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="John F. Wambaugh" />

<meta name="date" content="2025-07-23" />

<title>Wambaugh (Submitted): HTTK for PFAS</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Wambaugh (Submitted): HTTK for PFAS</h1>
<h4 class="author">John F. Wambaugh</h4>
<h4 class="date">2025-07-23</h4>



<p><em>Please send questions to <a href="mailto:wambaugh.john@epa.gov" class="email">wambaugh.john@epa.gov</a></em></p>
<p>from “Applying High Throughput Toxicokinetics (HTTK) to Per- and
Polyfluoro Alkyl Substances (PFAS)”</p>
<p>John F. Wambaugh, Rogelio Tornero-Velez, Rachael Cogbill, Michael
Devito, and Barbara Wetmore</p>
<div id="abstract" class="section level2">
<h2>Abstract</h2>
<p>Interspecies toxicokinetic (TK) scaling factors are needed to relate
toxicological data generated in model animal species to humans. Per- and
polyfluoroalkyl substances (PFAS) are a large and diverse class of
organic chemicals with a carbon-fluorine backbone. Some PFAS exhibit
long TK half-lives (up to several years) in humans yet comparatively
short TK half-lives in laboratory animal models. At present, there are
roughly a dozen PFAS with credible estimates of human half-lives.
Typical allometric extrapolation methods have proven to be unreliable
for PFAS in comparisons across both species and chemicals. Interspecies
variation in expression level and affinity of transporters for some PFAS
are suspected to complicate interspecies extrapolation. Higher
throughput TK (HTTK) approaches use in vitro measures of toxicokinetics
(intrinsic hepatocyte clearance - Clint - and fraction unbound in plasma
- fup) for in vitro-in vivo extrapolation (IVIVE) and interspecies
extrapolation. For typical organic chemicals, HTTK in vitro data
combined with species-specific physiological parameters predicts the
Rat:Human clearance ratio with a root mean squared log10 error (RMSLE)
of 0.7. HTTK tools do not assess transporters and often rely on
octanol:water chemical concentration ratios. PFAS, however, have both
hydrophobic and lipophobic properties, making them unsuitable for many
typical TK methods. To address TK issues specific to PFAS, we
incorporated machine learning model predictions to approximate the
influence of active transporters on PFAS renal clearance (potentially
through resorption and secretion). With this and other modifications,
HTTK methods for PFAS achieve improved prediction of interspecies
clearance ratios, with an RMSLE of 0.83.</p>
</div>
<div id="httk-version" class="section level2">
<h2>HTTK Version</h2>
<p>This vignette was created with <strong>httk</strong> v2.3.0. Although
we attempt to maintain backward compatibility, if you encounter issues
with the latest release of <strong>httk</strong> and cannot easily
address the changes, historical versions of httk are available from: <a href="https://cran.r-project.org/src/contrib/Archive/httk/" class="uri">https://cran.r-project.org/src/contrib/Archive/httk/</a></p>
<p>## Prepare for session</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">collapse =</span> <span class="cn">TRUE</span>, <span class="at">comment =</span> <span class="st">&#39;#&gt;&#39;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">rmarkdown.html_vignette.check_title =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="session-preparation" class="section level2">
<h2>Session Preparation</h2>
<div id="clear-the-memory" class="section level3">
<h3>Clear the memory</h3>
<p>It is a bad idea to let variables and other information from previous
R sessions float around, so we first remove everything in the R
memory.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) </span></code></pre></div>
</div>
<div id="eval-execute.vignette" class="section level3">
<h3>eval = execute.vignette</h3>
<p>If you are using the RMarkdown version of this vignette (extension,
.RMD) you will be able to see that several chunks of code in this
vignette have the statement “eval = execute.vignette”. The next chunk of
code, by default, sets execute.vignette = FALSE. This means that the
code is included (and necessary) but was not run when the vignette was
built. We do this because some steps require extensive computing time
and the checks on CRAN limit how long we can spend building the package.
If you want this vignette to work, you must run all code, either by
cutting and pasting it into R. Or, if viewing the .RMD file, you can
either change execute.vignette to TRUE or press “play” (the green arrow)
on each chunk in RStudio.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set whether or not the following chunks will be executed (run):</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>execute.vignette <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span></code></pre></div>
</div>
<div id="load-the-relevant-libraries" class="section level3">
<h3>Load the relevant libraries</h3>
<p>If you get the message “Error in library(X) : there is no package
called ‘X’” then you will need to install that package:</p>
<p>From the R command prompt:</p>
<p>install.packages(“X”)</p>
<p>Or, if using RStudio, look for ‘Install Packages’ under ‘Tools’
tab.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httk)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>LOC.WD <span class="ot">&lt;-</span> <span class="st">&quot;c:/users/jwambaug/git/httk-dev/work/HTTKPFAS/&quot;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>PFAS.MODEL.USED <span class="ot">&lt;-</span> <span class="st">&quot;sumclearancespfas&quot;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>NONPFAS.MODEL.USED <span class="ot">&lt;-</span> <span class="st">&quot;sumclearances&quot;</span></span></code></pre></div>
<p>Set the sizes of the labels and points in the figure (these settings
impact the PNG differently than the figure within RStudio):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>FONT.SIZE <span class="ot">&lt;-</span> <span class="dv">24</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>POINT.SIZE <span class="ot">&lt;-</span> <span class="dv">4</span></span></code></pre></div>
</div>
<div id="function-to-format-scientific-notation" class="section level3">
<h3>Function to format scientific notation</h3>
<p>From <a href="https://stackoverflow.com/questions/10762287/how-can-i-format-axis-labels-with-exponents-with-ggplot2-and-scales" class="uri">https://stackoverflow.com/questions/10762287/how-can-i-format-axis-labels-with-exponents-with-ggplot2-and-scales</a></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>scientific_10 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {                                  </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;1e&quot;</span>, <span class="st">&quot;10^&quot;</span>, <span class="fu">scientific_format</span>()(x))              </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">+&quot;</span>,<span class="st">&quot;&quot;</span>,out)                                     </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^01&quot;</span>,<span class="st">&quot;10&quot;</span>,out)                               </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">parse</span>(<span class="at">text=</span><span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^00&quot;</span>,<span class="st">&quot;1&quot;</span>,out))                    </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>}  </span></code></pre></div>
</div>
<div id="function-to-calculate-root-mean-squared-log10-error" class="section level3">
<h3>Function to calculate root mean squared log10 error</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>RMSLE <span class="ot">&lt;-</span> <span class="cf">function</span>(tab,colx,coly) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">signif</span>(<span class="fu">mean</span>(<span class="fu">log10</span>(tab[,colx]<span class="sc">/</span>tab[,coly])<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),<span class="dv">3</span>))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="analysis-of-crizer-et-al.-2023-cl_int-data" class="section level1">
<h1>Analysis of Crizer et al. (2023) <span class="math inline">\(Cl_{int}\)</span> data</h1>
<div id="methods" class="section level2">
<h2>Methods</h2>
<div id="evaluate-ratio-bloodplasma-predictions" class="section level3">
<h3>Evaluate Ratio Blood:Plasma Predictions</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>rb2p.table <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                     Human.Rblood2plasma.Reference <span class="sc">%in%</span> <span class="st">&quot;Poothong 2017&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>rb2p.table <span class="ot">&lt;-</span> rb2p.table[,<span class="fu">colnames</span>(rb2p.table) <span class="sc">%in%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">&quot;Human.Rblood2plasma&quot;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                                     )]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> rb2p.table<span class="sc">$</span>DTXSID)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (this.chem <span class="sc">%in%</span> <span class="fu">get_2023pfasinfo</span>(<span class="at">info=</span><span class="st">&quot;dtxsid&quot;</span>, <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">model=</span>PFAS.MODEL.USED))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    rb2p.table[rb2p.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chem,<span class="st">&quot;HTTK.Rb2p&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">calc_rblood2plasma</span>(<span class="at">dtxsid=</span>this.chem,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">class.exclude=</span><span class="cn">FALSE</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">parameterize_pfas1comp</span>(<span class="at">dtxsid=</span>this.chem))</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is</span>(p, <span class="st">&quot;try-error&quot;</span>)) </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    rb2p.table[rb2p.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chem,<span class="st">&quot;ML.Rb2p&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    p<span class="sc">$</span>Rblood2plasma</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(rb2p.table)</span></code></pre></div>
</div>
<div id="evaluate-membrane-affinity-predictions" class="section level3">
<h3>Evaluate Membrane Affinity Predictions</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>logma.table <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                     logMA.Reference <span class="sc">%in%</span> <span class="st">&quot;Droge 2019&quot;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>logma.table <span class="ot">&lt;-</span> logma.table[,<span class="fu">colnames</span>(logma.table) <span class="sc">%in%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">&quot;logMA&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                                     )]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> logma.table<span class="sc">$</span>DTXSID)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  logma.table[logma.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chem,<span class="st">&quot;HTTK.logMA&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">signif</span>(<span class="fu">log10</span>(<span class="fu">calc_ma</span>(<span class="at">dtxsid=</span>this.chem,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pfas.calibration=</span><span class="cn">FALSE</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)),<span class="dv">3</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(logma.table)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fit.logma <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMA<span class="sc">~</span>HTTK.logMA,<span class="at">data=</span>logma.table)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.logma)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>logma.table<span class="sc">$</span>Fit.logMA <span class="ot">&lt;-</span> <span class="fu">signif</span>(fit.logma<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  fit.logma<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>logma.table<span class="sc">$</span>HTTK.logMA,<span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fig.logma  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>logma.table) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>HTTK.logMA,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>logMA</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>POINT.SIZE) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>HTTK.logMA,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>Fit.logMA), <span class="at">color=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Droge (2019) logMA&quot;</span>) <span class="sc">+</span> </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;HTTK log Membrane Affinity&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.logma)</span></code></pre></div>
</div>
</div>
<div id="new-in-vitro-tk-parameters" class="section level2">
<h2>New In Vitro TK Parameters</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>new.pfas <span class="ot">&lt;-</span> <span class="fu">get_2023pfasinfo</span>(<span class="at">info=</span><span class="st">&quot;dtxsid&quot;</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">model=</span>PFAS.MODEL.USED,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># What chems does sumclearances model work for overall?</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>good.chems <span class="ot">&lt;-</span> <span class="fu">get_cheminfo</span>(<span class="at">info=</span><span class="st">&quot;dtxsid&quot;</span>, <span class="at">model =</span> PFAS.MODEL.USED)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;were incorporated from the scientific literature into R package </span><span class="sc">\\</span><span class="st">“httk</span><span class="sc">\\</span><span class="st">” for&quot;</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sum</span>(new.pfas <span class="sc">%in%</span> good.chems),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;PFAS</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;Out of&quot;</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">length</span>(new.pfas),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;PFAS with new in vitro TK data reported,&quot;</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sum</span>(new.pfas <span class="sc">%in%</span> good.chems),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;had the Clint, fup, and physicochemical&quot;</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;property predictions needed to make HTTK predictions.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>clint.fup <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>                    <span class="sc">!</span><span class="fu">is.na</span>(Human.Funbound.plasma) <span class="sc">&amp;</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>                    <span class="sc">!</span><span class="fu">is.na</span>(Human.Clint) <span class="sc">&amp;</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>                    (<span class="fu">regexpr</span>(<span class="st">&quot;PFAS&quot;</span>,Chemical.Class)<span class="sc">==-</span><span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>                    DTXSID <span class="sc">%in%</span> new.pfas))</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>clint.fup<span class="sc">$</span>Human.Clint <span class="ot">&lt;-</span> <span class="fu">sapply</span>(clint.fup<span class="sc">$</span>Human.Clint, </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(x,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]))</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>clint.fup<span class="sc">$</span>Human.Funbound.plasma <span class="ot">&lt;-</span> <span class="fu">sapply</span>(clint.fup<span class="sc">$</span>Human.Funbound.plasma, </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(x,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]))</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>clint.fup[clint.fup<span class="sc">$</span>Chemical.Class<span class="sc">==</span><span class="st">&quot;&quot;</span>,<span class="st">&quot;Chemical.Class&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Non-PFAS&quot;</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>clint.fup[clint.fup<span class="sc">$</span>Chemical.Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>,<span class="st">&quot;Chemical.Class&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Newly Measured PFAS&quot;</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>clint.fup.pfas <span class="ot">&lt;-</span> <span class="fu">subset</span>(clint.fup,Chemical.Class<span class="sc">!=</span><span class="st">&quot;Non-PFAS&quot;</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>clint.fup.pfas <span class="ot">&lt;-</span> <span class="fu">merge</span>(clint.fup.pfas,<span class="fu">subset</span>(httk<span class="sc">::</span>dawson2023,Species<span class="sc">==</span><span class="st">&quot;Human&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>                              Sex<span class="sc">==</span><span class="st">&quot;Female&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>                              DosingAdj<span class="sc">==</span><span class="st">&quot;Oral&quot;</span>)[,<span class="fu">c</span>(<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;ClassPredFull&quot;</span>)],</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">by=</span><span class="st">&quot;DTXSID&quot;</span>,<span class="at">all.x=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(clint.fup.pfas)[<span class="fu">colnames</span>(clint.fup.pfas)<span class="sc">==</span><span class="st">&quot;ClassPredFull&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;ML.Class&quot;</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(clint.fup, </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>     clint.fup.pfas,</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">file=</span><span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Clint-Fup-Values.RData&quot;</span>))</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(clint.fup.pfas,</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">quote=</span><span class="cn">FALSE</span>,</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">row.names=</span><span class="cn">FALSE</span>,</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">file=</span><span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;PFAS-Clint_Fup.txt&quot;</span>))</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;(fraction unbound in plasma) in&quot;</span>,</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(clint.fup.pfas<span class="sc">$</span>Human.Funbound.plasma)),</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;PFAS</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;(intrinsic hepatocyte clearance) in&quot;</span>,</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(clint.fup.pfas<span class="sc">$</span>Human.Clint)),</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;PFAS</span><span class="sc">\n</span><span class="st">&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Clint-Fup-Values.RData&quot;</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fig.clint.fup  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>clint.fup) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Human.Funbound.plasma,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>Human.Clint,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour=</span>Chemical.Class,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Chemical.Class),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>POINT.SIZE) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;In Vitro&quot;</span>)<span class="sc">~</span><span class="st">&quot;Measured Cl&quot;</span>[int]<span class="sc">~</span><span class="st">&quot;(&quot;</span><span class="sc">*</span>mu<span class="sc">*</span><span class="st">&quot;L/min/10&quot;</span><span class="sc">^</span><span class="st">&#39;6&#39;</span><span class="sc">~</span><span class="st">&quot;hep.)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;In Vitro&quot;</span>)<span class="sc">~</span><span class="st">&quot;Measured f&quot;</span>[up])) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE)) <span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">2</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.clint.fup)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>fig.fup.hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>clint.fup) <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Human.Funbound.plasma,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour=</span>Chemical.Class,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>Chemical.Class)) <span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;In Vitro&quot;</span>)<span class="sc">~</span><span class="st">&quot;Measured f&quot;</span>[up])) <span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))<span class="sc">+</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_viridis</span>(<span class="at">discrete=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">2</span>)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.fup.hist)</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>fig.clint.hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>clint.fup) <span class="sc">+</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Human.Clint<span class="sc">+</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">5</span>,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour=</span>Chemical.Class,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>Chemical.Class)) <span class="sc">+</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;In Vitro&quot;</span>)<span class="sc">~</span><span class="st">&quot;Measured Cl&quot;</span>[int]<span class="sc">~</span><span class="st">&quot;(&quot;</span><span class="sc">*</span>mu<span class="sc">*</span><span class="st">&quot;L/min/10&quot;</span><span class="sc">^</span><span class="st">&#39;6&#39;</span><span class="sc">~</span><span class="st">&quot;hep.)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))<span class="sc">+</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_viridis</span>(<span class="at">discrete=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.clint.hist)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>fig.henry.hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>clint.fup) <span class="sc">+</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="dv">10</span><span class="sc">^</span>logHenry,</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour=</span>Chemical.Class,</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>Chemical.Class)) <span class="sc">+</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="st">&quot;Henry&#39;s Law Constant (Atm.-m&quot;</span><span class="sc">^</span><span class="st">&quot;3&quot;</span><span class="sc">*</span><span class="st">&quot;/mole)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span><span class="dv">10</span><span class="sc">^-</span><span class="fl">4.5</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))<span class="sc">+</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_viridis</span>(<span class="at">discrete=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">2</span>)</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.henry.hist)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(fig.clint.fup, fig.clint.hist, fig.fup.hist, fig.henry.hist, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tiff</span>(<span class="at">file =</span> <span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Fig_NewClintFup.tiff&quot;</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> <span class="dv">5</span><span class="sc">*</span><span class="dv">200</span>, <span class="at">width =</span> <span class="dv">5</span><span class="sc">*</span><span class="dv">200</span>, <span class="at">compression =</span> <span class="st">&quot;lzw&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(fig.clint.fup, fig.clint.hist, fig.fup.hist, fig.henry.hist, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="examine-kbloodair" class="section level2">
<h2>Examine Kbloodair</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pfas.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(clint.fup,Chemical.Class<span class="sc">==</span><span class="st">&quot;Newly Measured PFAS&quot;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>pfas.data[,<span class="st">&quot;logKblood2air&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(pfas.data,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="dv">1</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="cf">function</span>(x) <span class="fu">try</span>(<span class="fu">log10</span>(<span class="fu">calc_kair</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">dtxsid=</span>x[<span class="st">&quot;DTXSID&quot;</span>],</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)<span class="sc">$</span>Kblood2air)))</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>good.Kblood2air <span class="ot">&lt;-</span> pfas.data<span class="sc">$</span>logKblood2air</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>good.logHenry <span class="ot">&lt;-</span> pfas.data<span class="sc">$</span>logHenry</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>good.logHenry <span class="ot">&lt;-</span> good.logHenry[<span class="sc">!</span><span class="fu">is.na</span>(good.Kblood2air)]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>good.Kblood2air <span class="ot">&lt;-</span> good.Kblood2air[<span class="sc">!</span><span class="fu">is.na</span>(good.Kblood2air)]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;Out of &quot;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">length</span>(good.logHenry),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot; PFAS for which the Henry&#39;s Law Constant could be predicted, &quot;</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">signif</span>(<span class="fu">sum</span>(good.logHenry <span class="sc">&gt;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">-</span><span class="fl">4.5</span>)<span class="sc">/</span><span class="fu">length</span>(good.logHenry)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>),</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;% were more volatile than acetone.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>most.volatile <span class="ot">&lt;-</span> pfas.data[pfas.data<span class="sc">$</span>logKblood2air <span class="sc">%in%</span> <span class="fu">min</span>(good.Kblood2air), </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Compound&quot;</span>]</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;The most volatile chemical was &quot;</span>, most.volatile,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot; with a predicted logKblood2air of &quot;</span>, <span class="fu">signif</span>(<span class="fu">min</span>(good.Kblood2air),<span class="dv">3</span>),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="httk-interspecies-clearance-differences" class="section level1">
<h1>HTTK Interspecies Clearance Differences</h1>
<div id="remove-rat-specific-httk-data" class="section level2">
<h2>Remove Rat-specific HTTK data:</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>chem.physical_and_invitro.data<span class="sc">$</span>Rat.Clint <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>chem.physical_and_invitro.data<span class="sc">$</span>Rat.Funbound.plasma <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
</div>
<div id="add-bioavailability-predictions" class="section level2">
<h2>Add bioavailability predictions</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load_honda2023</span>()</span></code></pre></div>
</div>
<div id="compare-default-httk-against-in-vivo-clearance-data" class="section level2">
<h2>Compare default httk against in vivo clearance data:</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>cl.table <span class="ot">&lt;-</span> httk<span class="sc">::</span>pfas.clearance</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>human.ML.table <span class="ot">&lt;-</span> <span class="fu">subset</span>(httk<span class="sc">::</span>dawson2023,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                         Species<span class="sc">==</span><span class="st">&quot;Human&quot;</span> <span class="sc">&amp;</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                         Sex<span class="sc">==</span><span class="st">&quot;Female&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                         DosingAdj<span class="sc">==</span><span class="st">&quot;Oral&quot;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">unique</span>(cl.table<span class="sc">$</span>DTXSID))</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (this.chem <span class="sc">%in%</span> <span class="fu">get_2023pfasinfo</span>(<span class="at">info=</span><span class="st">&quot;dtxsid&quot;</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">model=</span>PFAS.MODEL.USED,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    chem.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(cl.table, DTXSID<span class="sc">==</span>this.chem)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (this.species <span class="cf">in</span> <span class="fu">unique</span>(cl.table<span class="sc">$</span>Species))</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>      httk.normal <span class="ot">&lt;-</span> <span class="fu">calc_total_clearance</span>(<span class="at">dtxsid=</span>this.chem,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">species=</span>this.species,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">model=</span>NONPFAS.MODEL.USED,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">default.to.human=</span><span class="cn">TRUE</span>,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">class.exclude=</span><span class="cn">FALSE</span>,</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">physchem.exclude=</span><span class="cn">FALSE</span>,</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>                               <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>      httk.pfas <span class="ot">&lt;-</span> <span class="fu">calc_total_clearance</span>(<span class="at">dtxsid=</span>this.chem,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>                               <span class="at">species=</span>this.species,</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>                               <span class="at">model=</span>PFAS.MODEL.USED,</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>                               <span class="at">default.to.human=</span><span class="cn">TRUE</span>,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>                               <span class="at">class.exclude=</span><span class="cn">FALSE</span>,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>                               <span class="at">physchem.exclude=</span><span class="cn">FALSE</span>,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>                               <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">any</span>(cl.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chem <span class="sc">&amp;</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>               cl.table<span class="sc">$</span>Species<span class="sc">==</span>this.species))</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>        cl.table[cl.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chem <span class="sc">&amp;</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>               cl.table<span class="sc">$</span>Species<span class="sc">==</span>this.species,</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;HTTK.Cltot.Lphpkgbw&quot;</span>] <span class="ot">&lt;-</span> httk.normal</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>        cl.table[cl.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chem <span class="sc">&amp;</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>               cl.table<span class="sc">$</span>Species<span class="sc">==</span>this.species,</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;HTTKPFAS.Cltot.Lphpkgbw&quot;</span>] <span class="ot">&lt;-</span> httk.pfas</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>        new.row <span class="ot">&lt;-</span> cl.table[<span class="dv">1</span>,]</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>        new.row[] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>        new.row[,<span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> this.chem</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>        new.row[,<span class="st">&quot;Species&quot;</span>] <span class="ot">&lt;-</span> this.species</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>        new.row[,<span class="st">&quot;Sex&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Female&quot;</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>        new.row[,<span class="st">&quot;HTTK.Cltot.Lphpkgbw&quot;</span>] <span class="ot">&lt;-</span> httk.normal</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>        new.row[,<span class="st">&quot;HTTKPFAS.Cltot.Lphpkgbw&quot;</span>] <span class="ot">&lt;-</span> httk.pfas</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>        cl.table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cl.table,new.row)</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>        new.row[,<span class="st">&quot;Sex&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Male&quot;</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>        cl.table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cl.table,new.row)</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="fu">dim</span>(cl.table)[<span class="dv">1</span>],<span class="st">&quot; rows of in vivo clearance data.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span></code></pre></div>
</div>
<div id="add-in-dawson-2023-predictions-for-later" class="section level2">
<h2>Add in Dawson 2023 predictions for later</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>outside.doa <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">unique</span>(cl.table<span class="sc">$</span>DTXSID))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    chem.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(cl.table, DTXSID<span class="sc">==</span>this.chem)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (this.species <span class="cf">in</span> <span class="fu">unique</span>(cl.table<span class="sc">$</span>Species))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">parameterize_pfas1comp</span>(<span class="at">dtxsid=</span>this.chem,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">species=</span>this.species,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>))</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Clearance in units of L/h/kgBW</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is</span>(p, <span class="st">&quot;try-error&quot;</span>))</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        cl.table[cl.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chem <span class="sc">&amp;</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>               cl.table<span class="sc">$</span>Species<span class="sc">==</span>this.species,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;MachineLearning.Cltot.Lphpkgbw&quot;</span>] <span class="ot">&lt;-</span> p<span class="sc">$</span>kelim<span class="sc">*</span>p<span class="sc">$</span>Vd</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        outside.doa <span class="ot">&lt;-</span> <span class="fu">c</span>(outside.doa, this.chem)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>outside.doa <span class="ot">&lt;-</span> <span class="fu">unique</span>(outside.doa)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>outside.doa <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,DTXSID<span class="sc">%in%</span>outside.doa)<span class="sc">$</span>Compound</span></code></pre></div>
<div id="calculate-humanspecies-clearance-ratios" class="section level3">
<h3>Calculate human:species clearance ratios</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cl.table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cl.table)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.sex <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  human.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(cl.table, Species<span class="sc">==</span><span class="st">&quot;Human&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                            Sex<span class="sc">==</span>this.sex)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.species <span class="cf">in</span> <span class="fu">unique</span>(cl.table<span class="sc">$</span>Species))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (this.species <span class="sc">!=</span> <span class="st">&quot;Human&quot;</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    species.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(cl.table, Species<span class="sc">==</span>this.species <span class="sc">&amp;</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                                     Sex<span class="sc">==</span>this.sex)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">union</span>(human.data<span class="sc">$</span>DTXSID, species.data<span class="sc">$</span>DTXSID))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>      cl.table.index <span class="ot">&lt;-</span> cl.table<span class="sc">$</span>Sex<span class="sc">==</span>this.sex <span class="sc">&amp;</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>               cl.table<span class="sc">$</span>Species<span class="sc">==</span>this.species <span class="sc">&amp;</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>               cl.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chem</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>      human.table.index <span class="ot">&lt;-</span> human.data<span class="sc">$</span>Sex<span class="sc">==</span>this.sex <span class="sc">&amp;</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>               human.data<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chem</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>      species.table.index <span class="ot">&lt;-</span> species.data<span class="sc">$</span>Sex<span class="sc">==</span>this.sex <span class="sc">&amp;</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>               species.data<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chem</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">any</span>(human.table.index) <span class="sc">&amp;</span> <span class="fu">any</span>(species.table.index))</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>        cl.table[cl.table.index, <span class="st">&quot;TK.Ratio.InVivo&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">signif</span>(species.data[species.table.index, <span class="st">&quot;ClLphpkgbw&quot;</span>] <span class="sc">/</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        human.data[human.table.index, <span class="st">&quot;ClLphpkgbw&quot;</span>], <span class="dv">4</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>        cl.table[cl.table.index, <span class="st">&quot;TK.Ratio.HTTK&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">signif</span>(species.data[species.table.index, <span class="st">&quot;HTTK.Cltot.Lphpkgbw&quot;</span>] <span class="sc">/</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>        human.data[human.table.index, <span class="st">&quot;HTTK.Cltot.Lphpkgbw&quot;</span>], <span class="dv">4</span>) </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>        cl.table[cl.table.index, <span class="st">&quot;TK.Ratio.ML&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">signif</span>(species.data[species.table.index, <span class="st">&quot;MachineLearning.Cltot.Lphpkgbw&quot;</span>] <span class="sc">/</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>        human.data[human.table.index, <span class="st">&quot;MachineLearning.Cltot.Lphpkgbw&quot;</span>], <span class="dv">4</span>)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>        cl.table[cl.table.index, <span class="st">&quot;TK.Ratio.HTTKPFAS&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">signif</span>(species.data[species.table.index, <span class="st">&quot;HTTKPFAS.Cltot.Lphpkgbw&quot;</span>] <span class="sc">/</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>        human.data[human.table.index, <span class="st">&quot;HTTKPFAS.Cltot.Lphpkgbw&quot;</span>], <span class="dv">4</span>) </span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="fu">dim</span>(cl.table)[<span class="dv">1</span>],<span class="st">&quot;rows of in vivo clearance data.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="add-non-pfas-clearances-from-literature" class="section level2">
<h2>Add non-PFAS clearances from literature</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>huh.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="fu">paste0</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  LOC.WD,<span class="st">&quot;Huh-2011-HumanCL.xlsx&quot;</span>)))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Huh Data is in ml/min/kg:</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>Human.CL.mLpminpkg <span class="ot">&lt;-</span> <span class="fu">sapply</span>(huh.data[,<span class="dv">4</span>],<span class="cf">function</span>(x) <span class="fu">signif</span>(<span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(x,<span class="st">&quot; &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>huh.data<span class="sc">$</span>Human.CL.Lphpkg <span class="ot">&lt;-</span> <span class="fu">signif</span>(Human.CL.mLpminpkg<span class="sc">/</span><span class="dv">1000</span><span class="sc">*</span><span class="dv">60</span>, <span class="dv">3</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>huh.data<span class="sc">$</span>Rat.CL.Lphpkg <span class="ot">&lt;-</span> <span class="fu">signif</span>(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(huh.data<span class="sc">$</span>a)<span class="sc">*</span>(<span class="fl">0.25</span>)<span class="sc">^</span><span class="fu">as.numeric</span>(huh.data<span class="sc">$</span>b)<span class="sc">*</span><span class="dv">60</span><span class="sc">/</span><span class="dv">1000</span>, <span class="dv">3</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># List of chemicals where we have HTTK data:</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>httk.chem.list <span class="ot">&lt;-</span> <span class="fu">get_cheminfo</span>(<span class="at">model=</span>NONPFAS.MODEL.USED, </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">info=</span><span class="st">&quot;DTXSID&quot;</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">suppress.messages =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">sort</span>(<span class="fu">unique</span>(huh.data[,<span class="st">&quot;DTXSID&quot;</span>])))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(this.chem))</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(this.chem)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    this.row <span class="ot">&lt;-</span> <span class="fu">which</span>(huh.data[,<span class="st">&quot;DTXSID&quot;</span>]<span class="sc">==</span>this.chem)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    new.row <span class="ot">&lt;-</span> cl.table[<span class="dv">1</span>,]</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    new.row[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    new.row[<span class="dv">1</span>, <span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> huh.data[this.row, <span class="st">&quot;DTXSID&quot;</span>]</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    new.row[<span class="dv">1</span>, <span class="st">&quot;Sex&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Female&quot;</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    new.row[<span class="dv">1</span>, <span class="st">&quot;ClLphpkgbw&quot;</span>] <span class="ot">&lt;-</span> huh.data[this.row, <span class="st">&quot;Human.CL.Lphpkg&quot;</span>]</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    new.row[<span class="dv">1</span>, <span class="st">&quot;TK.Ratio.InVivo&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>      huh.data[this.row, <span class="st">&quot;Rat.CL.Lphpkg&quot;</span>] <span class="sc">/</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>      huh.data[this.row, <span class="st">&quot;Human.CL.Lphpkg&quot;</span>]</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (this.chem <span class="sc">%in%</span> httk.chem.list)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&quot;found HTTK data&quot;</span>)</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate human clearance:</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>      HTTK.Human.Cltot.Lphpkgbw <span class="ot">&lt;-</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">calc_total_clearance</span>(<span class="at">dtxsid =</span> this.chem,</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>                             <span class="at">model=</span>NONPFAS.MODEL.USED,</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>                             <span class="at">species=</span><span class="st">&quot;Human&quot;</span>,</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>                             <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add human row (with NA ratio):</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>      new.row[<span class="dv">1</span>, <span class="st">&quot;Species&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Human&quot;</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>      new.row[<span class="dv">1</span>, <span class="st">&quot;HTTK.Cltot.Lphpkgbw&quot;</span>] <span class="ot">&lt;-</span> HTTK.Human.Cltot.Lphpkgbw </span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&quot;added human row&quot;</span>)</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>      cl.table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cl.table,new.row)</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Make a row for rat:</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>      new.row[<span class="dv">1</span>, <span class="st">&quot;Species&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Rat&quot;</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>      new.row[<span class="dv">1</span>, <span class="st">&quot;ClLphpkgbw&quot;</span>] <span class="ot">&lt;-</span> huh.data[this.row, <span class="st">&quot;Rat.CL.Lphpkg&quot;</span>]</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>      HTTK.Rat.Cltot.Lphpkgbw <span class="ot">&lt;-</span> </span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">calc_total_clearance</span>(<span class="at">dtxsid =</span> this.chem,</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>                             <span class="at">model=</span>NONPFAS.MODEL.USED,</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>                             <span class="at">species=</span><span class="st">&quot;Rat&quot;</span>,</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>                             <span class="at">default.to.human=</span><span class="cn">TRUE</span>,</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>                             <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>      new.row[<span class="dv">1</span>, <span class="st">&quot;HTTK.Cltot.Lphpkgbw&quot;</span>] <span class="ot">&lt;-</span> HTTK.Rat.Cltot.Lphpkgbw</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>      new.row[<span class="dv">1</span>, <span class="st">&quot;TK.Ratio.HTTK&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(HTTK.Rat.Cltot.Lphpkgbw <span class="sc">/</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>                                              HTTK.Human.Cltot.Lphpkgbw, <span class="dv">4</span>)</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add rat row:</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>      cl.table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cl.table,new.row)</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&quot;added rat row&quot;</span>)</span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="fu">dim</span>(cl.table)[<span class="dv">1</span>],<span class="st">&quot;rows of in vivo clearance data.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="fu">dim</span>(cl.table)[<span class="dv">1</span>],<span class="st">&quot;rows of in vivo clearance data.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cl.table<span class="sc">$</span>Class <span class="ot">&lt;-</span> <span class="st">&quot;PFAS&quot;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>cl.table[<span class="sc">!</span>(cl.table<span class="sc">$</span>DTXSID <span class="sc">%in%</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(chem.physical_and_invitro.data,Chemical.Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>DTXSID), </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Class&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Non-PFAS&quot;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>cl.table<span class="sc">$</span>Class <span class="ot">&lt;-</span> <span class="fu">factor</span>(cl.table<span class="sc">$</span>Class, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;PFAS&quot;</span>,<span class="st">&quot;Non-PFAS&quot;</span>))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;Also in Figure 2 Panel B are clearances based upon&quot;</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(cl.table<span class="sc">$</span>Class<span class="sc">!=</span><span class="st">&quot;PFAS&quot;</span>)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;non-PFAS chemicals</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>cl.table <span class="ot">&lt;-</span> <span class="fu">merge</span>(cl.table,<span class="fu">subset</span>(httk<span class="sc">::</span>dawson2023,DosingAdj<span class="sc">==</span><span class="st">&quot;Oral&quot;</span>)[,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;Species&quot;</span>,<span class="st">&quot;Sex&quot;</span>,<span class="st">&quot;ClassPredFull&quot;</span>,<span class="st">&quot;ClassModDomain&quot;</span>)],</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;Species&quot;</span>,<span class="st">&quot;Sex&quot;</span>),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">all.x=</span><span class="cn">TRUE</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cl.table)[<span class="fu">colnames</span>(cl.table)<span class="sc">==</span><span class="st">&quot;ClassPredFull&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;ML.Class&quot;</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(cl.table, <span class="at">file=</span><span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;InVivo-CL-Table.RData&quot;</span>))</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(cl.table, <span class="at">file=</span><span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;InVivo-CL-Table.txt&quot;</span>),<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="at">row.names=</span><span class="cn">FALSE</span>,<span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="fu">dim</span>(cl.table)[<span class="dv">1</span>],<span class="st">&quot;rows of in vivo clearance data.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;InVivo-CL-Table.RData&quot;</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>nonpfasratiotrend <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log10</span>(TK.Ratio.InVivo)<span class="sc">~</span><span class="fu">log10</span>(TK.Ratio.HTTK),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data=</span><span class="fu">subset</span>(cl.table, Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span> Class<span class="sc">!=</span><span class="st">&quot;PFAS&quot;</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nonpfasratiotrend)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;For typical organic chemicals, HTTK in vitro data combined with &quot;</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;species-specific physiological parameters predicts the Rat:Human &quot;</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;clearance ratio with a root mean squared log10 error (RMSLE) of &quot;</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">signif</span>(<span class="fu">RMSLE</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                               Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span> Class<span class="sc">!=</span><span class="st">&quot;PFAS&quot;</span>),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;TK.Ratio.InVivo&quot;</span>, <span class="st">&quot;TK.Ratio.HTTK&quot;</span>),<span class="dv">2</span>),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;InVivo-CL-Table.RData&quot;</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fig.clhttk.invivo  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(cl.table, Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>HTTK.Cltot.Lphpkgbw,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>ClLphpkgbw,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Species,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Sex),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>POINT.SIZE) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit1),color=&quot;black&quot;) + </span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit2),color=&quot;blue&quot;,linetype = &quot;dashed&quot;) +</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PFAS In Vivo Clearance (L/h/kg bw)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Default HTTK Clearance (L/h/kg bw)&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))<span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">size=</span>FONT.SIZE<span class="sc">/</span><span class="dv">3</span>, <span class="at">x =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">4</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>, </span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;RMSLE:&quot;</span>,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">RMSLE</span>(<span class="fu">subset</span>(cl.table, Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>),</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;HTTK.Cltot.Lphpkgbw&quot;</span>,<span class="st">&quot;ClLphpkgbw&quot;</span>)))<span class="sc">+</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> FONT.SIZE<span class="sc">/</span><span class="dv">3</span>), </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> FONT.SIZE<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.clhttk.invivo)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;InVivo-CL-Table.RData&quot;</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>fig.ratio.httk  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(cl.table, Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span>)) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>TK.Ratio.HTTK,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>TK.Ratio.InVivo,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Class,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Class),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>POINT.SIZE) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit1),color=&quot;black&quot;) + </span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit2),color=&quot;blue&quot;,linetype = &quot;dashed&quot;) +</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;In Vivo Derived Human:Rat Clearance Ratio&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Default HTTK Clearance Ratio&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE)) <span class="sc">+</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">2</span>)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.ratio.httk)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="co">#  ggsave(paste0(LOC.WD,</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co">#    &quot;Fig_rat_cl_ratio.tiff&quot;),</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="co">#         height =11, width =12, dpi = 300)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(fig.clhttk.invivo, fig.ratio.httk,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">FALSE</span>, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tiff</span>(<span class="at">file =</span> <span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Fig_PFASRatioEval.tiff&quot;</span>),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> <span class="fl">2.5</span><span class="sc">*</span><span class="dv">200</span>, <span class="at">width =</span> <span class="dv">5</span><span class="sc">*</span><span class="dv">200</span>, <span class="at">compression =</span> <span class="st">&quot;lzw&quot;</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(fig.clhttk.invivo, fig.ratio.httk, </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">hjust=</span><span class="sc">-</span><span class="fl">2.5</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">FALSE</span>, <span class="at">legend =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">font.label=</span><span class="fu">list</span>(<span class="at">size=</span><span class="dv">20</span>))</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ratio.table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;Non-PFAS In Vivo Clearance Ratio&quot;</span>,<span class="st">&quot;Median&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">!=</span> <span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>TK.Ratio.InVivo,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;Non-PFAS In Vivo Clearance Ratio&quot;</span>,<span class="st">&quot;Min&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">!=</span> <span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>TK.Ratio.InVivo,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;Non-PFAS In Vivo Clearance Ratio&quot;</span>,<span class="st">&quot;Max&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">!=</span> <span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>TK.Ratio.InVivo,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;Non-PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;Median&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">!=</span> <span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>TK.Ratio.HTTK, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;Non-PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;Min&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">!=</span> <span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>TK.Ratio.HTTK, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;Non-PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;Max&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">!=</span> <span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>TK.Ratio.HTTK, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;Non-PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;RMSLE&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">RMSLE</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">!=</span> <span class="st">&quot;PFAS&quot;</span>),<span class="st">&quot;TK.Ratio.HTTK&quot;</span>, <span class="st">&quot;TK.Ratio.InVivo&quot;</span>)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;PFAS In Vivo Clearance Ratio&quot;</span>,<span class="st">&quot;Median&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">==</span> <span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>TK.Ratio.InVivo,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;PFAS In Vivo Clearance Ratio&quot;</span>,<span class="st">&quot;Min&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">==</span> <span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>TK.Ratio.InVivo,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;PFAS In Vivo Clearance Ratio&quot;</span>,<span class="st">&quot;Max&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">==</span> <span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>TK.Ratio.InVivo, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;Median&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">==</span> <span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>TK.Ratio.HTTK, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;Min&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">==</span> <span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>TK.Ratio.HTTK, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;Max&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">==</span> <span class="st">&quot;PFAS&quot;</span>)<span class="sc">$</span>TK.Ratio.HTTK, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>ratio.table[<span class="st">&quot;PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;RMSLE&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">RMSLE</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>                Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>                  Class <span class="sc">==</span> <span class="st">&quot;PFAS&quot;</span>), <span class="st">&quot;TK.Ratio.HTTK&quot;</span>, <span class="st">&quot;TK.Ratio.InVivo&quot;</span>)</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>ratio.table <span class="ot">&lt;-</span> <span class="fu">signif</span>(ratio.table, <span class="dv">2</span>)</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(ratio.table, <span class="at">file=</span><span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Ratio-Table.txt&quot;</span>),</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ratio.table)</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;RMSLE is much larger for PFAS (&quot;</span>,</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>           ratio.table[<span class="st">&quot;PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;RMSLE&quot;</span>],</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot; = &quot;</span>,</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>           <span class="fu">signif</span>(<span class="dv">10</span><span class="sc">^</span>ratio.table[<span class="st">&quot;PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;RMSLE&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;-fold error) than for non-PFAS chemicals (&quot;</span>,</span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>           ratio.table[<span class="st">&quot;Non-PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;RMSLE&quot;</span>],</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot; = &quot;</span>,</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>           <span class="fu">signif</span>(<span class="dv">10</span><span class="sc">^</span>ratio.table[<span class="st">&quot;Non-PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;RMSLE&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;-fold error).</span><span class="sc">\n</span><span class="st">&quot;</span>))</span></code></pre></div>
</div>
<div id="evaluating-machine-learning-model-for-pfas-tk" class="section level2">
<h2>Evaluating Machine Learning Model for PFAS TK</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Clint-Fup-Values.RData&quot;</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>clint.fup.pfas[<span class="fu">is.na</span>(clint.fup.pfas<span class="sc">$</span>Human.Clint.pValue),<span class="st">&quot;Human.Clint.pValue&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>ml.clint.table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 1&quot;</span>, <span class="st">&quot;Description&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Rapidly Cleared&quot;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 2&quot;</span>, <span class="st">&quot;Description&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Moderate&quot;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 3&quot;</span>, <span class="st">&quot;Description&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Slow&quot;</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 4&quot;</span>, <span class="st">&quot;Description&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Very Slow&quot;</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 1&quot;</span>, <span class="st">&quot;Half-Life&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&lt; 12 h&quot;</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 2&quot;</span>, <span class="st">&quot;Half-Life&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&lt; 1 week&quot;</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 3&quot;</span>, <span class="st">&quot;Half-Life&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&lt; 2 months&quot;</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 4&quot;</span>, <span class="st">&quot;Half-Life&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&gt; 2 months&quot;</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 1&quot;</span>, <span class="st">&quot;Number Crizer (2024) Chemicals&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(<span class="fu">subset</span>(clint.fup.pfas,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>             ML.Class<span class="sc">==</span><span class="dv">1</span>))[<span class="dv">1</span>]</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 2&quot;</span>, <span class="st">&quot;Number Crizer (2024) Chemicals&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(<span class="fu">subset</span>(clint.fup.pfas,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>             ML.Class<span class="sc">==</span><span class="dv">2</span>))[<span class="dv">1</span>]</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 3&quot;</span>, <span class="st">&quot;Number Crizer (2024) Chemicals&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(<span class="fu">subset</span>(clint.fup.pfas,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>             ML.Class<span class="sc">==</span><span class="dv">3</span>))[<span class="dv">1</span>]</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 4&quot;</span>, <span class="st">&quot;Number Crizer (2024) Chemicals&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(<span class="fu">subset</span>(clint.fup.pfas,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>             ML.Class<span class="sc">==</span><span class="dv">4</span>))[<span class="dv">1</span>]</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 1&quot;</span>, <span class="st">&quot;Number Non-Zero Clint&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(<span class="fu">subset</span>(clint.fup.pfas,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>             ML.Class<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>             Human.Clint <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>             Human.Clint.pValue <span class="sc">&lt;</span> <span class="fl">0.05</span>))[<span class="dv">1</span>]</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 2&quot;</span>, <span class="st">&quot;Number Non-Zero Clint&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(<span class="fu">subset</span>(clint.fup.pfas,</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>             ML.Class<span class="sc">==</span><span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>             Human.Clint <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>             Human.Clint.pValue <span class="sc">&lt;</span> <span class="fl">0.05</span>))[<span class="dv">1</span>]</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 3&quot;</span>, <span class="st">&quot;Number Non-Zero Clint&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(<span class="fu">subset</span>(clint.fup.pfas,</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>             ML.Class<span class="sc">==</span><span class="dv">3</span> <span class="sc">&amp;</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>             Human.Clint <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>             Human.Clint.pValue <span class="sc">&lt;</span> <span class="fl">0.05</span>))[<span class="dv">1</span>]</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>ml.clint.table[<span class="st">&quot;Class 4&quot;</span>, <span class="st">&quot;Number Non-Zero Clint&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(<span class="fu">subset</span>(clint.fup.pfas,</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>             ML.Class<span class="sc">==</span><span class="dv">4</span> <span class="sc">&amp;</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>             Human.Clint <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>             Human.Clint.pValue <span class="sc">&lt;</span> <span class="fl">0.05</span>))[<span class="dv">1</span>]</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(ml.clint.table, <span class="at">file=</span><span class="fu">paste0</span>(LOC.WD,</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;ML-Clint-table.txt&quot;</span>), <span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ml.clint.table)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>half.lives <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> new.pfas)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  new.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DTXSID=</span>this.chem,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Human.HL=</span><span class="fu">try</span>(<span class="fu">calc_half_life</span>(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dtxsid=</span>this.chem,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">species=</span><span class="st">&quot;human&quot;</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">model=</span><span class="st">&quot;sumclearances&quot;</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">class.exclude=</span><span class="cn">FALSE</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">physchem.exclude=</span><span class="cn">FALSE</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)),</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Rat.HL=</span><span class="fu">try</span>(<span class="fu">calc_half_life</span>(</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dtxsid=</span>this.chem,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">species=</span><span class="st">&quot;rat&quot;</span>,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">model=</span><span class="st">&quot;sumclearances&quot;</span>,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">default.to.human=</span><span class="cn">TRUE</span>,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">class.exclude=</span><span class="cn">FALSE</span>,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">physchem.exclude=</span><span class="cn">FALSE</span>,</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)))</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  new.row<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="st">&quot;HTTK&quot;</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  half.lives <span class="ot">&lt;-</span> <span class="fu">rbind</span>(half.lives, new.row)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  param.human <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">parameterize_pfas1comp</span>(<span class="at">dtxsid=</span>this.chem,</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">species=</span><span class="st">&quot;human&quot;</span>,</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>))</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  param.rat <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">parameterize_pfas1comp</span>(<span class="at">dtxsid=</span>this.chem,</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">species=</span><span class="st">&quot;rat&quot;</span>,</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>))</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">&quot;kelim&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(param.human) <span class="sc">&amp;</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;kelim&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(param.rat))</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    new.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DTXSID=</span>this.chem,</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Human.HL=</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">/</span>param.human<span class="sc">$</span>kelim,</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Rat.HL=</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">/</span>param.rat<span class="sc">$</span>kelim)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>  new.row<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="st">&quot;ML&quot;</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  half.lives <span class="ot">&lt;-</span> <span class="fu">rbind</span>(half.lives, new.row)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>half.lives<span class="sc">$</span>Ratio <span class="ot">&lt;-</span> half.lives<span class="sc">$</span>Human.HL <span class="sc">/</span> half.lives<span class="sc">$</span>Rat.HL</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(half.lives,<span class="at">file=</span><span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;All-Half-Lives.RData&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;All-Half-Lives.RData&quot;</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>fig.species.scaling <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>half.lives) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Ratio,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour=</span>Type,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>Type),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins=</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Human:Rat PK Half-Life Ratio&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))<span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_viridis</span>(<span class="at">discrete=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">2</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.species.scaling)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Dawson.known.human.HLs <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID1037303&quot;</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID1037303&quot;</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID3031860&quot;</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID3031860&quot;</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID3031862&quot;</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID3031862&quot;</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID3031864&quot;</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID3031864&quot;</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID4059916&quot;</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID4059916&quot;</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID5030030&quot;</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID5030030&quot;</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID7040150&quot;</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID7040150&quot;</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID70880215&quot;</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID70880215&quot;</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID8031863&quot;</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID8031863&quot;</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID8031865&quot;</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID8031865&quot;</span>,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID80892506&quot;</span>,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;DTXSID80892506&quot;</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>wallis <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Wallis-2023-PFASHL.xlsx&quot;</span>)))</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>wallis<span class="sc">$</span>HL.Low <span class="ot">&lt;-</span> <span class="fu">sapply</span>(wallis[,<span class="dv">4</span>],<span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(x,<span class="st">&quot;, &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]))</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>wallis<span class="sc">$</span>HL.High <span class="ot">&lt;-</span> <span class="fu">sapply</span>(wallis[,<span class="dv">4</span>],<span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(x,<span class="st">&quot;, &quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>]))</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>abraham <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Abraham-2024-PFASHL.xlsx&quot;</span>)))</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>abraham<span class="sc">$</span>HL.Low <span class="ot">&lt;-</span> <span class="fu">sapply</span>(abraham[,<span class="st">&quot;Halflife.95.d&quot;</span>],<span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(x,<span class="st">&quot;–&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]))</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>abraham<span class="sc">$</span>HL.High <span class="ot">&lt;-</span> <span class="fu">sapply</span>(abraham[,<span class="st">&quot;Halflife.95.d&quot;</span>],<span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(x,<span class="st">&quot;–&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>]))</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>abraham<span class="sc">$</span>HL.High[<span class="fu">is.na</span>(abraham<span class="sc">$</span>HL.High)] <span class="ot">&lt;-</span> abraham<span class="sc">$</span>HL.Low<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>wallis<span class="sc">$</span>Reference <span class="ot">&lt;-</span> <span class="st">&quot;Wallis 2023&quot;</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>abraham<span class="sc">$</span>Reference <span class="ot">&lt;-</span> <span class="st">&quot;Abraham 2024&quot;</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>human.invivo.hl <span class="ot">&lt;-</span> wallis[,<span class="fu">c</span>(<span class="st">&quot;PREFERRED_NAME&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;CASRN&quot;</span>,<span class="st">&quot;Reference&quot;</span>,<span class="st">&quot;HL.Low&quot;</span>,<span class="st">&quot;HL.High&quot;</span>)]</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>human.invivo.hl <span class="ot">&lt;-</span> <span class="fu">rbind</span>(human.invivo.hl,</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>                         abraham[,<span class="fu">c</span>(<span class="st">&quot;PREFERRED_NAME&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;CASRN&quot;</span>,<span class="st">&quot;Reference&quot;</span>,<span class="st">&quot;HL.Low&quot;</span>,<span class="st">&quot;HL.High&quot;</span>)])</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>human.invivo.hl<span class="sc">$</span>Status <span class="ot">&lt;-</span> <span class="st">&quot;Novel&quot;</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>human.invivo.hl[human.invivo.hl<span class="sc">$</span>DTXSID <span class="sc">%in%</span> Dawson.known.human.HLs, <span class="st">&quot;Status&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Known&quot;</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> human.invivo.hl<span class="sc">$</span>DTXSID)</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>  param.human <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">parameterize_pfas1comp</span>(<span class="at">dtxsid=</span>this.chem,</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">species=</span><span class="st">&quot;human&quot;</span>,</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">restrict.doa=</span><span class="st">&quot;none&quot;</span>))</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">&quot;kelim&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(param.human))</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>    human.invivo.hl[human.invivo.hl<span class="sc">$</span>DTXSID <span class="sc">==</span> this.chem, <span class="st">&quot;HL.ML&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">/</span>param.human<span class="sc">$</span>kelim<span class="sc">/</span><span class="dv">24</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>human.invivo.hl[human.invivo.hl<span class="sc">$</span>DTXSID<span class="sc">==</span><span class="st">&quot;DTXSID90723993&quot;</span>,<span class="st">&quot;HL.ML&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">29000</span><span class="sc">/</span><span class="dv">24</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>human.invivo.hl[human.invivo.hl<span class="sc">$</span>DTXSID<span class="sc">==</span><span class="st">&quot;DTXSID50723994&quot;</span>,<span class="st">&quot;HL.ML&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">29000</span><span class="sc">/</span><span class="dv">24</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>human.invivo.hl[human.invivo.hl<span class="sc">$</span>DTXSID<span class="sc">==</span><span class="st">&quot;DTXSID20892348&quot;</span>,<span class="st">&quot;HL.ML&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">53</span><span class="sc">/</span><span class="dv">24</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.col <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;HL.Low&quot;</span>,<span class="st">&quot;HL.High&quot;</span>,<span class="st">&quot;HL.ML&quot;</span>))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  temp.col <span class="ot">&lt;-</span> human.invivo.hl[, this.col]</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  bad.rows <span class="ot">&lt;-</span> <span class="fu">is.na</span>(temp.col)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  temp.col[bad.rows] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  new.col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(this.col,<span class="st">&quot;.Class&quot;</span>) </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    human.invivo.hl[, new.col] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  human.invivo.hl[temp.col <span class="sc">&lt;</span> <span class="dv">60</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>       new.col] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  human.invivo.hl[temp.col <span class="sc">&lt;</span> <span class="dv">7</span>,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>       new.col] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  human.invivo.hl[temp.col<span class="sc">&lt;</span> <span class="fl">0.5</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>       new.col] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  human.invivo.hl[bad.rows, new.col] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>human.invivo.hl<span class="sc">$</span>Agree <span class="ot">&lt;-</span> human.invivo.hl<span class="sc">$</span>HL.Low.Class <span class="sc">==</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>                           human.invivo.hl<span class="sc">$</span>HL.ML.Class <span class="sc">|</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>                         human.invivo.hl<span class="sc">$</span>HL.High.Class <span class="sc">==</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>                           human.invivo.hl<span class="sc">$</span>HL.ML.Class </span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>human.invivo.hl<span class="sc">$</span>Underestimate <span class="ot">&lt;-</span> human.invivo.hl<span class="sc">$</span>HL.High.Class <span class="sc">&lt;</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>                           human.invivo.hl<span class="sc">$</span>HL.ML.Class</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>human.invivo.hl<span class="sc">$</span>HL.GeoMean <span class="ot">&lt;-</span> <span class="fu">exp</span>((<span class="fu">log</span>(human.invivo.hl<span class="sc">$</span>HL.Low)<span class="sc">+</span><span class="fu">log</span>(human.invivo.hl<span class="sc">$</span>HL.High))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>fit.overall <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log10</span>(HL.GeoMean) <span class="sc">~</span> <span class="fu">log10</span>(HL.ML),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>human.invivo.hl)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>fit.known <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log10</span>(HL.GeoMean) <span class="sc">~</span> <span class="fu">log10</span>(HL.ML),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span><span class="fu">subset</span>(human.invivo.hl,Status<span class="sc">==</span><span class="st">&quot;Known&quot;</span>))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>fit.novel <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log10</span>(HL.GeoMean) <span class="sc">~</span><span class="fu">log10</span>(HL.ML), </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span><span class="fu">subset</span>(human.invivo.hl,Status<span class="sc">==</span><span class="st">&quot;Novel&quot;</span>))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>hl.known <span class="ot">&lt;-</span> <span class="fu">subset</span>(human.invivo.hl,Status<span class="sc">==</span><span class="st">&quot;Known&quot;</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>RMSLE.known <span class="ot">&lt;-</span> (<span class="fu">mean</span>((<span class="fu">log10</span>(hl.known<span class="sc">$</span>HL.GeoMean) <span class="sc">-</span> <span class="fu">log10</span>(hl.known<span class="sc">$</span>HL.ML))<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>agree.known <span class="ot">&lt;-</span> <span class="fu">sum</span>(hl.known<span class="sc">$</span>Agree)<span class="sc">/</span><span class="fu">dim</span>(hl.known)[<span class="dv">1</span>]</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>under.known <span class="ot">&lt;-</span> <span class="fu">sum</span>(hl.known<span class="sc">$</span>Underestimate)<span class="sc">/</span><span class="fu">dim</span>(hl.known)[<span class="dv">1</span>]</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>hl.novel <span class="ot">&lt;-</span> <span class="fu">subset</span>(human.invivo.hl,Status<span class="sc">==</span><span class="st">&quot;Novel&quot;</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(HL.ML))</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>RMSLE.novel <span class="ot">&lt;-</span> (<span class="fu">mean</span>((<span class="fu">log10</span>(hl.novel<span class="sc">$</span>HL.GeoMean) <span class="sc">-</span> <span class="fu">log10</span>(hl.novel<span class="sc">$</span>HL.ML))<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>agree.novel <span class="ot">&lt;-</span> <span class="fu">sum</span>(hl.novel<span class="sc">$</span>Agree)<span class="sc">/</span><span class="fu">dim</span>(hl.novel)[<span class="dv">1</span>]</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>agree.count.novel <span class="ot">&lt;-</span> <span class="fu">sum</span>(hl.novel<span class="sc">$</span>Agree)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>under.novel <span class="ot">&lt;-</span> <span class="fu">sum</span>(hl.novel<span class="sc">$</span>Underestimate)<span class="sc">/</span><span class="fu">dim</span>(hl.known)[<span class="dv">1</span>]</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>under.count.novel <span class="ot">&lt;-</span> <span class="fu">sum</span>(hl.novel<span class="sc">$</span>Underestimate)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>num.novel.pfas.hl <span class="ot">&lt;-</span> <span class="fu">dim</span>(hl.novel)[<span class="dv">1</span>]</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(num.novel.pfas.hl,<span class="st">&quot;novel PFAS human half-lives.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(human.invivo.hl,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>     hl.known,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>     hl.novel,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">file=</span><span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Human-Invivo-HL.RData&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Human-Invivo-HL.RData&quot;</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>human.invivo.hl<span class="sc">$</span>HL.ML.jitter <span class="ot">&lt;-</span> human.invivo.hl<span class="sc">$</span>HL.ML<span class="sc">*</span>(<span class="fl">1.0</span><span class="sc">+</span><span class="fu">runif</span>(<span class="fu">dim</span>(human.invivo.hl)[<span class="dv">1</span>],<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>human.invivo.hl.fig <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>human.invivo.hl) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>HL.ML.jitter,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend=</span>HL.ML.jitter,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>HL.Low,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend=</span>HL.High,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour=</span>Status),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth=</span><span class="dv">3</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>HL.ML.jitter,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>HL.GeoMean,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Reference,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour=</span>Status),</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Machine Learning Half-Life Prediction&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;In Vivo Measurment&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">hjust=</span><span class="dv">0</span>,</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;RMSLE for &quot;</span>,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>                         num.novel.pfas.hl, </span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot; novel PFAS: &quot;</span>,</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">signif</span>(RMSLE.novel,<span class="dv">2</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="co">#,</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>                         <span class="co">#agree.count.novel,</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>                         <span class="co">#&quot; agree\n&quot;,</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>                         <span class="co">#under.count.novel,</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>                         <span class="co">#&quot; underestimated&quot;,</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>                         ,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))<span class="sc">+</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))<span class="sc">+</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> FONT.SIZE<span class="sc">/</span><span class="dv">3</span>), </span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>               <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> FONT.SIZE<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(human.invivo.hl.fig)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a><span class="co">#tiff(file = paste0(LOC.WD,&quot;InVivoComparison.tiff&quot;),</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     width=9,</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a><span class="co">#     height=7,</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="co">#     units=&quot;in&quot;,</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     res=300)</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a><span class="co">#print(human.invivo.hl.fig)</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(human.invivo.hl, <span class="fu">is.na</span>(HL.ML))</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(fig.species.scaling, human.invivo.hl.fig,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">FALSE</span>, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tiff</span>(<span class="at">file =</span> <span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Fig_MLModelEval.tiff&quot;</span>),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> <span class="fl">2.5</span><span class="sc">*</span><span class="dv">200</span>, <span class="at">width =</span> <span class="dv">5</span><span class="sc">*</span><span class="dv">200</span>, <span class="at">compression =</span> <span class="st">&quot;lzw&quot;</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(fig.species.scaling, human.invivo.hl.fig,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">hjust=</span><span class="sc">-</span><span class="fl">2.5</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">FALSE</span>, <span class="at">legend =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">font.label=</span><span class="fu">list</span>(<span class="at">size=</span><span class="dv">20</span>))</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;InVivo-CL-Table.RData&quot;</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>fig.clml.invivo  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(cl.table, Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>MachineLearning.Cltot.Lphpkgbw,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>ClLphpkgbw,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Species,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Sex),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>POINT.SIZE,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">height=</span><span class="dv">0</span>,<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit1),color=&quot;black&quot;) + </span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit2),color=&quot;blue&quot;,linetype = &quot;dashed&quot;) +</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;In Vivo Clearance (L/h/kg bw)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Machine Learning Clearance (L/h/kg bw)&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))<span class="sc">+</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">5</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>,<span class="at">size=</span>FONT.SIZE<span class="sc">/</span><span class="dv">3</span>, </span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;RMSLE:&quot;</span>,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">RMSLE</span>(cl.table,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;MachineLearning.Cltot.Lphpkgbw&quot;</span>,</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;ClLphpkgbw&quot;</span>)))</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.clml.invivo)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;InVivo-CL-Table.RData&quot;</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>fig.ratio.ml  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(cl.table, Species<span class="sc">!=</span><span class="st">&quot;Human&quot;</span> <span class="sc">&amp;</span> Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>TK.Ratio.ML,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>TK.Ratio.InVivo,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Species,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Sex),</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>POINT.SIZE) <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit1),color=&quot;black&quot;) + </span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit2),color=&quot;blue&quot;,linetype = &quot;dashed&quot;) +</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;In Vivo Observed Clearance Ratio&quot;</span>) <span class="sc">+</span> </span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Machine Learning Predicted Clearance Ratio&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.ratio.ml)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">paste0</span>(LOC.WD,</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fig_ml_cl_ratio.tiff&quot;</span>),</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> <span class="dv">11</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
</div>
<div id="new-httk-model-for-pfas" class="section level2">
<h2>New HTTK Model for PFAS</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;InVivo-CL-Table.RData&quot;</span>))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>fig.clhttkpfas.invivo  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(cl.table, Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>HTTKPFAS.Cltot.Lphpkgbw,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>ClLphpkgbw,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Species,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Sex),</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>POINT.SIZE) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit1),color=&quot;black&quot;) + </span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit2),color=&quot;blue&quot;,linetype = &quot;dashed&quot;) +</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PFAS In Vivo Clearance (L/h/kg bw)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;HTTK-PFAS Clearance (L/h/kg bw)&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))<span class="sc">+</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">size=</span>FONT.SIZE<span class="sc">/</span><span class="dv">3</span>, <span class="at">x =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span><span class="sc">*</span><span class="dv">10</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>, </span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;RMSLE:&quot;</span>,</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">RMSLE</span>(<span class="fu">subset</span>(cl.table, Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>),</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;HTTKPFAS.Cltot.Lphpkgbw&quot;</span>,<span class="st">&quot;ClLphpkgbw&quot;</span>)))<span class="sc">+</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> FONT.SIZE<span class="sc">/</span><span class="dv">3</span>), </span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> FONT.SIZE<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.clhttkpfas.invivo)</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>multiclerancenewmodel <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(fig.clml.invivo<span class="sc">+</span> <span class="fu">rremove</span>(<span class="st">&quot;ylab&quot;</span>) , fig.clhttkpfas.invivo<span class="sc">+</span> <span class="fu">rremove</span>(<span class="st">&quot;ylab&quot;</span>) ,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>multiclerancenewmodel <span class="ot">&lt;-</span> <span class="fu">annotate_figure</span>(multiclerancenewmodel , </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">left =</span> <span class="fu">textGrob</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;PFAS &quot;</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">italic</span>(<span class="st">&quot;In Vivo&quot;</span>),</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Clearance (L/h/kg bw)&quot;</span>)), </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">rot =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">cex =</span> <span class="fl">1.75</span>)),</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(multiclerancenewmodel)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tiff</span>(<span class="at">file =</span> <span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Fig_PFASClearanceEval.tiff&quot;</span>),</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> <span class="fl">2.5</span><span class="sc">*</span><span class="dv">200</span>, <span class="at">width =</span> <span class="dv">5</span><span class="sc">*</span><span class="dv">200</span>, <span class="at">compression =</span> <span class="st">&quot;lzw&quot;</span>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(multiclerancenewmodel)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;InVivo-CL-Table.RData&quot;</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>fig.ratio.httkpfas  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(cl.table, Species<span class="sc">!=</span><span class="st">&quot;Human&quot;</span> <span class="sc">&amp;</span> Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>TK.Ratio.HTTKPFAS,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>TK.Ratio.InVivo,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Species,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Sex),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>POINT.SIZE) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit1),color=&quot;black&quot;) + </span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit2),color=&quot;blue&quot;,linetype = &quot;dashed&quot;) +</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In Vivo&quot;</span>),</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Observed Clearance Ratio&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;HTTK-PFAS Predicted Clearance Ratio&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">size=</span>FONT.SIZE<span class="sc">/</span><span class="dv">3</span>, <span class="at">x =</span> <span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">3</span>, </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;RMSLE:&quot;</span>,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">RMSLE</span>(<span class="fu">subset</span>(cl.table, Species<span class="sc">!=</span><span class="st">&quot;Human&quot;</span> <span class="sc">&amp;</span> Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>),</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;TK.Ratio.HTTKPFAS&quot;</span>,<span class="st">&quot;TK.Ratio.InVivo&quot;</span>)))<span class="sc">+</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.ratio.httkpfas)</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">paste0</span>(LOC.WD,</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fig_httkpfas_cl_ratio.tiff&quot;</span>),</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> <span class="dv">5</span><span class="sc">*</span><span class="fl">1.5</span>, <span class="at">width =</span> <span class="dv">6</span><span class="sc">*</span><span class="fl">1.5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pfas.httk.table <span class="ot">&lt;-</span> <span class="fu">get_2023pfasinfo</span>(<span class="at">info=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> pfas.httk.table<span class="sc">$</span>DTXSID)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  this.row <span class="ot">&lt;-</span> pfas.httk.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chem</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  pfas.httk.table[this.row, <span class="st">&quot;Css.HTTK.Classic&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">calc_analytic_css</span>(</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">dtxsid=</span>this.chem,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">class.exclude=</span><span class="cn">FALSE</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">physchem.exclude=</span><span class="cn">FALSE</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">model=</span><span class="st">&quot;3compartmentss&quot;</span>))</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  pfas.httk.table[this.row, <span class="st">&quot;Css.HTTK.Exhale&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">calc_analytic_css</span>(</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">dtxsid=</span>this.chem,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">class.exclude=</span><span class="cn">FALSE</span>,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">model=</span><span class="st">&quot;sumclearances&quot;</span>))</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  pfas.httk.table[this.row, <span class="st">&quot;Css.HTTK.PFAS&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">calc_analytic_css</span>(</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">dtxsid=</span>this.chem,</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">model=</span><span class="st">&quot;sumclearancespfas&quot;</span>))</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  pfas.httk.table[this.row, <span class="st">&quot;Css.ML&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">calc_analytic_css</span>(</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">dtxsid=</span>this.chem,</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">model=</span><span class="st">&quot;pfas1compartment&quot;</span>))</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>    fractions <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">calc_clearance_frac</span>(<span class="at">dtxsid=</span>this.chem, </span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">model=</span><span class="st">&quot;sumclearancespfas&quot;</span>,</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">fraction.params =</span> <span class="fu">c</span>(<span class="st">&quot;Clint&quot;</span>,</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>                                                          <span class="st">&quot;Qgfrc&quot;</span>,</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>                                                          <span class="st">&quot;Qalvc&quot;</span>)))</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is</span>(fractions, <span class="st">&quot;try-error&quot;</span>))</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>    pfas.httk.table[this.row, <span class="st">&quot;Frac.Metabolism&quot;</span>] <span class="ot">&lt;-</span> fractions[[<span class="st">&quot;Clint&quot;</span>]]</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    pfas.httk.table[this.row, <span class="st">&quot;Frac.Glomerular&quot;</span>] <span class="ot">&lt;-</span> fractions[[<span class="st">&quot;Qgfrc&quot;</span>]]</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>    pfas.httk.table[this.row, <span class="st">&quot;Frac.Exhalation&quot;</span>] <span class="ot">&lt;-</span> fractions[[<span class="st">&quot;Qalvc&quot;</span>]]</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>pfas.httk.table<span class="sc">$</span>Css.HTTK.Classic <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pfas.httk.table<span class="sc">$</span>Css.HTTK.Classic)</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>pfas.httk.table<span class="sc">$</span>Css.HTTK.Exhale <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pfas.httk.table<span class="sc">$</span>Css.HTTK.Exhale)</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>pfas.httk.table<span class="sc">$</span>Css.HTTK.PFAS <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pfas.httk.table<span class="sc">$</span>Css.HTTK.PFAS)</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>pfas.httk.table<span class="sc">$</span>Css.ML <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pfas.httk.table<span class="sc">$</span>Css.ML)</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>pfas.httk.table<span class="sc">$</span>Css.Exhale.FoldChange <span class="ot">&lt;-</span> </span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(pfas.httk.table<span class="sc">$</span>Css.HTTK.Exhale<span class="sc">/</span>pfas.httk.table<span class="sc">$</span>Css.HTTK.Classic, <span class="dv">3</span>)</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>pfas.httk.table<span class="sc">$</span>Css.PFAS.FoldChange <span class="ot">&lt;-</span> </span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(pfas.httk.table<span class="sc">$</span>Css.HTTK.PFAS<span class="sc">/</span>pfas.httk.table<span class="sc">$</span>Css.HTTK.Classic, <span class="dv">3</span>)</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>pfas.httk.table <span class="ot">&lt;-</span> </span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(pfas.httk.table,<span class="fu">subset</span>(httk<span class="sc">::</span>dawson2023,</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>                               Species<span class="sc">==</span><span class="st">&quot;Human&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>                               Sex<span class="sc">==</span><span class="st">&quot;Female&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>                               DosingAdj<span class="sc">==</span><span class="st">&quot;Oral&quot;</span>)[</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>  ,<span class="fu">c</span>(<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;ClassPredFull&quot;</span>)],<span class="at">by=</span><span class="st">&quot;DTXSID&quot;</span>,<span class="at">all.x=</span><span class="cn">TRUE</span>)</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pfas.httk.table)[<span class="fu">colnames</span>(pfas.httk.table)<span class="sc">==</span><span class="st">&quot;ClassPredFull&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;ML.Class&quot;</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>pfas.httk.table<span class="sc">$</span>InVitroMetabolism <span class="ot">&lt;-</span> <span class="st">&quot;No&quot;</span></span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>clint.pvalue <span class="ot">&lt;-</span> pfas.httk.table<span class="sc">$</span>Human.Clint.pValue</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>clint.pvalue[<span class="fu">is.na</span>(clint.pvalue)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>pfas.httk.table[pfas.httk.table<span class="sc">$</span>Human.Clint <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>                clint.pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;InVitroMetabolism&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Yes&quot;</span></span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(pfas.httk.table, </span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names=</span><span class="cn">FALSE</span>, </span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">quote=</span><span class="cn">FALSE</span>,</span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,</span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a>          <span class="at">file=</span><span class="fu">paste</span>(LOC.WD,<span class="st">&quot;new-pfas-css-uM.txt&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(pfas.httk.table,<span class="at">file=</span><span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;PFAS-Css-Table.RData&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;PFAS-Css-Table.RData&quot;</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>pfas.httk.table<span class="sc">$</span>ML.Class <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pfas.httk.table<span class="sc">$</span>ML.Class)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>fig.css.httk  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(pfas.httk.table,<span class="sc">!</span><span class="fu">is.na</span>(ML.Class))) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Css.HTTK.Classic,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>Css.HTTK.PFAS,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>InVitroMetabolism,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>ML.Class</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>POINT.SIZE) <span class="sc">+</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;HTTK-PFAS&quot;</span>,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">~</span>C[ss],</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot; (&quot;</span>,</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>                         mu,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;M)&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Default HTTK&quot;</span>,</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">~</span>C[ss],</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot; (&quot;</span>,</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>                         mu,</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;M)&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>),<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>),<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE)) <span class="sc">+</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">3</span>)<span class="sc">+</span> </span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;ML Halflife Class&quot;</span>),</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;In Vitro Metabolism&quot;</span>))</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.css.httk)</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a><span class="co">#  ggsave(paste0(LOC.WD,</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a><span class="co">#    &quot;Fig_httkpfas_cl_ratio.tiff&quot;),</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a><span class="co">#         height = 11, width = 12, dpi = 300)</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;PFAS-Css-Table.RData&quot;</span>))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>pfas.httk.table<span class="sc">$</span>ML.Class <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pfas.httk.table<span class="sc">$</span>ML.Class)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>fig.css.ml  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(pfas.httk.table,<span class="sc">!</span><span class="fu">is.na</span>(ML.Class))) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Css.ML,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>Css.HTTK.PFAS,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>InVitroMetabolism,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>ML.Class</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>POINT.SIZE) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;HTTK-PFAS&quot;</span>,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">~</span>C[ss],</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot; (&quot;</span>,</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>                         mu,</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;M)&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Machine Learning&quot;</span>,</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">~</span>C[ss],</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot; (&quot;</span>,</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>                         mu,</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;M)&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>),<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>),<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE)) <span class="sc">+</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="dv">3</span>)<span class="sc">+</span> </span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;ML Halflife Class&quot;</span>),</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;In Vitro Metabolism&quot;</span>))</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.css.ml)</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="co">#  ggsave(paste0(LOC.WD,</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a><span class="co">#    &quot;Fig_httkpfas_cl_ratio.tiff&quot;),</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="co">#         height = 11, width = 12, dpi = 300)</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>multipanelcss <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(fig.css.httk <span class="sc">+</span> <span class="fu">rremove</span>(<span class="st">&quot;ylab&quot;</span>) , </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                                   fig.css.ml <span class="sc">+</span> <span class="fu">rremove</span>(<span class="st">&quot;ylab&quot;</span>) ,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>multipanelcss <span class="ot">&lt;-</span> <span class="fu">annotate_figure</span>(multipanelcss, </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">left =</span> <span class="fu">textGrob</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;HTTK-PFAS&quot;</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">~</span>C[ss],</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot; (&quot;</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                         mu,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;M)&quot;</span>)), </span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">rot =</span> <span class="dv">90</span>, </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">vjust =</span> <span class="dv">1</span>, </span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">cex =</span> <span class="fl">1.75</span>)),</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(multipanelcss)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tiff</span>(<span class="at">file =</span> <span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Fig_Css.tiff&quot;</span>),</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> <span class="fl">2.5</span><span class="sc">*</span><span class="dv">200</span>, <span class="at">width =</span> <span class="dv">5</span><span class="sc">*</span><span class="dv">200</span>, <span class="at">compression =</span> <span class="st">&quot;lzw&quot;</span>)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(multipanelcss)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="text-for-manuscript" class="section level2">
<h2>Text for manuscript</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Abstract</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;For typical organic chemicals, HTTK in vitro data combined with &quot;</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;species-specific physiological parameters predicts the Rat:Human &quot;</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;clearance ratio with a root mean squared log10 error (RMSLE) of &quot;</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">signif</span>(<span class="fu">RMSLE</span>(<span class="fu">subset</span>(cl.table, </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                               Species<span class="sc">==</span><span class="st">&quot;Rat&quot;</span> <span class="sc">&amp;</span> Class<span class="sc">!=</span><span class="st">&quot;PFAS&quot;</span>),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;TK.Ratio.InVivo&quot;</span>, <span class="st">&quot;TK.Ratio.HTTK&quot;</span>),<span class="dv">2</span>),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;With this and other modifications, HTTK methods for PFAS achieve &quot;</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;improved prediction of interspecies clearance ratios, with an &quot;</span>,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;RMSLE of &quot;</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>           <span class="fu">signif</span>(<span class="fu">RMSLE</span>(<span class="fu">subset</span>(cl.table, Species<span class="sc">!=</span><span class="st">&quot;Human&quot;</span> <span class="sc">&amp;</span> Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>),</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;TK.Ratio.HTTKPFAS&quot;</span>,<span class="st">&quot;TK.Ratio.InVivo&quot;</span>),<span class="dv">2</span>),</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Results: 3.2</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;RMSLE is much larger for PFAS (&quot;</span>,</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>           ratio.table[<span class="st">&quot;PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;RMSLE&quot;</span>],</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot; = &quot;</span>,</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>           <span class="fu">signif</span>(<span class="dv">10</span><span class="sc">^</span>ratio.table[<span class="st">&quot;PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;RMSLE&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;-fold error) than for non-PFAS chemicals (&quot;</span>,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>           ratio.table[<span class="st">&quot;Non-PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;RMSLE&quot;</span>],</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot; = &quot;</span>,</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>           <span class="fu">signif</span>(<span class="dv">10</span><span class="sc">^</span>ratio.table[<span class="st">&quot;Non-PFAS Default HTTK Clearance Ratio&quot;</span>,<span class="st">&quot;RMSLE&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;-fold error).</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Results: 3.3</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;The ML performs well on the &quot;</span>,</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>           num.novel.pfas.hl, </span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot; novel chemicals, with a RMSLE of &quot;</span>,</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>            <span class="fu">signif</span>(RMSLE.novel,<span class="dv">2</span>),</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;As shown in panel A of Figure 4, this model does well (RMSLE &quot;</span>,</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>           <span class="fu">RMSLE</span>(cl.table,</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;MachineLearning.Cltot.Lphpkgbw&quot;</span>,</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;ClLphpkgbw&quot;</span>),</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;) at reproducing the data on which it was essentially trained.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Results: 3.4</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;The overall RMSLE is &quot;</span>,</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>           <span class="fu">RMSLE</span>(<span class="fu">subset</span>(cl.table, Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>),</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;HTTKPFAS.Cltot.Lphpkgbw&quot;</span>,</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;ClLphpkgbw&quot;</span>),</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">&quot;HTTK-PFAS clearance ratios are improved, in contrast to Figure 2, with an RMSLE of &quot;</span>,</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>           <span class="fu">RMSLE</span>(<span class="fu">subset</span>(cl.table, Species<span class="sc">!=</span><span class="st">&quot;Human&quot;</span> <span class="sc">&amp;</span> Class<span class="sc">==</span><span class="st">&quot;PFAS&quot;</span>),</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;TK.Ratio.HTTKPFAS&quot;</span>,<span class="st">&quot;TK.Ratio.InVivo&quot;</span>),</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span></code></pre></div>
</div>
<div id="other-analyses" class="section level2">
<h2>Other Analyses</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>firstpass.table <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">get_2023pfasinfo</span>(<span class="at">info=</span><span class="st">&quot;dtxsid&quot;</span>, <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">model=</span>PFAS.MODEL.USED))</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>      params <span class="ot">&lt;-</span> <span class="fu">parameterize_sumclearances</span>(<span class="at">dtxsid=</span>this.chem,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">class.exclude=</span><span class="cn">FALSE</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>      params2 <span class="ot">&lt;-</span> <span class="fu">parameterize_schmitt</span>(<span class="at">dtxsid=</span>this.chem,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">class.exclude=</span><span class="cn">FALSE</span>)                           </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>      ion <span class="ot">&lt;-</span> <span class="fu">calc_ionization</span>(</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">pH=</span><span class="fl">7.4</span>,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">pKa_Donor=</span>params2[[<span class="st">&quot;pKa_Donor&quot;</span>]],</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">pKa_Accept=</span>params2[[<span class="st">&quot;pKa_Accept&quot;</span>]])</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>      fraction_neutral <span class="ot">&lt;-</span> ion<span class="sc">$</span>fraction_neutral</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (fraction_neutral <span class="sc">&lt;</span> <span class="fl">0.5</span>) params[[<span class="st">&#39;Rblood2plasma&#39;</span>]] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> params[[<span class="st">&#39;Rblood2plasma&#39;</span>]] <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  params[[<span class="st">&quot;Clmetabolismc&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">calc_hep_clearance</span>(<span class="at">parameters=</span>params,</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">hepatic.model=</span><span class="st">&#39;unscaled&#39;</span>,</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)<span class="co">#L/h/kg body weight</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DTXSID=</span>this.chem,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Fsystemic=</span><span class="fu">calc_hep_bioavailability</span>(</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">parameters=</span>params)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  firstpass.table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(firstpass.table, this.row)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>fig.firstpass  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>firstpass.table) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Fsystemic),<span class="at">bins=</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of Chemicals&quot;</span>) <span class="sc">+</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Fraction Systemically Available&quot;</span>) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.firstpass)</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>fig.clspecies.invivo  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>cl.table) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Species,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>ClLphpkgbw,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Species,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Sex),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>POINT.SIZE) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Species,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span>ClLphpkgbw,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> DTXSID)) <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit1),color=&quot;black&quot;) + </span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_line(aes(x=logP,y=logPfit2),color=&quot;blue&quot;,linetype = &quot;dashed&quot;) +</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;In Vivo Clearance (L/h/kg bw)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Species&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.clspecies.invivo)</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fig.clspecies.httk  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>cl.table) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Species,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>HTTK.Cltot.Lphpkgbw,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Species,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Sex),</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>POINT.SIZE) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_segment(color=&quot;#69b3a2&quot;, </span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                  aes(</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                    x=Species,</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                    y=HTTK.Cltot.Lphpkgbw,</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                    xend = c(tail(Species, n = -1), NA), </span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                    yend = c(tail(HTTK.Cltot.Lphpkgbw, n = -1), NA)</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                  ))+</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Species,</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span>HTTK.Cltot.Lphpkgbw,</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">group =</span> DTXSID)) <span class="sc">+</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ylab</span>(<span class="st">&quot;HTTK Clearance (L/h/kg bw)&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Species&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span>FONT.SIZE))</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fig.clspecies.httk)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>FigClearanceFrac1<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>pfas.httk.table)<span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>,<span class="at">alpha=</span><span class="dv">1</span>,<span class="at">fill=</span><span class="st">&quot;Red&quot;</span>,<span class="fu">aes</span>(Frac.Metabolism))<span class="sc">+</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot; &quot;</span>) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot; &quot;</span>)<span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Hepatic Metabolism&quot;</span>)<span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">05</span>,<span class="fl">1.05</span>))<span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">100</span>))</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>FigClearanceFrac2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>pfas.httk.table)<span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>,<span class="at">alpha=</span><span class="dv">1</span>,<span class="at">fill=</span><span class="st">&quot;Blue&quot;</span>,<span class="fu">aes</span>(Frac.Glomerular))<span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot; &quot;</span>) <span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Glomerular Filtration&quot;</span>)<span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">05</span>,<span class="fl">1.05</span>))<span class="sc">+</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">100</span>))</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>FigClearanceFrac3<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>pfas.httk.table)<span class="sc">+</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>,<span class="at">alpha=</span><span class="dv">1</span>,<span class="at">fill=</span><span class="st">&quot;Green&quot;</span>,<span class="fu">aes</span>(Frac.Exhalation))<span class="sc">+</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Fraction of Total Clearance&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot; &quot;</span>)<span class="sc">+</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Exhalation&quot;</span>)<span class="sc">+</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">05</span>,<span class="fl">1.05</span>))<span class="sc">+</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">100</span>))</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(FigClearanceFrac1, FigClearanceFrac2, FigClearanceFrac3,</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="fu">tiff</span>(<span class="at">file =</span> <span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Fig_FracClearance.tiff&quot;</span>),</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">100</span>, <span class="at">width =</span> <span class="dv">5</span><span class="sc">*</span><span class="dv">100</span>, <span class="at">compression =</span> <span class="st">&quot;lzw&quot;</span>)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(FigClearanceFrac1, FigClearanceFrac2, FigClearanceFrac3,</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>Fig.Cssa <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>pfas.httk.table)<span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>,<span class="fu">aes</span>(Css.Exhale.FoldChange))<span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Css Fold Change Due to Exhalation&quot;</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>Fig.Cssb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>pfas.httk.table)<span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10</span>,<span class="fu">aes</span>(Css.PFAS.FoldChange))<span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Css Fold Change Due to PFAS Resorption&quot;</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(Fig.Cssa, Fig.Cssb, </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tiff</span>(<span class="at">file =</span> <span class="fu">paste0</span>(LOC.WD,<span class="st">&quot;Fig_CssFoldChange.tiff&quot;</span>),</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">height =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">100</span>, <span class="at">width =</span> <span class="dv">5</span><span class="sc">*</span><span class="dv">100</span>, <span class="at">compression =</span> <span class="st">&quot;lzw&quot;</span>)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(Fig.Cssa, Fig.Cssb, </span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
